<html>
<head>
<title>Synthwave Scene â€” My Coolest Three.js Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Synthwaveåœºæ™¯â€”â€”æˆ‘æœ€é…·çš„Three.jsé¡¹ç›®</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://betterprogramming.pub/synthwave-scene-my-coolest-three-js-project-yet-6359c38dfd08?source=collection_archive---------5-----------------------#2022-12-05">https://betterprogramming.pub/synthwave-scene-my-coolest-three-js-project-yet-6359c38dfd08?source=collection_archive---------5-----------------------#2022-12-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="958c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">æˆ‘çš„ä»£ç çš„è¯¦ç»†æ¼”ç»ƒ</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b54205eab561a3878b99f4bb7aa182c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B4-rouDnpRMKDzvSzCXgKQ.png"/></div></div></figure><p id="f4f3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¤§çº¦ä¸¤å¹´å‰ï¼Œæˆ‘å®Œå…¨è¿·ä¸Šäº†YouTubeä¸Šçš„Retrowave/SynthwaveéŸ³ä¹ã€‚æˆ‘çœŸçš„å¾ˆå–œæ¬¢éŸ³ä¹å’Œè§†è§‰çš„å¤å¤æœªæ¥ä¸»ä¹‰ç¾å­¦â€”â€”ä¸€ä¸ªå‘å‰ç§»åŠ¨çš„è§†è§’ï¼Œå±•ç¤ºäº†ä¸€ä¸ªè¶…çº§é…·çš„æ°¸ä¸ç»“æŸçš„éœ“è™¹ç½‘æ ¼ï¼Œå¤•é˜³å°±åœ¨åœ°å¹³çº¿ä¸Šã€‚ä»é‚£ä»¥åï¼Œæˆ‘ä¸€ç›´æƒ³ç”¨Three.jsé‡æ–°åˆ›å»ºä¸€ä¸ªâ€œSynthwaveåœºæ™¯â€</p><p id="8bed" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘è®°å¾—å»å¹´æˆ‘ç¬¬ä¸€æ¬¡å°è¯•ï¼Œä½†æˆ‘åœ¨æŸä¸ªæ—¶å€™å¡ä½äº†ï¼Œå¾ˆå¿«å°±æ„Ÿåˆ°æ²®ä¸§ï¼Œæœ€åæ”¾å¼ƒäº†ã€‚è€å®è¯´ï¼Œé‡ç°åœºæ™¯ä¸æ˜¯ä¸€ä»¶ç®€å•çš„å·¥ä½œï¼Œå¯¹åˆå­¦è€…æ¥è¯´æ›´æ˜¯å¦‚æ­¤ã€‚æˆ‘ä¸ºè‡ªå·±æœ€ç»ˆåˆ›é€ äº†ä¸€ä¸ªåƒæ ·çš„Synthwaveåœºæ™¯æ„Ÿåˆ°éå¸¸è‡ªè±ªã€‚ç°åœ¨ï¼Œæˆ‘å°†å¸¦ä½ ä¸€æ­¥ä¸€æ­¥åœ°å®Œæˆåˆ›å»ºç›¸åŒåœºæ™¯çš„è¿‡ç¨‹ã€‚</p><p id="70d2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å…ˆè¯´ç»†åˆ†ã€‚</p><h1 id="56f3" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">æ•™ç¨‹åˆ†è§£</h1><ol class=""><li id="815e" class="mf mg iq kt b ku mh kx mi la mj le mk li ml lm mm mn mo mp bi translated">ç°åœºæ¼”ç¤º</li><li id="2237" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">æ„å»ºåœ°å½¢çš„æ–¹æ³•</li><li id="3b87" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">é¡¹ç›®çš„ä»£ç ç»“æ„</li><li id="1ab5" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">è®¾ç½®åœºæ™¯ç¯å¢ƒ</li><li id="c84e" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">ä¸ºåœ°å½¢â›°è®¾ç½®å¹³é¢å‡ ä½•ä½“</li><li id="37db" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">åœ¨åœ°å½¢ä¸Šåˆ›å»ºäº®/éœ“è™¹ç½‘æ ¼çº¿</li><li id="1a95" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">åˆ›é€ ä¸€ä¸ªæ²¡æœ‰å°½å¤´çš„åœ°å½¢çš„å¹»è§‰</li><li id="27e7" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">æ·»åŠ è½æ—¥â˜€å¹¶åˆ¶ä½œåŠ¨ç”»</li><li id="208d" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">æ·»åŠ GUIæ§ä»¶ä»¥åœ¨è¿è¡Œæ—¶è°ƒæ•´å‚æ•°</li><li id="5305" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">ç”¨Bloomæ•ˆæœå¯¹åœºæ™¯è¿›è¡ŒåæœŸå¤„ç†ï¼Œè®©å®ƒçœ‹èµ·æ¥æ›´é…·ï¼</li></ol><h1 id="20e8" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">1.ç°åœºæ¼”ç¤º</h1><p id="91cd" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">åƒå¾€å¸¸ä¸€æ ·ï¼Œå…ˆçœ‹çœ‹ä½ è¦å»ºç«‹ä»€ä¹ˆï¼è¿™ä¸ªæ¼”ç¤ºæ˜¯æ‰˜ç®¡åœ¨æˆ‘çš„ä»£ç æ²™ç›’å¸æˆ·ã€‚åœ¨æ›´å¤§çš„çª—å£é‡Œçœ‹èµ·æ¥æ›´å¥½ï¼Œä¸é‚£ä¹ˆç¬¨é‡ã€‚</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="52d1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¾ˆé…·çš„åœºæ™¯å§ï¼Ÿ</p><p id="db9d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¦‚æœä½ æƒ³çœ‹å®Œæ•´çš„ä»£ç ï¼Œè¯·æŸ¥çœ‹https://github.com/franky-adl/threejs-synthwave-sceneçš„ã€‚</p><h1 id="addc" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">2.æ„å»ºåœ°å½¢çš„æ–¹æ³•</h1><p id="bcba" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">è¿™ä¸€èŠ‚è§£é‡Šäº†å¦‚ä½•å¤„ç†åœ¨åˆ¶ä½œåœ°å½¢å‡ ä½•å›¾å½¢æ—¶é‡åˆ°çš„é—®é¢˜ï¼Œè¿™çœŸçš„æœ‰åŠ©äºä½ ç†è§£æˆ‘åœ¨å¹•åçš„æ€è€ƒè¿‡ç¨‹ã€‚è¿™ä¼šå˜å¾—æœ‰ç‚¹é•¿ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³é©¬ä¸Šè¿›å…¥ä»£ç ï¼Œè·³åˆ°ä¸‹ä¸€èŠ‚ã€‚</p><p id="c612" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åˆ¶ä½œsynthwaveåœºæ™¯è¦å…‹æœçš„ç¬¬ä¸€ä¸ªéšœç¢æ˜¯ç”Ÿæˆåœ°å½¢ã€‚æˆ‘ä»¬å°†åˆ¶ä½œä¸€ä¸ªä¸­é—´å¹³å¦çš„åœ°å½¢ä½œä¸ºé“è·¯ï¼Œä¸¤è¾¹å´å²–ä¸å¹³çš„åœ°å½¢ä½œä¸ºå±±è„‰ã€‚æœ‰ä¸åŒçš„æ–¹æ³•ç”Ÿæˆåœ°å½¢ï¼›æœ‰äº›åœ¨ä½ è„‘æµ·ä¸­çœ‹èµ·æ¥å¾ˆå®¹æ˜“ï¼Œä½†å½“ä½ å°è¯•ç¼–ç æ—¶å´å¾ˆéš¾ã€‚ä¸ºäº†æ›´æ·±å…¥åœ°äº†è§£åœ°å½¢é—®é¢˜ï¼Œå®é™…ä¸Šæœ‰ä¸‰ä¸ªä¸»è¦é—®é¢˜:</p><p id="f7ca" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">A.æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ ·çš„å‡ ä½•å›¾å½¢ï¼Ÿ<br/> B .å¦‚ä½•ä½¿åœ°å½¢ä¸­é—´å¹³å¦è€Œä¸¤è¾¹å‡¹å‡¸ä¸å¹³ï¼Ÿ<br/> C .å¦‚ä½•åˆ¶ä½œåœ°å½¢åŠ¨ç”»æ¥ä¼ªé€ ä¸€ä¸ªæ— å°½çš„é“è·¯æ•ˆæœï¼Ÿ</p><p id="fd08" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è®©æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªæ¥ã€‚</p><h2 id="6edf" class="nb lo iq bd lp nc nd dn lt ne nf dp lx la ng nh lz le ni nj mb li nk nl md nm bi translated"><strong class="ak"> A .æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ ·çš„å‡ ä½•å›¾å½¢ï¼Ÿ</strong></h2><p id="5825" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">ä¹ä¸€çœ‹ï¼Œä½ å¯èƒ½è®¤ä¸º<code class="fe nn no np nq b">PlaneGeometry</code>æ˜¯æ˜¾è€Œæ˜“è§çš„é€‰æ‹©ï¼›æ˜¯çš„ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›æ›²æŠ˜ã€‚æœ‰å¾ˆé‡è¦çš„ä¸€ç‚¹è¦è®°ä½:éœ“è™¹ç¯çº¿å¿…é¡»åŒ¹é…è¿™ä¸ªå¹³é¢å‡ ä½•çš„çº¿æ¡†ï¼›æ¯”æ–¹è¯´ï¼Œå¦‚æœéœ“è™¹ç¯çº¿ä¸æ²¿ç€ä½ çš„<code class="fe nn no np nq b">PlaneGeometry</code>ç½‘æ ¼ä¸­çš„å¯¹è§’çº¿ï¼Œä½ ä¼šçœ‹åˆ°ç›¸é‚»çš„ä¸‰è§’å½¢é¢çš„é˜´å½±åœ¨å¯¹è§’çº¿ä¸Šå˜åŒ–ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ä¸€æ¡çº¿æ¥åˆ‡æ–­é˜´å½±çš„å˜åŒ–ï¼Œè§†è§‰æ•ˆæœä¼šçœ‹èµ·æ¥å¾ˆå¥‡æ€ªã€‚å› æ­¤ï¼Œå¦‚æœä½ ä½¿ç”¨é¦™è‰<code class="fe nn no np nq b">PlaneGeometry</code>ä½œä¸ºåœ°å½¢çš„åŸºç¡€å‡ ä½•å›¾å½¢ï¼Œä½ çš„éœ“è™¹çº¿ä¹Ÿéœ€è¦è¿½è¸ªé™¤å‚ç›´å’Œæ°´å¹³ç½‘æ ¼çº¿ä¹‹å¤–çš„æ‰€æœ‰å¯¹è§’çº¿ï¼Œç¼ºç‚¹æ˜¯ä½¿ä¸­å¤®é€šé“çœ‹èµ·æ¥ä¸å¯¹ç§°ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/d8862c59040317819b831e4a31c2b159.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T5LvNvjvfAdrQ9Q8gkS5hw.png"/></div></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">æ™®é€šå¹³é¢å‡ ä½•çš„çº¿æ¡†</p></figure><p id="d448" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¦‚æœæˆ‘ä»¬æƒ³é¿å…å¯¹è§’çº¿é—®é¢˜ï¼Œæœ‰3ä¸ªé€‰æ‹©ã€‚</p><ol class=""><li id="22e1" class="mf mg iq kt b ku kv kx ky la nw le nx li ny lm mm mn mo mp bi translated">å°†æ•´ä¸ª<code class="fe nn no np nq b">PlaneGeometry</code>æ—‹è½¬45åº¦ï¼</li><li id="d5e8" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">åˆ¶ä½œä¸€ä¸ªè‡ªå®šä¹‰çš„<code class="fe nn no np nq b">BufferGeometry</code>ï¼Œå®ƒæ˜¯æ—‹è½¬æ–¹å—çš„é•¶åµŒã€‚</li><li id="a7e7" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">åœ¨yæ–¹å‘å‰ªåˆ‡<code class="fe nn no np nq b">PlaneGeometry</code>ï¼Œç›´åˆ°ä½ æœ‰ä¸€ä¸ªå¯¹ç§°ä¸‰è§’å½¢çš„é•¶åµŒï¼</li></ol><div class="kg kh ki kj gt ab cb"><figure class="nz kk oa ob oc od oe paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/ee849bd01970fcd022eb6a1b3f926676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*ggCmTmsg0xFnH_qGijwpXA.png"/></div></figure><figure class="nz kk of ob oc od oe paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/3fc0c3b13481cec208b7e73c03e8a9df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*MWnTmVkF6W1qS0qRHp-poQ.png"/></div><p class="ns nt gj gh gi nu nv bd b be z dk og di oh oi translated">å·¦:é€‰é¡¹1å°†å¹³é¢æ—‹è½¬45åº¦ï¼Œå³:é€‰é¡¹2è¿›è¡Œè‡ªå®šä¹‰ç¼“å†²æµ‹é‡</p></figure></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/2c124c2636fffef5521c29aff46b8bfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DThEze54-h2aS4yK7-qaRA.png"/></div></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">é€‰é¡¹3:ä½¿ç”¨<code class="fe nn no np nq b">matrix.makeShear()</code>å‰ªåˆ‡å¹³é¢ï¼Œxyè®¾ç½®ä¸º-0.5</p></figure><p id="7ce0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä½ å¯èƒ½ä¼šè¯´ï¼Œå˜¿ï¼Œæœ‰é€‰é¡¹4ï¼Œè¿™æ˜¯ç®€å•åœ°ä½¿ç”¨ä¸€ä¸ªæ­£æ–¹å½¢ç½‘æ ¼ï¼é—æ†¾çš„æ˜¯ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå¯è¡Œçš„é€‰æ‹©ï¼Œå› ä¸ºä¸‰è§’å½¢æœ€ç»ˆæ˜¯Three.jsçš„åŸºæœ¬æ„å»ºå—ï¼›æ®æˆ‘æ‰€çŸ¥ï¼Œä¸å¯èƒ½ç”¨çº¯æ­£æ–¹å½¢æ¥å †å ç½‘æ ¼ã€‚</p><p id="ba54" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å› æ­¤ï¼Œè®©æˆ‘ä»¬è€ƒè™‘3ä¸ªé€‰é¡¹ã€‚è¯·è®°ä½ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åœ°å½¢ä¸­é“ºè®¾ä¸€æ¡å¾ˆé•¿çš„é“è·¯ï¼Œå› æ­¤æˆ‘ä»¬å¯èƒ½éœ€è¦å¤åˆ¶å’Œè¿æ¥é£æœºï¼Œä»¥ä¾¿ä½¿å®ƒæ›´é•¿ã€‚</p><ul class=""><li id="cad6" class="mf mg iq kt b ku kv kx ky la nw le nx li ny lm ok mn mo mp bi translated">å¯¹äºé€‰é¡¹1ï¼Œä»å¤´åˆ°è„šè¿æ¥å¤šä¸ªæ—‹è½¬çš„å¹³é¢ä¼šäº§ç”Ÿä¸€ä¸ªæ˜æ˜¾çš„é—®é¢˜:å®ƒä»¬ä¹‹é—´ä¼šæœ‰å¾ˆå¤§çš„ç©ºç™½ç©ºé—´ã€‚å°†ä¸€ä¸ªæŒ‡å‘å‰æ–¹çš„è±å½¢é•¶åµŒæˆä¸€æ¡é“è·¯æ˜¯éå¸¸ç—›è‹¦å’Œä½æ•ˆçš„ã€‚</li><li id="b9b2" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm ok mn mo mp bi translated">å¯¹äºé€‰é¡¹2ï¼Œè‡ªå®šä¹‰å‡ ä½•å›¾å½¢çœ‹èµ·æ¥ä¸é”™ï¼Œä½†æ˜¯å¼€é”€å¤ªé«˜ï¼›ä½ å°†ä¸å¾—ä¸è‡ªå·±è®¡ç®—å’Œè®¾ç½®é¡¶ç‚¹çš„ä½ç½®ï¼Œå¹¶ä¸”ç²¾ç¡®åœ°è¿æ¥å¹³é¢æ›´åŠ å¤æ‚ã€‚</li><li id="1209" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm ok mn mo mp bi translated">å¯¹äºé€‰é¡¹3ï¼Œåªéœ€è¦2-3è¡Œä»£ç å°±å¯ä»¥å‰ªåˆ‡å®ƒï¼Œç›´åˆ°ä¸‰è§’å½¢å¯¹å¯¹ç§°ã€‚å¼€é”€å¾ˆå°ã€‚è™½ç„¶æ•´ä¸ªå¹³é¢è¢«å¯¹è§’æ‹‰ä¼¸ï¼Œä½†ä»ç„¶å¾ˆå®¹æ˜“å°†å¹³é¢ç›¸ä¹˜å¹¶è¿æ¥èµ·æ¥ï¼Œå¦‚æœæˆ‘ä»¬æ­£ç¡®è®¾ç½®ç›¸æœºå’ŒåŠ¨ç”»å¾ªç¯ï¼Œè§‚ä¼—ä¸ä¼šæ³¨æ„åˆ°å‰ªåˆ‡ã€‚</li></ul><p id="7c76" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">é€‰é¡¹3æ˜¯èµ¢å®¶ğŸ‘‘ï¼</p><h2 id="73f8" class="nb lo iq bd lp nc nd dn lt ne nf dp lx la ng nh lz le ni nj mb li nk nl md nm bi translated"><strong class="ak"> B .å¦‚ä½•è®©åœ°å½¢ä¸­é—´å¹³å¦è€Œä¸¤è¾¹å‡¹å‡¸ä¸å¹³ï¼Ÿ</strong></h2><p id="7f1e" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">æˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€å¼ é«˜åº¦å›¾ã€‚ä¸ç®¡ä½ æ˜¯ç”¨æ‰‹å·¥è¿˜æ˜¯ç”¨ä¸€äº›ç”Ÿæˆä»£ç æ¥åšï¼Œéƒ½åº”è¯¥æ˜¯é»‘ç™½å›¾åƒï¼Œç™½è‰²ä»£è¡¨æœ€é«˜ï¼Œé»‘è‰²ä»£è¡¨æœ€ä½ã€‚æˆ‘åœ¨Affinity Designerä¸­ä½¿ç”¨å¾„å‘æ¸å˜å’Œçº¹ç†ç¬”åˆ·ç”Ÿæˆäº†æˆ‘çš„ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦ä¿æŒä¸­å¤®å‚ç›´çŸ©å½¢åŒºåŸŸä¸ºé»‘è‰²ï¼Œä»¥ä¾¿å°†å…¶ä½œä¸ºé“è·¯é“ºè®¾ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/dc96731e45bc8eafe0ba498c798ee09a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aLMP1Bo6uJfFM5ZN52o4fg.png"/></div></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">æˆ‘åœ¨åˆæˆæ³¢åœºæ™¯ä¸­ä½¿ç”¨çš„é«˜åº¦å›¾</p></figure><p id="5315" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯ç”¨è¿™ä¸ªé«˜åº¦å›¾ä¸­çš„é«˜åº¦æ•°æ®æ¥æ¸²æŸ“æˆ‘ä»¬çš„å¹³é¢å‡ ä½•ã€‚æˆ‘å°è¯•çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ä½¿ç”¨<code class="fe nn no np nq b">TextureLoader</code>åŠ è½½é«˜åº¦å›¾å›¾åƒï¼Œç„¶åå°†çº¹ç†åˆ†é…ç»™<code class="fe nn no np nq b">MeshStandardMaterial</code>çš„<code class="fe nn no np nq b">displacementMap</code>å±æ€§ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•ä¸é€‚ç”¨äºä»¥ååˆ›å»ºçš„éœ“è™¹çº¿(æˆ‘å°†åœ¨éœ“è™¹çº¿éƒ¨åˆ†è§£é‡ŠåŸå› ),å› ä¸º<code class="fe nn no np nq b">displacementMap</code>å±æ€§åªåœ¨è¿è¡Œæ—¶æ›´æ–°<code class="fe nn no np nq b">vertexShader</code>ç¨‹åºä¸­çš„é¡¶ç‚¹ä½ç½®ï¼Œæˆ‘ä»¬çš„ä¸»jsç¨‹åºä¸­çš„å¹³é¢å‡ ä½•å¯¹è±¡çš„positionsæ•°ç»„ä¸å—å½±å“ã€‚</p><p id="0d9c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å› æ­¤ï¼Œæˆ‘ä¸å¾—ä¸æ‰‹åŠ¨ä»ä½ç§»è´´å›¾ä¸­æå–ç°åº¦å€¼ï¼Œç¼©æ”¾å®ƒï¼Œå¹¶å°†å…¶å€¼ç›´æ¥åˆ†é…ç»™æˆ‘ä»¬çš„å‡ ä½•å¯¹è±¡çš„æ¯ä¸ªé¡¶ç‚¹çš„zä½ç½®å€¼ã€‚æˆ‘å‘ç°æˆ‘ä»¬ç”šè‡³ä¸éœ€è¦æ‰‹åŠ¨è®¡ç®—æ³•çº¿ï¼Œç¯å…‰åªæ˜¯ä»¥æŸç§æ–¹å¼å·¥ä½œï¼</p><h2 id="9eee" class="nb lo iq bd lp nc nd dn lt ne nf dp lx la ng nh lz le ni nj mb li nk nl md nm bi translated">å¦‚ä½•åˆ¶ä½œåœ°å½¢åŠ¨ç”»æ¥æ¨¡æ‹Ÿä¸€ä¸ªæ— å°½çš„é“è·¯æ•ˆæœï¼Ÿ</h2><p id="3853" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">è¿™ä¸ªé—®é¢˜å­˜åœ¨äºå¾ˆå¤šéœ€è¦æŸç§æ— å°½ä¹‹è·¯çš„æ¸¸æˆ/åŠ¨ç”»ä¸­ã€‚æˆ‘æ•¢è‚¯å®šï¼Œè¿™æ˜¯è§£å†³äº†å¾ˆå¤šæ¬¡ï¼Œååå¤å¤ã€‚æ˜¯çš„ï¼Œè¿™ä¸ªé—®é¢˜æœ¬èº«å¾ˆå®¹æ˜“è§£å†³ï¼Œä½†åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œæœ‰ä¸€ä¸ªé¢å¤–çš„å¤æ‚æ€§(å°†åœ¨ä¸‹ä¸€æ®µè§£é‡Š)ã€‚å¤§å±€ä¾æ—§ï¼›å‡è®¾æˆ‘ä»¬æœ‰å¤šä¸ªå¹³é¢å®ä¾‹è¿æ¥åœ¨ä¸€èµ·å½¢æˆæˆ‘ä»¬çš„é“è·¯ï¼Œæˆ‘ä»¬è®©å®ƒä»¬åƒç«è½¦ä¸€æ ·å‘ç›¸æœºåŠ é€Ÿï¼Œè¿™æ ·ä»ç›¸æœºçš„è§’åº¦çœ‹ï¼Œæˆ‘ä»¬å°±åƒæ˜¯åœ¨å‰è¿›ã€‚ä¸€æ—¦ç«è½¦çš„è½¦å¤´åœ¨æˆ‘ä»¬çš„ç›¸æœºåé¢ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒçš„ä½ç½®è°ƒå›åˆ°ç«è½¦çš„å°¾éƒ¨ï¼Œè¿™å°±æ˜¯å¦‚ä½•è®©æˆ‘ä»¬çš„è·¯çœ‹èµ·æ¥æ²¡æœ‰å°½å¤´ã€‚</p><p id="5c9d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">é¢å¤–çš„é—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•ç¡®ä¿å¹³é¢å®ä¾‹åœ¨å®ƒä»¬çš„è¿æ¥å¤„å®Œç¾åœ°ç»“åˆåœ¨ä¸€èµ·ï¼Œæ²¡æœ‰é—´éš™ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¯¹æ‰€æœ‰å¹³é¢å®ä¾‹ä½¿ç”¨ç›¸åŒçš„<code class="fe nn no np nq b">heightmap</code>ï¼Œé«˜åº¦å›¾çš„é¡¶è¡Œåƒç´ å¾ˆå¯èƒ½ä¸åº•è¡Œåƒç´ ä¸åŒ¹é…ï¼Œè‡ªç„¶ï¼Œæ‚¨ä¼šçœ‹åˆ°è¿™æ ·çš„é—´éš™:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/5143cb4f158503eaed1cd269dcb68468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZELaA1E2OAs2xF19wjR-2A.png"/></div></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">å¹³é¢å®ä¾‹ä¹‹é—´çš„é—´éš™ï¼Œå¦‚æœå®ƒä»¬æ²¡æœ‰å®Œå…¨ä»ä¸Šåˆ°ä¸‹ç¼åˆ</p></figure><p id="bf99" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è§£å†³æ–¹æ¡ˆå…¶å®å¾ˆç®€å•ã€‚æ‚¨å¯ä»¥ç¼–è¾‘æ‚¨çš„é«˜åº¦å›¾å›¾åƒï¼Œå¤åˆ¶é¡¶è¡Œåƒç´ å¹¶å°†å…¶ç²˜è´´åœ¨åº•è¡Œåƒç´ çš„é¡¶éƒ¨ã€‚é‚£è¡Œå¾—é€šã€‚</p><p id="3efd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä½†æˆ‘æ›´å–œæ¬¢ç¼–ç¨‹çš„æ–¹å¼ï¼Œå› ä¸ºå¦‚æœä½ æƒ³åœ¨é«˜åº¦å›¾å›¾åƒä¹‹é—´åˆ‡æ¢ï¼Œç¨‹åºä¼šè‡ªåŠ¨ä¸ºä½ åšå®Œç¾çš„ç¼åˆï¼Œè¿™æ ·ä½ å°±ä¸å¿…æ¯æ¬¡æƒ³å°è¯•æ–°çš„<code class="fe nn no np nq b">heightmap</code>æ—¶éƒ½äº²è‡ªåšç¼åˆå·¥ä½œã€‚</p><h1 id="e940" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">3.é¡¹ç›®çš„ä»£ç ç»“æ„</h1><p id="e2f6" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">æˆ‘ä»æˆ‘çš„è‡ªå®šä¹‰æ¨¡æ¿å¼€å§‹è¿™ä¸ªé¡¹ç›®ï¼Œåœ¨https://github.com/franky-adl/threejs-starter-templateå…¬å¼€æ‰˜ç®¡ã€‚ç¼–å†™æœ¬æ•™ç¨‹æ—¶ï¼Œå‡è®¾æ‚¨ä½¿ç”¨æ­¤åˆå­¦è€…æ¨¡æ¿å¼€å§‹é¡¹ç›®ã€‚</p><p id="3bff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å½“ç„¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½•æ‚¨å–œæ¬¢çš„æ ·æ¿æ–‡ä»¶æˆ–è®¾ç½®ï¼Œç„¶åæ‚¨å¿…é¡»åšä¸€äº›å°çš„ä»£ç ç¿»è¯‘ï¼Œä½¿æˆ‘çš„ä»£ç ä¸ºæ‚¨çš„è®¾ç½®å·¥ä½œã€‚å…³äºè¿™ä¸ªåˆå­¦è€…æ¨¡æ¿å¦‚ä½•å·¥ä½œçš„æ›´å¤šç»†èŠ‚ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æˆ‘ä»¥å‰çš„æ–‡ç« ã€‚</p><p id="bf77" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç°åœ¨ï¼Œè®©æˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹ä»£ç çš„ç»“æ„ã€‚</p><p id="ada7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">é¡¹ç›®æ–‡ä»¶å±‚æ¬¡ç»“æ„:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="096d" class="or lo iq nq b be os ot l ou ov">.<br/>â”œâ”€â”€ src<br/>â”‚   â””â”€â”€ assets<br/>â”‚       â”œâ”€â”€ heightmap.png<br/>â”‚       â””â”€â”€ Starfield.png<br/>â”‚   â”œâ”€â”€ common-utils.js<br/>â”‚   â”œâ”€â”€ core-utils.js<br/>â”‚   â”œâ”€â”€ functions.js<br/>â”‚   â”œâ”€â”€ index.html<br/>â”‚   â””â”€â”€ index.js<br/>â”œâ”€â”€ .gitignore<br/>â”œâ”€â”€ package-lock.json<br/>â””â”€â”€ package.json</span></pre><p id="cf9e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘ä»¬æ‰€æœ‰çš„ä»£ç å’Œå›¾ç‰‡åŸºæœ¬ä¸Šéƒ½åœ¨<code class="fe nn no np nq b">src</code>æ–‡ä»¶å¤¹é‡Œã€‚åœ¨<code class="fe nn no np nq b">package.json</code>ä¸­ï¼Œæˆ‘ä»¬åªæœ‰3ä¸ªä¾èµ–é¡¹:</p><ul class=""><li id="0b23" class="mf mg iq kt b ku kv kx ky la nw le nx li ny lm ok mn mo mp bi translated"><code class="fe nn no np nq b">three@0.145.0</code>:three . jsåº“</li><li id="2fcb" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm ok mn mo mp bi translated"><code class="fe nn no np nq b">dat.gui@0.7.9</code>:GUIæ§ä»¶åº“</li><li id="48dd" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm ok mn mo mp bi translated"><code class="fe nn no np nq b">parcel@2.7.0</code>:æ†æ‰æœºå·¥å…·</li></ul><p id="8b2d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åœ¨<code class="fe nn no np nq b">src</code>ä¸­ï¼Œå°†æ‰€æœ‰çš„çº¹ç†/å›¾åƒä¿å­˜åœ¨<code class="fe nn no np nq b">assets</code>å­æ–‡ä»¶å¤¹ä¸‹ã€‚</p><p id="bd5f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åŒ…å«å¤§éƒ¨åˆ†åœºæ™¯æ„å»ºä»£ç çš„æ–‡ä»¶æ˜¯<code class="fe nn no np nq b">index.js</code>æ–‡ä»¶ã€‚</p><p id="2252" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nn no np nq b">core-utils.js</code>åŒ…å«ä¸€äº›æ–¹ä¾¿çš„æ–¹æ³•ï¼Œç”¨äºè®¾ç½®å¤§å¤šæ•°Three.jsé¡¹ç›®ä¸­éœ€è¦çš„å…¬å…±å¯¹è±¡(å³ç›¸æœºã€æ¸²æŸ“å™¨ã€åˆæˆå™¨ã€çª—å£å¤§å°è°ƒæ•´ç›‘å¬å™¨ã€é¼ æ ‡<code class="fe nn no np nq b">onmove</code>ç›‘å¬å™¨ã€åŠ¨ç”»å¾ªç¯)ã€‚</p><p id="f7f4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nn no np nq b">common-utils.js</code>æœ‰ä¸€äº›æ›´æ–¹ä¾¿çš„æ–¹æ³•ï¼Œæˆ‘è‡ªå·±å‘ç°è¿™äº›æ–¹æ³•åœ¨Three.jsé¡¹ç›®ä¸­å¾ˆæœ‰ç”¨(ä¾‹å¦‚ï¼Œæ”¯æŒasync/awaitçš„å›¾åƒåŠ è½½å‡½æ•°ï¼Œåå…­è¿›åˆ¶åˆ°rgbçš„è½¬æ¢å™¨ç­‰ç­‰)ã€‚</p><p id="3958" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nn no np nq b">functions.js</code>åŒ…å«äº†åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°æœ‰åŠ©äºä»ä¸»jsæ–‡ä»¶ä¸­å–å‡ºéƒ¨åˆ†ä»£ç ï¼Œä½¿å…¶å¯è¯»æ€§æ›´å¥½ï¼Œä½“ç§¯æ›´å°ã€‚</p><p id="08ba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nn no np nq b">index.html</code>æ˜¯package bundlerçš„å…¥å£ç‚¹ï¼Œå®ƒæœ‰ä¸€ä¸ªè¯·æ±‚<code class="fe nn no np nq b">index.js</code>æ–‡ä»¶çš„è„šæœ¬æ ‡ç­¾ã€‚</p><h1 id="16d1" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">4.è®¾ç½®åœºæ™¯ç¯å¢ƒ</h1><p id="0b50" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬ä½¿ç”¨æˆ‘çš„<code class="fe nn no np nq b"><a class="ae na" href="https://github.com/franky-adl/threejs-starter-template" rel="noopener ugc nofollow" target="_blank">threejs-starter-template</a></code>å¼€å§‹è¿™ä¸ªé¡¹ç›®ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤å°†æ‰“å¼€ä¸€ä¸ªé€‰é¡¹å¡ï¼Œæ˜¾ç¤ºä¸€äº›ç¯ç®±åé¢çš„æ—‹è½¬åœ†ç¯ã€‚</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="6ae9" class="or lo iq nq b be os ot l ow ov">git clone https://github.com/franky-adl/threejs-starter-template<br/>cd threejs-starter-template<br/>npm i<br/>npm run start</span></pre><p id="5b14" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æ ¹æ®è‡ªå·±çš„å–œå¥½ï¼Œåœ¨ä¸åŒçš„åœ°æ–¹é‡å‘½åé¡¹ç›®åç§°<code class="fe nn no np nq b">threejs-starter-template</code>ã€‚åœºæ™¯ä¸­çš„ç‰©ä½“åªæ˜¯ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬éœ€è¦ç§»é™¤å®ƒä»¬ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é‡æ–°å¼€å§‹ã€‚</p><p id="c72d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿›è¡Œæ¸…ç†ï¼Œå¹¶ç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢<code class="fe nn no np nq b">index.js</code>çš„å†…å®¹:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="23f5" class="or lo iq nq b be os ot l ow ov">// ThreeJS and Third-party deps<br/>import * as THREE from "three"<br/>import * as dat from 'dat.gui'<br/>import Stats from "three/examples/jsm/libs/stats.module"<br/>import { OrbitControls } from "three/examples/jsm/controls/OrbitControls"<br/><br/>// Core boilerplate code deps<br/>import { createCamera, createComposer, createRenderer, runApp } from "./core-utils"<br/><br/>global.THREE = THREE<br/><br/>/**************************************************<br/> * 0. Tweakable parameters for the scene<br/> *************************************************/<br/>const params = {<br/>  // general scene params<br/>}<br/><br/><br/>/**************************************************<br/> * 1. Initialize core threejs components<br/> *************************************************/<br/>// Create the scene<br/>let scene = new THREE.Scene()<br/><br/>// Create the renderer via 'createRenderer',<br/>// 1st param receives additional WebGLRenderer properties<br/>// 2nd param receives a custom callback to further configure the renderer<br/>let renderer = createRenderer({ antialias: true })<br/><br/>// Create the camera<br/>// Pass in fov, near, far and camera position respectively<br/>let camera = createCamera(45, 1, 1000, { x: 0, y: 5, z: -15 })<br/><br/>// The RenderPass is already created in 'createComposer'<br/>let composer = createComposer(renderer, scene, camera, (comp) =&gt; {<br/>})<br/><br/>/**************************************************<br/> * 2. Build your scene in this threejs app<br/> * This app object needs to consist of at least the async initScene() function (it is async so the animate function can wait for initScene() to finish before being called)<br/> * initScene() is called after a basic threejs environment has been set up, you can add objects/lighting to you scene in initScene()<br/> * if your app needs to animate things(i.e. not static), include a updateScene(interval, elapsed) function in the app as well<br/> *************************************************/<br/>let app = {<br/>  async initScene() {<br/>    // OrbitControls<br/>    this.controls = new OrbitControls(camera, renderer.domElement)<br/>    this.controls.enableDamping = true<br/><br/>    // GUI controls<br/>    const gui = new dat.GUI()<br/><br/>    // Stats - show fps<br/>    this.stats1 = new Stats()<br/>    this.stats1.showPanel(0) // Panel 0 = fps<br/>    this.stats1.domElement.style.cssText = "position:absolute;top:0px;left:0px;"<br/>    // this.container is the parent DOM element of the threejs canvas element<br/>    this.container.appendChild(this.stats1.domElement)<br/>  },<br/>  // @param {number} interval - time elapsed between 2 frames<br/>  // @param {number} elapsed - total time elapsed since app start<br/>  updateScene(interval, elapsed) {<br/>    this.controls.update()<br/>    this.stats1.update()<br/>  }<br/>}<br/><br/>/**************************************************<br/> * 3. Run the app<br/> * 'runApp' will do most of the boilerplate setup code for you:<br/> * e.g. HTML container, window resize listener, mouse move/touch listener for shader uniforms, THREE.Clock() for animation<br/> * Executing this line puts everything together and runs the app<br/> * ps. if you don't use custom shaders, pass undefined to the 'uniforms'(2nd-last) param<br/> * ps. if you don't use post-processing, pass undefined to the 'composer'(last) param<br/> *************************************************/<br/>runApp(app, scene, renderer, camera, true, undefined, composer)</span></pre><p id="a306" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç„¶åï¼Œä»èµ„äº§æ–‡ä»¶å¤¹ä¸­ç§»é™¤<code class="fe nn no np nq b">checker_tile.png</code>ã€‚</p><p id="0f9c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç°åœ¨è¿è¡Œ<code class="fe nn no np nq b">npm run start</code>åº”è¯¥ä¼šç»™ä½ ä¸€ä¸ªé»‘å±ï¼Œåœ¨å·¦ä¸Šè§’åªæœ‰fpsè®¡æ•°å™¨ã€‚ä»ç°åœ¨å¼€å§‹ä¿å­˜å¯¹æ–‡ä»¶çš„ä»£ç æ›´æ”¹å°†è§¦å‘packet bundlerè‡ªåŠ¨é‡æ–°æ„å»ºï¼Œå¹¶ä¸”æ‚¨çš„Three.jsæµè§ˆå™¨é€‰é¡¹å¡å°†è‡ªåŠ¨åˆ·æ–°ã€‚</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="996a" class="or lo iq nq b be os ot l ow ov">% npm run start<br/><br/>&gt; threejs-synthwave-scene@1.0.0 start<br/>&gt; parcel src/index.html --open<br/><br/>Server running at http://localhost:1234<br/>âœ¨ Built in 1.21s</span></pre><p id="c7bf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è®©æˆ‘ä»¬å…ˆæ”¾ä¸€å¼ èƒŒæ™¯å›¾ç‰‡å§ï¼</p><p id="58cb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å°†<a class="ae na" href="https://github.com/franky-adl/threejs-synthwave-scene" rel="noopener ugc nofollow" target="_blank"> my synthwave repo </a>ä¸­çš„<code class="fe nn no np nq b">Starfield.png</code>å¤åˆ¶åˆ°assetsæ–‡ä»¶å¤¹ä¸­ã€‚</p><p id="9d57" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç”¨ä»¥ä¸‹å†…å®¹åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶<code class="fe nn no np nq b">functions.js</code>:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="32e3" class="or lo iq nq b be os ot l ow ov">import { maintainBgAspect } from "./common-utils"<br/><br/>/**<br/> * @param {object} scene the Three.js scene object<br/> * @param {object} image the path to the background image<br/> * @returns a Promise that resolves after the texture is loaded as the scene's background<br/> */<br/>export const loadSceneBackground = (scene, image) =&gt; {<br/>  return new Promise((resolve, reject) =&gt; {<br/>    var loader = new THREE.TextureLoader();<br/>    loader.load(image, function (texture) {<br/>      scene.background = texture<br/>      // position scene background such that image aspect ratio is preserved<br/>      maintainBgAspect(scene, texture.image.width, texture.image.height)<br/>      // need to maintain background aspect ratio across window resizes<br/>      window.addEventListener("resize", () =&gt; {<br/>        maintainBgAspect(scene, texture.image.width, texture.image.height)<br/>      })<br/>      resolve()<br/>    }, undefined, function (error) {<br/>      console.log(error)<br/>      reject(error)<br/>    });<br/>  })<br/>}</span></pre><p id="417b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘ä»¬ç”¨ä¸€ä¸ª<code class="fe nn no np nq b">Promise</code>åŒ…è£…<code class="fe nn no np nq b">TextureLoader.load()</code>å‡½æ•°çš„å›è°ƒï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨<code class="fe nn no np nq b">async initScene()</code>å‡½æ•°ä¸­ä½¿ç”¨<code class="fe nn no np nq b">loadSceneBackground</code>ä¸Šçš„<code class="fe nn no np nq b">await</code>è¡¨è¾¾å¼ã€‚</p><p id="ed56" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘ä»¬å¸Œæœ›è¿™ä¸ª<code class="fe nn no np nq b">Promise</code>åªæœ‰åœ¨çº¹ç†è¢«åŠ è½½æ—¶æ‰èƒ½è¢«è§£æï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨ä¼ é€’ç»™<code class="fe nn no np nq b">loader.load()</code>çš„<code class="fe nn no np nq b">onLoad</code>å›è°ƒä¸­è°ƒç”¨<code class="fe nn no np nq b">resolve()</code>ã€‚è¿™ç¡®ä¿äº†æˆ‘ä»¬çš„åœºæ™¯åªæœ‰åœ¨èƒŒæ™¯å®Œå…¨åŠ è½½åæ‰è¢«æ­å¼€ã€‚ç”±äº<code class="fe nn no np nq b">core-utils.js</code>ä¸­çš„<code class="fe nn no np nq b">runApp()</code>å‡½æ•°ä¸­çš„ä»£ç ï¼Œè¯¥æ­ç¤ºæœºåˆ¶èµ·ä½œç”¨:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="b8f9" class="or lo iq nq b be os ot l ow ov">app.initScene().then(() =&gt; {<br/>  const veil = document.getElementById("veil")<br/>  veil.style.opacity = 0<br/>  return true<br/>})</span></pre><p id="fe0c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åå°åŠ è½½å‡½æ•°å°±ç»ªåï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸»ç¨‹åºä¸­æ‰§è¡Œå®ƒã€‚</p><p id="7df4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¯¹<code class="fe nn no np nq b">index.js</code>è¿›è¡Œä»¥ä¸‹ä»£ç æ›´æ”¹:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="a222" class="or lo iq nq b be os ot l ow ov">+ import { loadSceneBackground } from "./functions"<br/>+ import Background from "./assets/Starfield.png"<br/><br/>...<br/><br/>let app = {<br/>  async initScene() {<br/>    // OrbitControls<br/>    this.controls = new OrbitControls(camera, renderer.domElement)<br/>    this.controls.enableDamping = true<br/><br/>+   // Environment<br/>+   await loadSceneBackground(scene, Background)</span></pre><p id="5724" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†ç¹æ˜Ÿæ»¡å¤©çš„å¤œç©ºï¼å¾ˆå¥½å¾ˆå®¹æ˜“ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/398825e054b78564fe2918d17a32daf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LswiFO2OTD010O6AQmwh_Q.png"/></div></div></figure><h1 id="3616" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">5.ä¸ºåœ°å½¢â›°è®¾ç½®å¹³é¢å‡ ä½•ä½“</h1><p id="f51b" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">é¦–å…ˆï¼Œå°†æˆ‘çš„<code class="fe nn no np nq b">synthwave</code>å›è´­ä¸­çš„<code class="fe nn no np nq b">heightmap.png</code>å¤åˆ¶åˆ°assetsæ–‡ä»¶å¤¹ä¸­ã€‚</p><p id="7af3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æ¥ä¸‹æ¥ï¼Œå°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°<code class="fe nn no np nq b">common-utils.js</code>ä¸­:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="09bf" class="or lo iq nq b be os ot l ow ov">/**<br/> * This loadImage function returns a Promise that is resolved when the image finishes loading<br/> * if you use it with await, it returns the loaded image object<br/> * @param {string} path image file path<br/> * @returns a Promise that resolves with the value assigned as the loaded image<br/> */<br/>export const loadImage = (path) =&gt; {<br/>    return new Promise((resolve, reject) =&gt; {<br/>        const img = new Image()<br/>        img.crossOrigin = "Anonymous" // to avoid CORS if used with Canvas<br/>        img.src = path<br/>        img.onload = () =&gt; {<br/>            resolve(img)<br/>        }<br/>        img.onerror = (e) =&gt; {<br/>            reject(e)<br/>        }<br/>    })<br/>}</span></pre><p id="c71d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥åŒæ­¥åŠ è½½æˆ‘ä»¬çš„<code class="fe nn no np nq b">heightmap</code>ã€‚</p><p id="8fc3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç„¶åï¼Œå°†ä»¥ä¸‹ä»£ç è¿½åŠ åˆ°<code class="fe nn no np nq b">functions.js</code>ä¸­:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="11b1" class="or lo iq nq b be os ot l ow ov">/**<br/> * original reference: https://gist.github.com/jawdatls/465d82f2158e1c4ce161<br/> * This function lets you get the greyscale color value from a specific point in an image<br/> * In this scenario, we pass in a displacement map as imageData,<br/> * and u/v values which gets translated to a certain point on the image<br/> * getting either one of r/g/b value as the displacement value is the same<br/> * since the image is supposed to be black and white<br/> * note that the direction of v axis in texture data is the inverse of the y axis in image data<br/> *<br/> * @param {object} imageData the color data of the displacement map image to be passed in<br/> * @param {number} u the x position [0,1] of the target pixel<br/> * @param {number} v the y position [0,1] of the target pixel<br/> * @param {number} cvWidth the width of the heightmap image in canvas<br/> * @param {number} cvHeight the height of the heightmap image in canvas<br/> * @returns {number} height value of the requested point within [0,5]<br/> */<br/>export function getZFromImageDataPoint(imageData, u, v, cvWidth, cvHeight) {<br/>  const mapWidth = cvWidth<br/>  const mapHeight = cvHeight<br/>  const displacementScale = 5<br/>  var x = Math.round(u * (mapWidth - 1))<br/>  var y = Math.round((1 - v) * (mapHeight - 1))<br/>  var index = (y * imageData.width + x) * 4<br/>  var red = imageData.data[index]<br/>  return red / 255 * displacementScale<br/>}</span></pre><p id="2a04" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘ä»¬å°†ä½¿ç”¨è¯¥å‡½æ•°ä»<code class="fe nn no np nq b">heightmap.png</code>ä¸­æå–æ¯ä¸ªå¹³é¢é¡¶ç‚¹å¯¹åº”åƒç´ çš„é«˜åº¦å€¼ã€‚</p><p id="a8ef" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¯¥å‡½æ•°çš„<code class="fe nn no np nq b">u</code>å’Œ<code class="fe nn no np nq b">v</code>è¾“å…¥æ­£å¥½æ˜¯å¹³é¢é¡¶ç‚¹çš„uvå€¼ã€‚è¯¥å‡½æ•°å°†uvåæ ‡è½¬æ¢ä¸ºå›¾åƒåæ ‡ã€‚</p><p id="3c02" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¯¹äºè¿™ä¸€è¡Œä»£ç <code class="fe nn no np nq b">var index = (y * imageData.width + x) * 4</code>ï¼Œ<code class="fe nn no np nq b">y</code>å’Œ<code class="fe nn no np nq b">x</code>æ˜¯å›¾åƒæ•°æ®ä¸­æ˜ å°„çš„è¡Œå·å’Œåˆ—å·ï¼Œä¹˜ä»¥4æ˜¯å› ä¸º<code class="fe nn no np nq b">imageData.data </code>é¡ºåºå­˜å‚¨æ‰€æœ‰åƒç´ çš„é¢œè‰²å€¼(å³ã€rï¼Œgï¼Œbï¼Œaï¼Œrï¼Œgï¼Œbï¼Œaï¼Œâ€¦ã€‘)ã€‚</p><p id="eec1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å› æ­¤ï¼Œäº§ç”Ÿçš„<code class="fe nn no np nq b">index</code>æ˜¯æ¯ä¸ªåƒç´ çš„ç¬¬ä¸€ä¸ªé¢œè‰²é€šé“ï¼Œä¸ºçº¢è‰²ã€‚æˆ‘ä»¬å¾—åˆ°å“ªä¸ªé¢œè‰²é€šé“å¹¶ä¸é‡è¦ï¼Œå› ä¸ºé«˜åº¦å›¾æ˜¯é»‘ç™½çš„ã€‚</p><p id="8283" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æœ€åï¼Œæˆ‘ä»¬å°†è¯¥å€¼æ”¾å¤§5å€ã€‚å› æ­¤ï¼Œè¯¥å‡½æ•°çš„è¿”å›å€¼åœ¨[0ï¼Œ5]çš„èŒƒå›´å†…ã€‚</p><p id="5677" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è®©æˆ‘ä»¬åœ¨<code class="fe nn no np nq b">index.js</code>ä¸­è¿›è¡Œä»¥ä¸‹ä»£ç æ›´æ”¹:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="39c1" class="or lo iq nq b be os ot l ow ov">+ import { loadImage } from "./common-utils"<br/>- import { loadSceneBackground } from "./functions"<br/>+ import { loadSceneBackground, getZFromImageDataPoint } from "./functions"<br/>import Background from "./assets/Starfield.png"<br/>+ import HeightMap from "./assets/heightmap.png"<br/><br/>global.THREE = THREE<br/><br/>/**************************************************<br/> * 0. Tweakable parameters for the scene<br/> *************************************************/<br/>const params = {<br/>  // general scene params<br/>+ dirLightColor1: 0x2dd7ff,<br/>+ dirLightColor2: 0x2dd7ff,<br/>+ // plane params<br/>+ metalness: 0.2,<br/>+ roughness: 0.7,<br/>+ meshColor: 0xffffff,<br/>+ meshEmissive: 0x000098,<br/>}<br/>+ const terrainWidth = 30<br/>+ const terrainHeight = 30<br/>+ const lightPos1 = {<br/>+   x: 15,<br/>+   y: 1,<br/>+   z: 5<br/>+ }<br/>+ const lightIntensity1 = 0.85<br/>+ const lightPos2 = {<br/>+   x: -15,<br/>+   y: 1,<br/>+   z: 5<br/>+ }<br/>+ const lightIntensity2 = 0.85<br/><br/>...<br/><br/>- let camera = createCamera(45, 1, 1000, { x: 0, y: 5, z: -15 })<br/>+ let camera = createCamera(70, 1, 120, { x: 0, y: 0, z: 2.4 })<br/><br/>...<br/><br/>let app = {<br/>  async initScene() {<br/>    // OrbitControls<br/>    this.controls = new OrbitControls(camera, renderer.domElement)<br/>    this.controls.enableDamping = true<br/><br/>    // Environment<br/>    await loadSceneBackground(scene, Background)<br/><br/>+   // Lighting<br/>+   this.dirLight1 = new THREE.DirectionalLight(params.dirLightColor1, lightIntensity1)<br/>+   this.dirLight1.position.set(lightPos1.x, lightPos1.y, lightPos1.z)<br/>+   scene.add(this.dirLight1)<br/>+   this.dirLight2 = new THREE.DirectionalLight(params.dirLightColor2, lightIntensity2)<br/>+   this.dirLight2.position.set(lightPos2.x, lightPos2.y, lightPos2.z)<br/>+   scene.add(this.dirLight2)<br/><br/>+   // load heightmap to a new image first, then read its color data to set the heights of our plane vertices<br/>+   // see: https://gist.github.com/jawdatls/465d82f2158e1c4ce161<br/>+   let hm_image = await loadImage(HeightMap)<br/>+   var canvas = document.createElement("canvas")<br/>+   canvas.width = hm_image.width<br/>+   canvas.height = hm_image.height<br/>+   var context = canvas.getContext("2d")<br/>+   context.drawImage(hm_image, 0, 0)<br/>+   var hm_imageData = context.getImageData(0, 0, canvas.width, canvas.height)<br/><br/>+   // Create a PlaneGeom<br/>+   let planeGeometry = new THREE.PlaneGeometry(terrainWidth, terrainHeight, terrainWidth, terrainHeight)<br/>+   let geometryPositions = planeGeometry.getAttribute("position").array<br/>+   let geometryUVs = planeGeometry.getAttribute("uv").array<br/><br/>+   // update each vertex position's z value according to the value we extracted from the heightmap image<br/>+   for (let index = 0; index &lt; geometryUVs.length / 2; index++) {<br/>+     let vertexU = geometryUVs[index * 2]<br/>+     let vertexV = geometryUVs[index * 2 + 1]<br/>+     // Update the z positions according to height map<br/>+     let terrainHeight = getZFromImageDataPoint(hm_imageData, vertexU, vertexV, canvas.width, canvas.height)<br/>+     geometryPositions[index * 3 + 2] = terrainHeight<br/>+   }<br/>+   // skew the plane geometry<br/>+   const shearMtx = new THREE.Matrix4()<br/>+   shearMtx.makeShear(-0.5, 0, 0, 0, 0, 0)<br/>+   planeGeometry.applyMatrix4(shearMtx)<br/><br/>+   // material for the plane geometry<br/>+   let meshMaterial = new THREE.MeshStandardMaterial({<br/>+     color: new THREE.Color(params.meshColor),<br/>+     emissive: new THREE.Color(params.meshEmissive),<br/>+     metalness: params.metalness,<br/>+     roughness: params.roughness,<br/>+     flatShading: true<br/>+   })<br/><br/>+   // create plane mesh and add to scene<br/>+   let mesh = new THREE.Mesh(planeGeometry, meshMaterial)<br/>+   mesh.position.set(0, -1.5, 0)<br/>+   mesh.rotation.x -= Math.PI / 2<br/>+   scene.add(mesh)<br/><br/>    // GUI controls<br/>    const gui = new dat.GUI()</span></pre><p id="ea5e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬æ·»åŠ ä¾èµ–å…³ç³»å’Œå¿…è¦çš„å˜é‡ï¼Œç”¨äºè®¾ç½®ç…§æ˜å’Œå¹³é¢å‡ ä½•ä½“+æè´¨ã€‚æˆ‘ä»¬è¿˜æ›´æ–°äº†æ‘„åƒæœºï¼Œä»¥ä¾¿æ›´å¥½åœ°è§‚å¯Ÿæˆ‘ä»¬çš„åœºæ™¯ï¼›æˆ‘å–œæ¬¢ä½¿ç”¨æ›´å¤§çš„<code class="fe nn no np nq b">fov</code>ï¼Œè¿™æ ·åœºæ™¯çœ‹èµ·æ¥æ›´å®½ã€‚</p><p id="5c4e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç„¶ååœ¨<code class="fe nn no np nq b">initScene()</code>ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸¤ä¸ª<code class="fe nn no np nq b">DirectionalLight</code>æ¥ç…§å°„å·¦å³ä¸¤è¾¹çš„å±±ä½“ã€‚å¦‚æœæ²¡æœ‰å…‰çº¿ï¼Œæ•´ä¸ªåœ°å½¢ä¼šæœ‰ç›¸åŒçš„é¢œè‰²ï¼Œæ²¡æœ‰æ˜æš—å˜åŒ–ã€‚</p><p id="d69d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä¹‹åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code class="fe nn no np nq b">canvas</code>å¯¹è±¡æ¥å­˜å‚¨åŠ è½½çš„é«˜åº¦å›¾å›¾åƒï¼Œå¹¶é€šè¿‡<code class="fe nn no np nq b">context.getImageData()</code>å°†å›¾åƒæ•°æ®ä¿å­˜åˆ°<code class="fe nn no np nq b">hm_imageData</code>ä¸­ã€‚ä¸è¦æ‹…å¿ƒï¼Œè¿™ä¸ªç”»å¸ƒæ²¡æœ‰æ·»åŠ åˆ°æ–‡æ¡£ä¸­ï¼Œå› æ­¤åœ¨å±å¹•ä¸Šæ˜¯ä¸å¯è§çš„ã€‚</p><p id="e433" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå…·æœ‰ç›¸åŒå®½åº¦å’Œé«˜åº¦(è®¾ç½®ä¸º30)çš„æ­£æ–¹å½¢<code class="fe nn no np nq b">planeGeometry</code>ï¼Œä¸ºç®€å•èµ·è§ï¼Œå®½åº¦/é«˜åº¦æ®µä¹Ÿå…·æœ‰ç›¸åŒçš„å€¼ã€‚æˆ‘ä»¬ä»æ™®é€šçš„<code class="fe nn no np nq b">PlaneGeometry</code>ä¸­æå–å‡º<code class="fe nn no np nq b">BufferAttribute</code>ä¸­çš„<code class="fe nn no np nq b">position</code>å’Œ<code class="fe nn no np nq b">uv</code>æ•°ç»„ä»¥å¤‡åç”¨ã€‚</p><p id="e043" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç„¶åæˆ‘ä»¬éå†æ‰€æœ‰çš„é¡¶ç‚¹æ¥è®¾ç½®æ¯ä¸ªé¡¶ç‚¹çš„é«˜åº¦å€¼ã€‚æˆ‘ä»¬ä½¿ç”¨<code class="fe nn no np nq b">getZFromImageDataPoint()</code>æ¥è·å¾—é«˜åº¦å›¾ä¸Šæ¯ä¸ªé¡¶ç‚¹å¯¹åº”çš„é«˜åº¦å€¼ã€‚çœ‹çœ‹forå¾ªç¯ï¼Œ<code class="fe nn no np nq b">geometryUVs.length / 2</code>è¡¨ç¤ºé¡¶ç‚¹çš„æ€»æ•°ï¼Œå› ä¸º<code class="fe nn no np nq b">BufferAttribute</code>æ•°ç»„åœ¨ä¸€ä¸ªå±‚ä¸­é¡ºåºå­˜å‚¨å€¼ï¼Œè€Œä¸æ˜¯åµŒå¥—æ¯ä¸ªé¡¶ç‚¹çš„xï¼Œyï¼Œzæˆ–uï¼Œvå€¼ï¼›è§ä¸‹å›¾ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/37f4e1ef68b7862b12685cef3b45bbfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*xRZcvLRl8p4ZjkmC7O4jtA.png"/></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">æ¯ä¸ªBufferAttributeçš„æ•°ç»„ç»“æ„ï¼Œå›¾ç‰‡æ¥è‡ª<a class="ae na" href="https://threejs.org/manual/#en/custom-buffergeometry" rel="noopener ugc nofollow" target="_blank">https://threejs.org/manual/#en/custom-buffergeometry</a></p></figure><p id="9b60" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨<code class="fe nn no np nq b">geometryPositions[index * 3 + 2]</code>ä¸­ï¼Œweä¹˜ä»¥3å› ä¸ºæ¯ä¸ªé¡¶ç‚¹æœ‰3ä¸ªä½ç½®å€¼xï¼Œyï¼Œzï¼ŒåŠ 2å°±æ˜¯å¾—åˆ°zå€¼ã€‚</p><p id="fdbe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»ä¸ºæ¯ä¸ªé¡¶ç‚¹è®¾ç½®äº†æ­£ç¡®çš„é«˜åº¦ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦æ²¿ç€yæ–¹å‘å‰ªåˆ‡å¹³é¢ã€‚æˆ‘æ²¡æœ‰çœŸæ­£æ·±å…¥åˆ°<code class="fe nn no np nq b">makeShear</code>å‡½æ•°çš„æºä»£ç ä¸­ï¼Œä½†æ˜¯å¦‚æœæˆ‘æ²¡æœ‰å¼„é”™çš„è¯ï¼Œç”¨<code class="fe nn no np nq b">0.5</code>å‰ªåˆ‡å®ƒåº”è¯¥æ˜¯æ­£ç¡®çš„å¹…åº¦ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/42bf7eb434ab18a8a86eed95ca1c576f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dQuUxzk7rytJAuojP29MiQ.png"/></div></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">æˆ‘ä»¬æƒ³æ²¿ç€yè½´å‰ªåˆ‡å®ƒï¼Œç›´åˆ°å›¾æ¡ˆçœ‹èµ·æ¥åƒä¸€å¯¹å¯¹ç§°ä¸‰è§’å½¢çš„ç»„åˆ</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/05048d0a396b7d99ce3a33fa23503f0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Q4NeyC5z2ec2TQN36t8kA.png"/></div></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">è™šçº¿è¡¨ç¤ºæ™®é€šå¹³é¢å‡ ä½•å½¢çŠ¶çš„ä¸€ä¸ªå•å…ƒï¼Œå®çº¿è¡¨ç¤ºå‰ªåˆ‡çŠ¶æ€</p></figure><p id="7a92" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘ä»¬åˆ›å»ºçš„æ™®é€šå¹³é¢å‡ ä½•ä½“ç”±æ­£æ–¹å½¢ç»„æˆï¼Œå› ä¸ºå®½åº¦å’Œé«˜åº¦å€¼ä¸å®½åº¦å’Œé«˜åº¦éƒ¨åˆ†ç›¸åŒã€‚æˆ‘ä»¬æƒ³åœ¨yæ–¹å‘å‰ªåˆ‡å®ƒä¸€åŠçš„æ­£æ–¹å½¢é•¿åº¦<code class="fe nn no np nq b">l/2</code>ã€‚æŸ¥çœ‹ä¸Šé¢ç®€åŒ–çš„2då‰ªåˆ‡æ–¹ç¨‹ï¼Œå¦‚æœæˆ‘ä»¬å°†å‰ªåˆ‡å› å­<code class="fe nn no np nq b">s</code>è®¾ç½®ä¸º0.5ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾—åˆ°çš„åæ ‡å°†æ˜¯<code class="fe nn no np nq b">(x, y + 0.5x)</code>ã€‚ä»£å…¥<code class="fe nn no np nq b">x = l</code>ï¼Œå‰ªåˆ‡çš„é‡å°±æ˜¯<code class="fe nn no np nq b">l/2</code>ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„é‡ã€‚</p><p id="8dcd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae na" href="https://www.youtube.com/watch?v=cxbTV5Jjm6s" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªè§†é¢‘</a>å¾ˆå¥½åœ°è§£é‡Šäº†å‰ªåˆ‡æ¦‚å¿µã€‚</p><p id="9337" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¯¹äºå¹³é¢æè´¨ï¼Œæˆ‘ä»¬ä½¿ç”¨<code class="fe nn no np nq b">MeshStandardMaterial</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="fe nn no np nq b">metalness</code>å’Œ<code class="fe nn no np nq b">roughness</code>è¿›è¡Œè°ƒæ•´ã€‚æ‰“å¼€<code class="fe nn no np nq b">flatShading</code>å¾ˆé‡è¦ï¼Œå› ä¸ºè§†è§‰æ ·å¼æ›´é€‚åˆä½å¤šè¾¹å½¢çš„å¯¹è±¡ã€‚</p><p id="2e9e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åº”ç”¨æ‰€æœ‰æ›´æ”¹åï¼Œæ‚¨çš„åœºæ™¯ç°åœ¨åº”è¯¥å¦‚ä¸‹æ‰€ç¤º:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/cec0aae3ea400429ae737baf069bffea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p0KTJpMyuOpH4K9A6pRP4w.png"/></div></div></figure><h1 id="59f1" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">6.åœ¨åœ°å½¢ä¸Šåˆ›å»ºäº®/éœ“è™¹ç½‘æ ¼çº¿</h1><p id="6899" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">æœ€åˆï¼Œæˆ‘å°è¯•ä½¿ç”¨<code class="fe nn no np nq b">WireframeGeometry</code>å’Œ<code class="fe nn no np nq b">LineSegments</code>æ¥åˆ›å»ºç½‘æ ¼çº¿ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªä¸¥é‡çš„é™åˆ¶ã€‚é—æ†¾çš„æ˜¯ï¼Œä½¿ç”¨çš„<code class="fe nn no np nq b">LineBasicMaterial</code>è¢«é™åˆ¶ä¸º<code class="fe nn no np nq b">linewidth</code>æ€»æ˜¯ä¸º1ï¼Œè€Œä¸ç®¡è®¾ç½®äº†ä»€ä¹ˆå€¼ã€‚</p><p id="0cd7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¹¸è¿çš„æ˜¯ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•æ¥å®ç°å¯é…ç½®ç²—ç»†çš„çº¿æ¡ã€‚æŒ‰ç…§<a class="ae na" href="https://threejs.org/examples/?q=fat#webgl_lines_fat" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªä¾‹å­</a>æ¼”ç¤ºçš„æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶çº¿æ¡çš„ç²—ç»†ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬è¦å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å°†éœ€è¦æ³¨å…¥äº†é«˜åº¦å›¾æ•°æ®çš„å¹³é¢å‡ ä½•çš„é¡¶ç‚¹ä½ç½®ã€‚</p><p id="3519" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦æ‰‹åŠ¨è®¡ç®—æ¯ä¸ªé¡¶ç‚¹çš„zå€¼ï¼Œè€Œä¸æ˜¯ç®€å•åœ°å°†<code class="fe nn no np nq b">heightmap</code>åˆ†é…ç»™æè´¨çš„<code class="fe nn no np nq b">displacementMap</code>å±æ€§(å¦‚ç¬¬2èŠ‚æ‰€è¿°)ã€‚</p><p id="afac" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åœ¨<code class="fe nn no np nq b">index.js</code>ä¸­è¿›è¡Œä»¥ä¸‹æ›´æ”¹:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="1c85" class="or lo iq nq b be os ot l ow ov">import Stats from "three/examples/jsm/libs/stats.module"<br/>import { OrbitControls } from "three/examples/jsm/controls/OrbitControls"<br/>+ import { LineGeometry } from "three/examples/jsm/lines/LineGeometry"<br/>+ import { LineMaterial } from "three/examples/jsm/lines/LineMaterial"<br/>+ import { Line2 } from "three/examples/jsm/lines/Line2"<br/><br/>...<br/><br/>const params = {<br/>  // general scene params<br/>  dirLightColor1: 0x2dd7ff,<br/>  dirLightColor2: 0x2dd7ff,<br/>  // plane params<br/>  metalness: 0.2,<br/>  roughness: 0.7,<br/>  meshColor: 0xffffff,<br/>  meshEmissive: 0x000098,<br/>+ lineWidth: 0.04,<br/>+ lineColor: 0xcee4ff,<br/>}<br/><br/>...<br/><br/>- let renderer = createRenderer({ antialias: true }, (_renderer) =&gt; {<br/>+ let renderer = createRenderer({ antialias: true, logarithmicDepthBuffer: true }, (_renderer) =&gt; {<br/><br/>...<br/><br/>let app = {<br/>  async initScene() {<br/>    ...<br/><br/>+   // the grid lines, reference: https://threejs.org/examples/?q=line#webgl_lines_fat<br/>+   let lineGeometry = new LineGeometry()<br/>+   let linePositions = []<br/>+   // This is a specific way to map line points to cooresponding vertices of the planeGeometry<br/>+   for (let row = 0; row &lt; terrainHeight; row++) {<br/>+     let isEvenRow = row % 2 == 0<br/>+     for (let col = (isEvenRow ? 0 : (terrainWidth - 1)); isEvenRow ? (col &lt; terrainWidth) : (col &gt;= 0); isEvenRow ? col++ : col--) {<br/>+       for (let point = (isEvenRow ? 0 : 3); isEvenRow ? (point &lt; 4) : (point &gt;= 0); isEvenRow ? point++ : point--) {<br/>+         let mappedIndex<br/>+         let rowOffset = row * (terrainWidth + 1)<br/>+         if (point &lt; 2) {<br/>+           mappedIndex = rowOffset + col + point<br/>+         } else {<br/>+           mappedIndex = rowOffset + col + point + terrainWidth - 1<br/>+         }<br/><br/>+         linePositions.push(geometryPositions[mappedIndex * 3])<br/>+         linePositions.push(geometryPositions[mappedIndex * 3 + 1])<br/>+         linePositions.push(geometryPositions[mappedIndex * 3 + 2])<br/>+       }<br/>+     }<br/>+   }<br/>+   lineGeometry.setPositions(linePositions)<br/><br/>+   // the material for the grid lines<br/>+   let lineMaterial = new LineMaterial({<br/>+     color: params.lineColor,<br/>+     linewidth: params.lineWidth, // in world units with size attenuation, pixels otherwise<br/>+     alphaToCoverage: false,<br/>+     worldUnits: true // such that line width depends on world distance<br/>+   })<br/><br/>    // create plane mesh and add to scene<br/>    let mesh = new THREE.Mesh(planeGeometry, meshMaterial)<br/>    mesh.position.set(0, -1.5, 0)<br/>    mesh.rotation.x -= Math.PI / 2<br/>    scene.add(mesh)<br/><br/>+   // create the lines mesh and add to scene<br/>+   let line = new Line2(lineGeometry, lineMaterial)<br/>+   line.computeLineDistances()<br/>+   line.position.set(0, -1.5, 0)<br/>+   line.rotation.x -= Math.PI / 2<br/>+   scene.add(line)<br/><br/>    // GUI controls<br/>    const gui = new dat.GUI()</span></pre><p id="2984" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æ³¨æ„ï¼Œæˆ‘ä»¬æ‰“å¼€äº†æ¸²æŸ“å™¨çš„<code class="fe nn no np nq b">logarithmicDepthBuffer</code>ã€‚æ­¤é…ç½®ä¿®å¤äº†ç½‘æ ¼çº¿å’Œå¹³é¢å‡ ä½•ä½“ä¹‹é—´çš„zæˆ˜æ–—é—®é¢˜ã€‚åœ¨<a class="ae na" href="https://threejs.org/manual/#en/cameras" rel="noopener ugc nofollow" target="_blank">https://threejs.org/manual/#en/cameras</a>çš„ä¸‹åŠéƒ¨åˆ†é˜…è¯»æ›´å¤šå…³äºè¿™ä¸ªé—®é¢˜çš„å†…å®¹ã€‚</p><p id="3594" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œ<code class="fe nn no np nq b">LineGeometry</code>ã€<code class="fe nn no np nq b">LineMaterial</code>å’Œ<code class="fe nn no np nq b">Line2</code>ç±»ä¸æ˜¯æ¥è‡ªæ ¸å¿ƒçš„Three.jsåº“ã€‚å®ƒä»¬æ˜¯ä»<code class="fe nn no np nq b">jsm</code>æ–‡ä»¶å¤¹å¯¼å…¥çš„ã€‚</p><p id="ebea" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nn no np nq b">LineGeometry</code>çš„å·¥ä½œæ–¹å¼æ˜¯å®ƒéœ€è¦ä¸€ä¸ªé¡¶ç‚¹ä½ç½®çš„é¡ºåºæ•°ç»„ï¼Œç„¶åå®ƒä¼šç”»ä¸€æ¡çº¿ï¼Œä»¥ç›¸åŒçš„é¡ºåºè¿æ¥ä½ç½®æ•°ç»„ä¸­æŒ‡å®šçš„ç‚¹ã€‚æ‰€ä»¥åŸºæœ¬ä¸Šåªç”»äº†ä¸€æ¡çº¿ï¼Œä»å¤´åˆ°å°¾ã€‚</p><p id="b8d1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä¸‰é‡åµŒå¥—çš„forå¾ªç¯ä»£ç å—æ‰€åšçš„æ˜¯æ­£ç¡®è®¾ç½®é¡¶ç‚¹çš„é¡ºåºæ•°ç»„ã€‚æˆ‘ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è§£é‡Šã€‚</p><p id="7864" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æ¯”æ–¹è¯´å¦‚æœæˆ‘ä»¬æ ¹æœ¬ä¸è®¡ç®—<code class="fe nn no np nq b">linePositions</code>ç›´æ¥ç”¨å¹³é¢å‡ ä½•çš„<code class="fe nn no np nq b">geometryPositions</code>:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="b62f" class="or lo iq nq b be os ot l ow ov">lineGeometry.setPositions(geometryPositions)</span></pre><p id="ccbe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä½ çœ‹åˆ°çš„ä¼šæ˜¯æ··ä¹±çš„:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/8109c55e66ad3c851cd47f068d164dbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LErCZt-42V_GclZSR_1wSw.png"/></div></div></figure><p id="a99d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åŸå› æ˜¯é¡¶ç‚¹ä½ç½®çš„é»˜è®¤é¡ºåºæ˜¯ä»å·¦åˆ°å³é€è¡Œæ’åˆ—çš„ã€‚æŸ¥çœ‹å¸¦æœ‰æ•°å­—è¾…åŠ©å¯¹è±¡çš„å¹³é¢å‡ ä½•ä½“ï¼Œè¿™äº›è¾…åŠ©å¯¹è±¡æ ‡è®°äº†ä¸‹é¢çš„æ¯ä¸ªé¡¶ç‚¹:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/31b3c94a3b209f80456c07a7ad8496ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZyjtxIdb-REHKNVWWtmxQ.png"/></div></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">ä½äº<a class="ae na" href="https://hofk.de/main/discourse.threejs/2022/THREEn/NumberingHelperExamples.html" rel="noopener ugc nofollow" target="_blank">https://hofk . de/main/discourse . three js/2022/three n/numberinghelperexamples . html</a>çš„ç¤ºä¾‹æˆªå›¾</p></figure><p id="c669" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å› æ­¤ï¼Œæ­£åœ¨ç»˜åˆ¶çš„çº¿åªæ˜¯éµå¾ªé¡¶ç‚¹é¡ºåºï¼Œç»“æœæ˜¯è¿™æ ·çš„(è“çº¿):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/e9f4ce483366345216fb01522e1fea64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7yfYYH2FrYhvzZ7cc_9cTA.png"/></div></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">æ¯ä¸€è¡Œéƒ½æ˜¯ä»æœ€å³è¾¹åˆ°æœ€å·¦è¾¹ï¼Œéš¾æ€ªæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ç‰‡æ··ä¹±</p></figure><p id="89e6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä¸ºäº†é˜²æ­¢è¡Œä»å³è¾¹ç¼˜è·³åˆ°å·¦è¾¹ç¼˜ï¼Œæˆ‘ä»¬å¿…é¡»ä»¥ç‰¹å®šçš„æ–¹å¼æ’åˆ—è¡Œçš„ä½ç½®ã€‚</p><p id="eeed" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¯¹äºç¬¬ä¸€è¡Œï¼Œæˆ‘ä»¬åº”è¯¥æŒ‰ç…§é¡¶ç‚¹é¡ºåºç»˜åˆ¶ç›´çº¿:</p><p id="5bc6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">v0 â€” v1 â€” v5 â€” v6ï¼Œæ¥ç€æ˜¯v1 â€” v2 â€” v6 â€” v7ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><p id="1529" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç„¶è€Œï¼Œå¯¹äºç¬¬äºŒè¡Œï¼Œæˆ‘ä»¬å¿…é¡»ä»å³ä¾§å¼€å§‹ï¼Œè€Œä¸æ˜¯ä»å·¦ä¾§å¼€å§‹ï¼Œå› ä¸ºå¦åˆ™ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°åŒæ ·çš„é—®é¢˜ï¼Œå³ç›´çº¿ä»å³è¾¹ç¼˜è·³åˆ°å·¦è¾¹ç¼˜ã€‚æ‰€ä»¥åŸºæœ¬ä¸Šï¼Œå¯¹äºå¶æ•°è¡Œï¼Œæˆ‘ä»¬å¿…é¡»æŒ‰ç…§å¥‡æ•°è¡Œçš„ç›¸åé¡ºåºæ’åˆ—é¡¶ç‚¹ã€‚</p><p id="4618" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å› æ­¤ï¼Œå¯¹äºç¬¬äºŒè¡Œï¼Œæˆ‘ä»¬åº”è¯¥éµå¾ªä»¥ä¸‹é¡¶ç‚¹é¡ºåº:</p><p id="3c74" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">v14 â€” v13 â€” v9 â€” v8ï¼Œæ¥ç€æ˜¯v13 â€” v12 â€” v8 â€” v7ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><p id="f17d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">é€šè¿‡å®æ–½è¿™ç§ç‰¹æ®Šçš„æ’åºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„åœ°å½¢ä¸Šè·å¾—ä¸€ä¸ªå®Œç¾çš„çº¿ç½‘æ ¼:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/ade7fb9cf055f944ed1f57533234d789.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N2S-QoygFgqaRebPYCChVg.png"/></div></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">èµ°è¿‘æˆ‘ä»¬çš„æœ€ç»ˆäº§å“ï¼</p></figure><h1 id="fb8d" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">7.åˆ›é€ ä¸€ä¸ªæ²¡æœ‰å°½å¤´çš„åœ°å½¢çš„å¹»è§‰</h1><p id="f3dd" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">è¿™ä¸ªé¡¹ç›®ä»¤äººå…´å¥‹çš„éƒ¨åˆ†æ¥äº†:ä¼ªé€ ä¸€ä¸ªæ°¸æ— æ­¢å¢ƒçš„åœ°å½¢ï¼</p><p id="31a4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¦‚æœæ‚¨è·³è¿‡äº†ä¸Šé¢ç¬¬2éƒ¨åˆ†çš„è§£é‡Šï¼Œæˆ‘å°†å¿«é€Ÿå›é¡¾ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µ:</p><ol class=""><li id="1385" class="mf mg iq kt b ku kv kx ky la nw le nx li ny lm mm mn mo mp bi translated">åˆ¶ä½œå‡ ç»„åœ°å½¢å›¾</li><li id="f054" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">åƒç«è½¦ä¸€æ ·æŠŠä»–ä»¬è¿æ¥èµ·æ¥</li><li id="5450" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">è®©ç«è½¦æœç€æ‘„åƒæœºç§»åŠ¨</li><li id="3a21" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">å¼¹å‡ºç«è½¦å¤´éƒ¨ï¼Œå¦‚æœå®ƒåœ¨æ‘„åƒæœºåé¢ï¼Œå°±æŠŠå®ƒæ”¾å›å°¾éƒ¨ã€‚</li><li id="141a" class="mf mg iq kt b ku mq kx mr la ms le mt li mu lm mm mn mo mp bi translated">ç§å•Šã€‚è¿™å°±æ˜¯ä½ å¦‚ä½•ä¼ªé€ ä¸€ä¸ªæ— å°½çš„åœ°å½¢ã€‚</li></ol><p id="3256" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åœ¨æˆ‘çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°ä¸ºæ‰€æœ‰è¿ç»­çš„åœ°å½¢å…‹éš†åªé‡å¤ä¸€ä¸ªé«˜åº¦å›¾åœ¨è§†è§‰ä¸Šå¤ªé‡å¤äº†ï¼Œæ‰€ä»¥æˆ‘åšäº†ä¸€ä¸ªå¿«é€Ÿä¿®å¤ï¼Œä½¿åœ°å½¢çœ‹èµ·æ¥ä¸é‚£ä¹ˆé‡å¤ï¼›é€šè¿‡æ°´å¹³ç¿»è½¬é«˜åº¦å›¾æ¥â€œåˆ›å»ºâ€ç¬¬äºŒä¸ªé«˜åº¦å›¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºâ€œå¥‡æ•°â€åœ°å½¢ä½¿ç”¨é«˜åº¦å›¾ï¼Œè€Œå¯¹äºâ€œå¶æ•°â€åœ°å½¢åè½¬é«˜åº¦å›¾ã€‚</p><p id="c0ad" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è®©æˆ‘ä»¬åœ¨<code class="fe nn no np nq b">index.js</code>ä¸­è¿›è¡Œä»¥ä¸‹ä»£ç æ›´æ”¹:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="e9c1" class="or lo iq nq b be os ot l ow ov">/**************************************************<br/> * 0. Tweakable parameters for the scene<br/> *************************************************/<br/>const params = {<br/>  // general scene params<br/>+ speed: 2.5,<br/><br/>...<br/><br/>const lightIntensity2 = 0.85<br/>+ // need to be even number since the consecutive terrains are stitched in pairs<br/>+ const numOfMeshSets = 6<br/><br/>...<br/><br/>let app = {<br/>  async initScene() {<br/>    ...<br/>    scene.add(this.dirLight2)<br/><br/>+   // create sets of objects, for the capability to use different heightmaps for each set of plane and lines<br/>+   let planeGeometries = []<br/>+   let lineGeometries = []<br/>+   let geometryPositionsArray = []<br/><br/>+   // we only loop twice here, although we load a single HeightMap, the trick is:<br/>+   // first loop we load the HeightMap the normal way<br/>+   // second loop we load the HeightMap data horizontally inversed<br/>+   for (let i = 0; i &lt; 2; i++) {<br/>      // load heightmap to a new image first, then read its color data to set the heights of our plane vertices<br/>      // see: https://gist.github.com/jawdatls/465d82f2158e1c4ce161<br/>      let hm_image = await loadImage(HeightMap)<br/>      var canvas = document.createElement("canvas")<br/>      canvas.width = hm_image.width<br/>      canvas.height = hm_image.height<br/>      var context = canvas.getContext("2d")<br/>      context.drawImage(hm_image, 0, 0)<br/>      var hm_imageData = context.getImageData(0, 0, canvas.width, canvas.height)<br/><br/>      // Create a PlaneGeom<br/>      let planeGeometry = new THREE.PlaneGeometry(terrainWidth, terrainHeight, terrainWidth, terrainHeight)<br/>      let geometryPositions = planeGeometry.getAttribute("position").array<br/>      let geometryUVs = planeGeometry.getAttribute("uv").array<br/><br/>      // update each vertex position's z value according to the value we extracted from the heightmap image<br/>      for (let index = 0; index &lt; geometryUVs.length / 2; index++) {<br/>        let vertexU = geometryUVs[index * 2]<br/>        let vertexV = geometryUVs[index * 2 + 1]<br/>-       // Update the z positions according to height map,<br/>-       let terrainHeight = getZFromImageDataPoint(hm_imageData, vertexU, vertexV, canvas.width, canvas.height)<br/>+       // Update the z positions according to height map, inverse heightmap horizontally for the second loop<br/>+       let terrainHeight = getZFromImageDataPoint(hm_imageData, (i == 0 ? vertexU : 1 - vertexU), vertexV, canvas.width, canvas.height)<br/>        geometryPositions[index * 3 + 2] = terrainHeight<br/>      }<br/>      // skew the plane geometry<br/>      const shearMtx = new THREE.Matrix4()<br/>      shearMtx.makeShear(-0.5, 0, 0, 0, 0, 0)<br/>      planeGeometry.applyMatrix4(shearMtx)<br/><br/>+     planeGeometries.push(planeGeometry)<br/>+     geometryPositionsArray.push(geometryPositions)<br/>+   }<br/><br/>+   // zip up the gaps between the 1st and 2nd plane geometries<br/>+   for (let index = 0; index &lt;= terrainWidth; index++) {<br/>+     let bottomOffset = (terrainWidth + 1) * terrainHeight<br/>+     // 2nd geom's bottom row height should be synced with 1st geom's top<br/>+     geometryPositionsArray[1][(bottomOffset + index) * 3 + 2] = geometryPositionsArray[0][index * 3 + 2]<br/>+     // 1st geom's bottom row height should be synced with 2nd geom's top<br/>+     geometryPositionsArray[0][(bottomOffset + index) * 3 + 2] = geometryPositionsArray[1][index * 3 + 2]<br/>+   }<br/><br/>    // material for the plane geometry<br/>    let meshMaterial = new THREE.MeshStandardMaterial({<br/>      color: new THREE.Color(params.meshColor),<br/>      emissive: new THREE.Color(params.meshEmissive),<br/>      metalness: params.metalness,<br/>      roughness: params.roughness,<br/>      flatShading: true<br/>    })<br/><br/>    // the grid lines, reference: https://threejs.org/examples/?q=line#webgl_lines_fat<br/>+   for (let i = 0; i &lt; 2; i++) {<br/>      let lineGeometry = new LineGeometry()<br/>      let linePositions = []<br/>      // This is a specific way to map line points to corresponding vertices of the planeGeometry<br/>      for (let row = 0; row &lt; terrainHeight; row++) {<br/>        let isEvenRow = row % 2 == 0<br/>        for (let col = (isEvenRow ? 0 : (terrainWidth - 1)); isEvenRow ? (col &lt; terrainWidth) : (col &gt;= 0); isEvenRow ? col++ : col--) {<br/>          for (let point = (isEvenRow ? 0 : 3); isEvenRow ? (point &lt; 4) : (point &gt;= 0); isEvenRow ? point++ : point--) {<br/>            let mappedIndex<br/>            let rowOffset = row * (terrainWidth + 1)<br/>            if (point &lt; 2) {<br/>              mappedIndex = rowOffset + col + point<br/>            } else {<br/>              mappedIndex = rowOffset + col + point + terrainWidth - 1<br/>            }<br/><br/>-           linePositions.push(geometryPositions[mappedIndex * 3])<br/>-           linePositions.push(geometryPositions[mappedIndex * 3 + 1])<br/>-           linePositions.push(geometryPositions[mappedIndex * 3 + 2])<br/>+           linePositions.push(geometryPositionsArray[i][mappedIndex * 3])<br/>+           linePositions.push(geometryPositionsArray[i][mappedIndex * 3 + 1])<br/>+           linePositions.push(geometryPositionsArray[i][mappedIndex * 3 + 2])<br/>          }<br/>        }<br/>      }<br/>      lineGeometry.setPositions(linePositions)<br/><br/>+     lineGeometries.push(lineGeometry)<br/>+   }<br/><br/>-   // create plane mesh and add to scene<br/>-   let mesh = new THREE.Mesh(planeGeometry, meshMaterial)<br/>-   mesh.position.set(0, -1.5, 0)<br/>-   mesh.rotation.x -= Math.PI / 2<br/>-   scene.add(mesh)<br/>-   // create the lines mesh and add to scene<br/>-   let line = new Line2(lineGeometry, lineMaterial)<br/>-   line.computeLineDistances()<br/>-   line.position.set(0, -1.5, 0)<br/>-   line.rotation.x -= Math.PI / 2<br/>-   scene.add(line)<br/><br/>+   this.meshGroup = []<br/>+   this.lineGroup = []<br/>+   // create multiple sets of plane and line meshes determined by numOfMeshSets<br/>+   for (let i = 0; i &lt; numOfMeshSets; i++) {<br/>+     // create the meshes<br/>+     let mesh = new THREE.Mesh(planeGeometries[i % 2], meshMaterial)<br/>+     let line = new Line2(lineGeometries[i % 2], lineMaterial)<br/>+     line.computeLineDistances()<br/>+     // set the correct pos and rot for both the terrain and its wireframe<br/>+     mesh.position.set(0, -1.5, -terrainHeight * i)<br/>+     mesh.rotation.x -= Math.PI / 2<br/>+     line.position.set(0, -1.5, -terrainHeight * i)<br/>+     line.rotation.x -= Math.PI / 2<br/>+     // add the meshes to the scene<br/>+     scene.add(mesh)<br/>+     scene.add(line)<br/>+     this.meshGroup.push(mesh)<br/>+     this.lineGroup.push(line)<br/>+   }<br/><br/>...<br/><br/>  // @param {number} interval - time elapsed between 2 frames<br/>  // @param {number} elapsed - total time elapsed since app start<br/>  updateScene(interval, elapsed) {<br/>    this.controls.update()<br/>    this.stats1.update()<br/><br/>+   for (let i = 0; i &lt; numOfMeshSets; i++) {<br/>+     this.meshGroup[i].position.z += interval * params.speed<br/>+     this.lineGroup[i].position.z += interval * params.speed<br/>+     if (this.meshGroup[i].position.z &gt;= terrainHeight) {<br/>+       this.meshGroup[i].position.z -= numOfMeshSets * terrainHeight<br/>+       this.lineGroup[i].position.z -= numOfMeshSets * terrainHeight<br/>+     }<br/>+   }<br/>  }</span></pre><p id="a074" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ–°çš„<code class="fe nn no np nq b">speed</code>å‚æ•°æ¥æ§åˆ¶åœ°å½¢ç§»åŠ¨çš„é€Ÿåº¦ã€‚æˆ‘ä»¬è¿˜å®šä¹‰äº†ä¸€ä¸ªæ–°çš„<code class="fe nn no np nq b">numOfMeshSets</code>å˜é‡æ¥æ§åˆ¶æˆ‘ä»¬æƒ³è¦åˆ›å»ºå¤šå°‘åœ°å½¢å‰¯æœ¬ã€‚</p><p id="1991" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å®šä¹‰å˜é‡<code class="fe nn no np nq b">planeGeometries</code>ã€<code class="fe nn no np nq b">lineGeometries</code>å’Œ<code class="fe nn no np nq b">geometryPositionsArray</code>æ¥å­˜å‚¨ä¸¤ç»„å‡ ä½•å›¾å½¢ï¼Œæ¯ç»„éƒ½æ˜¯ç”±äºä½¿ç”¨çš„<code class="fe nn no np nq b">heightmaps</code>ä¸åŒè€Œäº§ç”Ÿçš„ã€‚</p><p id="751d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç„¶åï¼Œæˆ‘ä»¬å°†å¹³é¢å’Œçº¿å‡ ä½•è®¾ç½®ä»£ç åŒ…è£…åœ¨ä¸€ä¸ª2åœˆçš„forå¾ªç¯ä¸­ã€‚åœ¨å¹³é¢å‡ ä½•è®¾ç½®çš„ç¬¬äºŒä¸ªå¾ªç¯ä¸­ï¼Œæˆ‘ä»¬å°†<code class="fe nn no np nq b">1 â€” vertexU</code>ä¼ é€’ç»™<code class="fe nn no np nq b">u</code>å‚æ•°æ¥å®ç°æ°´å¹³åè½¬é«˜åº¦å›¾çš„æ•ˆæœã€‚</p><p id="76d4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åœ¨<code class="fe nn no np nq b">runApp()</code>ä¸­è®¾ç½®çš„åŠ¨ç”»å¾ªç¯æ¯ä¸€å¸§éƒ½ä¼šè°ƒç”¨<code class="fe nn no np nq b">updateScene()</code>åŠŸèƒ½ã€‚è¿™é‡Œæ·»åŠ çš„ä»£ç æ˜¯æ— ä¼‘æ­¢åœ°æ¿€æ´»åœ°å½¢çš„ä¸œè¥¿ã€‚ç›¸æœºè®¾ç½®ä¹Ÿæ˜¯ä¸€ä¸ªå› ç´ ã€‚ç”±äºå…¶<code class="fe nn no np nq b">far</code>å€¼è®¾ç½®ä¸º120ï¼Œè€Œâ€œåœ°å½¢åˆ—è½¦â€çš„å¯è§é•¿åº¦çº¦ä¸º150è‡³180ï¼Œæˆ‘ä»¬å°†æ°¸è¿œä¸ä¼šçœ‹åˆ°å¼¹å‡ºçš„åœ°å½¢æŠ–åŠ¨è¢«æ·»åŠ å›åˆ—è½¦å°¾éƒ¨ã€‚</p><p id="04cf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å˜åŒ–ä¹‹åï¼Œä½ ä¼šçœ‹åˆ°åœ°å½¢ä¸æ–­å‘ä½ ç§»åŠ¨ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/ac9c91a9066266f7e300114ebf69c563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FnJhhcMh-HQx0oyjJF97EA.png"/></div></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">åœ¨æ°¸æ— æ­¢å¢ƒçš„åœ°å½¢ä¸­å‰è¿›çš„é”™è§‰</p></figure><h1 id="376e" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">8.æ·»åŠ è½æ—¥â˜€å¹¶åˆ¶ä½œåŠ¨ç”»</h1><p id="7b61" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">è¿™ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰è¶£çš„éƒ¨åˆ†ï¼Œä½†æ¶‰åŠåˆ°è¿™ä¸ªé¡¹ç›®ä¸­æœ€å¤æ‚çš„æ•°å­¦ã€‚æˆ‘èŠ±äº†ä¸€äº›æ—¶é—´æ¥æ‰¾å‡ºæ­£ç¡®çš„å…¬å¼æ¥åˆ¶ä½œå¤ªé˜³ä¸Šè¿™äº›æ¡çº¹çš„åŠ¨ç”»ã€‚æˆ‘ä½¿ç”¨è‡ªå®šä¹‰ç€è‰²å™¨ï¼Œä»¥åŠ¨ç”»å¤ªé˜³çš„é¢œè‰²ã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰è¿™ä¸ªä¸»é¢˜ï¼Œè¯·é˜…è¯»å…³äº<a class="ae na" href="https://thebookofshaders.com/" rel="noopener ugc nofollow" target="_blank">https://thebookofshaders.com/</a>çš„ç€è‰²å™¨ã€‚</p><p id="3760" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å°†ä»¥ä¸‹ä»£ç é™„åŠ åˆ°<code class="fe nn no np nq b">functions.js</code>:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="933e" class="or lo iq nq b be os ot l ow ov">// vertexShader for the Sun<br/>export function vertexShader() {<br/>  return `<br/>      varying vec2 vUv;<br/>      varying vec3 vPos;<br/>      void main() {<br/>        vUv = uv;<br/>        vPos = position;<br/>        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0); <br/>      }<br/>  `<br/>}<br/><br/>// fragmentShader for the Sun<br/>export function fragmentShader() {<br/>  return `<br/>      #ifdef GL_ES<br/>      precision mediump float;<br/>      #endif<br/>      #define PI 3.14159265359<br/>      #define TWO_PI 6.28318530718<br/>      <br/>      uniform vec2 u_resolution;<br/>      uniform vec2 u_mouse;<br/>      uniform float u_time;<br/>      uniform vec3 color_main;<br/>      uniform vec3 color_accent;<br/>      varying vec2 vUv;<br/>      varying vec3 vPos;<br/>      void main() {<br/>        vec2 st = gl_FragCoord.xy/u_resolution.xy;<br/>        float x = vPos.y;<br/>        float osc = ceil(sin((3. - (x - u_time) / 1.5) * 5.) / 2. + 0.4 - floor((3. - x / 1.5) * 5. / TWO_PI) / 10.);<br/>        vec3 color = mix(color_accent, color_main, smoothstep(0.2, 1., vUv.y));<br/>        gl_FragColor = vec4(color, osc);<br/>      }<br/>  `<br/>}</span></pre><p id="e312" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘å¾ˆä¹æ„èŠ±æ›´å¤šçš„æ—¶é—´æ¥è§£é‡Š<code class="fe nn no np nq b">fragmentShader</code>ä¸­çš„ä»£ç ï¼Œä½†æ˜¯æˆ‘æ‹…å¿ƒè¿™ç¯‡æ–‡ç« ä¼šå˜å¾—å¤ªé•¿ã€‚</p><p id="8ee8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æ¥ä¸‹æ¥ï¼Œå¯¹<code class="fe nn no np nq b">index.js</code>è¿›è¡Œå¦‚ä¸‹æ›´æ”¹:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="1749" class="or lo iq nq b be os ot l ow ov">- import { createCamera, createComposer, createRenderer, runApp } from "./core-utils"<br/>+ import { createCamera, createComposer, createRenderer, runApp, getDefaultUniforms } from "./core-utils"<br/><br/>- import { loadImage} from "./common-utils"<br/>- import { loadSceneBackground, getZFromImageDataPoint } from "./functions"<br/>+ import { loadImage, hexToRgb } from "./common-utils"<br/>+ import { loadSceneBackground, getZFromImageDataPoint, vertexShader, fragmentShader } from "./functions"<br/><br/>...<br/><br/>/**************************************************<br/> * 0. Tweakable parameters for the scene<br/> *************************************************/<br/>const params = {<br/>  // general scene params<br/>  ...<br/>+ // sun params<br/>+ topColor: 0xffab00,<br/>+ bottomColor: 0xff51c8<br/>}<br/>...<br/>const lightIntensity2 = 0.85<br/>// need to be even number since the consecutive terrains are stitched in pairs<br/>const numOfMeshSets = 6<br/>+ const sunPos = {<br/>+   x: 0,<br/>+   y: 16,<br/>+   z: -100<br/>+ }<br/>+ const uniforms = {<br/>+   ...getDefaultUniforms(),<br/>+   color_main: { // sun's top color<br/>+     value: hexToRgb("#ffab00", true)<br/>+   },<br/>+   color_accent: { // sun's bottom color<br/>+     value: hexToRgb("#ff51c8", true)<br/>+   }<br/>+ }<br/><br/>...<br/><br/>let app = {<br/>  async initScene() {<br/>    ...<br/><br/>+   // the sun<br/>+   const sunGeom = new THREE.SphereGeometry(30, 64, 64)<br/>+   const sunMat = new THREE.ShaderMaterial({<br/>+     uniforms: uniforms,<br/>+     vertexShader: vertexShader(),<br/>+     fragmentShader: fragmentShader(),<br/>+     transparent: true<br/>+   })<br/>+   let sun = new THREE.Mesh(sunGeom, sunMat)<br/>+   sun.position.set(sunPos.x, sunPos.y, sunPos.z)<br/>+   scene.add(sun)<br/><br/>    // GUI controls<br/>    const gui = new dat.GUI()</span></pre><p id="f9bc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nn no np nq b">uniforms</code>å˜é‡åŒ…å«è¦ä¼ é€’ç»™ç€è‰²å™¨ç¨‹åºçš„å‚æ•°ã€‚<code class="fe nn no np nq b">fragmentShader()</code>ä¸­çš„åŠ¨ç”»ä»£ç ä¹Ÿåˆ©ç”¨äº†<code class="fe nn no np nq b">getDefaultUniforms.</code>å®šä¹‰çš„<code class="fe nn no np nq b">u_time</code><code class="fe nn no np nq b">u_time</code>ç”±<code class="fe nn no np nq b">runApp</code>ä¸­çš„åŠ¨ç”»å¾ªç¯æ›´æ–°ã€‚å¯¹äºä»»ä½•åŠ¨ç”»ä»£ç æ¥è¯´ï¼Œæ—¶é—´éƒ½æ˜¯å¿…ä¸å¯å°‘çš„å…ƒç´ ã€‚</p><p id="7c15" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åº”ç”¨ä»£ç æ›´æ”¹ä¼šç»™ä½ ä¸€ä¸ªåŠ¨ç”»å¤ªé˜³:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/bc7f6c859e29893b8713c3f6695d7d9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9HHsTYiCFvvx4rjEgxLp9Q.png"/></div></div></figure><h1 id="ce44" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">9.æ·»åŠ GUIæ§ä»¶ä»¥åœ¨è¿è¡Œæ—¶è°ƒæ•´å‚æ•°</h1><p id="84d4" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">GUIæ§ä»¶æœ‰åŠ©äºå¼€å‘äººå‘˜åœ¨è¿è¡Œæ—¶å¿«é€Ÿæµ‹è¯•å„ç§å‚æ•°å€¼ã€‚é€šå¸¸ï¼ŒGUIæ§ä»¶æ˜¯åœ¨å¼€å‘çš„æ—©æœŸé˜¶æ®µæ·»åŠ çš„ï¼Œä½†æ˜¯ä¸ºäº†æœ¬æ–‡çš„æµç¨‹ï¼Œæˆ‘å®æ„¿å…ˆè§£é‡Šæ‰€æœ‰é‡è¦çš„ä»£ç ã€‚</p><p id="40f5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åœ¨<code class="fe nn no np nq b">index.js</code>ä¸­è¿›è¡Œä»¥ä¸‹æ›´æ”¹:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="b145" class="or lo iq nq b be os ot l ow ov">  async initScene() {<br/>    ...<br/><br/>    // GUI<br/>    const gui = new dat.GUI()<br/><br/>+   gui.add(guiOptions, "speed", 1, 10, 0.5).name('Plane speed')<br/>+   gui.addColor(guiOptions, 'dirLightColor1').name('Dir light 1').onChange((val) =&gt; {<br/>+     this.dirLight1.color.set(val)<br/>+   })<br/>+   gui.addColor(guiOptions, 'dirLightColor2').name('Dir light 2').onChange((val) =&gt; {<br/>+     this.dirLight2.color.set(val)<br/>+   })<br/><br/>+   let planeFolder = gui.addFolder(`Plane`)<br/>+   planeFolder.add(guiOptions, "metalness", 0, 1, 0.05).onChange((val) =&gt; {<br/>+     meshMaterial.metalness = val<br/>+   })<br/>+   planeFolder.add(guiOptions, "roughness", 0, 1, 0.05).onChange((val) =&gt; {<br/>+     meshMaterial.roughness = val<br/>+   })<br/>+   planeFolder.addColor(guiOptions, 'meshColor').name('color').onChange((val) =&gt; {<br/>+     meshMaterial.color.set(val)<br/>+   })<br/>+   planeFolder.addColor(guiOptions, 'meshEmissive').name('emissive').onChange((val) =&gt; {<br/>+     meshMaterial.emissive.set(val)<br/>+   })<br/>+   planeFolder.addColor(guiOptions, 'lineColor').name('line color').onChange((val) =&gt; {<br/>+     lineMaterial.color.set(val)<br/>+   })<br/>+   planeFolder.add(guiOptions, "lineWidth", 0, 0.1, 0.01).name('line width').onChange((val) =&gt; {<br/>+     lineMaterial.linewidth = val<br/>+   })<br/><br/>+   let sunFolder = gui.addFolder(`Sun`)<br/>+   sunFolder.addColor(guiOptions, 'topColor').name('top color').onChange((val) =&gt; {<br/>+     let clr = new THREE.Color(val)<br/>+     uniforms.color_main.value = hexToRgb(clr.getHexString(), true)<br/>+   })<br/>+   sunFolder.addColor(guiOptions, 'bottomColor').name('bottom color').onChange((val) =&gt; {<br/>+     let clr = new THREE.Color(val)<br/>+     uniforms.color_accent.value = hexToRgb(clr.getHexString(), true)<br/>+   })<br/><br/>    // Stats - show fps<br/>    this.stats1 = new Stats()<br/>    this.stats1.showPanel(0) // Panel 0 = fps<br/>    this.stats1.domElement.style.cssText = "position:absolute;top:0px;left:0px;"<br/>    this.container.appendChild(this.stats1.domElement)<br/>  },</span></pre><p id="d42e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ç°åœ¨ä½ å¯ä»¥ä»»æ„è°ƒæ•´å‚æ•°å’Œé¢œè‰²äº†ï¼</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/a905f23ff76152812edb7f7016331001.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vQqczRBZrsfvqfsMlXHWkQ.png"/></div></div></figure><h1 id="e674" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">10.ç”¨å¸ƒé²å§†æ•ˆæœâœ¨âœ¨å¯¹åœºæ™¯è¿›è¡ŒåæœŸå¤„ç†ï¼Œè®©å®ƒçœ‹èµ·æ¥æ›´é…·ï¼</h1><p id="100a" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">ä¸‹é¢æ˜¯æœ¬æ–‡çš„æœ€åä¸€éƒ¨åˆ†ã€‚æˆ‘ä»¬å°†æ·»åŠ Bloomæ•ˆæœæ¥ç…§äº®åœºæ™¯ï¼è¿™æœ€åçš„æ¶¦è‰²å¯¹äºè®©åœºæ™¯çœ‹èµ·æ¥å¾ˆé…·å’Œæ•£å‘å‡ºä¸€ç§åˆæˆæ³¢çš„æ°›å›´æ˜¯å¾ˆé‡è¦çš„ï¼</p><p id="1d0b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¯¹<code class="fe nn no np nq b">index.js</code>è¿›è¡Œä»¥ä¸‹æ›´æ”¹:</p><pre class="kg kh ki kj gt on nq oo bn op oq bi"><span id="70c7" class="or lo iq nq b be os ot l ow ov">+ import { UnrealBloomPass } from "three/examples/jsm/postprocessing/UnrealBloomPass"<br/><br/>...<br/><br/>const params = {<br/>  // general scene params<br/>  speed: 2.5,<br/>  dirLightColor1: 0x2dd7ff,<br/>  dirLightColor2: 0x2dd7ff,<br/>+ // bloom params<br/>+ bloomStrength: 0.5,<br/>+ bloomRadius: 0.2,<br/>+ bloomThreshold: 0.5,<br/>  // plane params<br/>  metalness: 0.2,<br/>  ...<br/>}<br/><br/>...<br/><br/>// The RenderPass is already created in 'createComposer'<br/>+ // Post-processing with Bloom effect<br/>+ let bloomPass = new UnrealBloomPass(<br/>+   new THREE.Vector2(window.innerWidth, window.innerHeight),<br/>+   params.bloomStrength,<br/>+   params.bloomRadius,<br/>+   params.bloomThreshold<br/>+ );<br/>let composer = createComposer(renderer, scene, camera, (comp) =&gt; {<br/>+   comp.addPass(bloomPass)<br/>})<br/><br/>...<br/><br/>let app = {<br/>  async initScene() {<br/>  ...<br/><br/>    // GUI controls<br/>    const gui = new dat.GUI()<br/><br/>+   let bloomFolder = gui.addFolder(`Bloom`)<br/>+   bloomFolder.add(params, "bloomStrength", 0, 3, 0.05).onChange((val) =&gt; {<br/>+     bloomPass.strength = Number(val)<br/>+   })<br/>+   bloomFolder.add(params, "bloomRadius", 0, 1, 0.05).onChange((val) =&gt; {<br/>+     bloomPass.radius = Number(val)<br/>+   })<br/>+   bloomFolder.add(params, "bloomThreshold", 0, 1, 0.05).onChange((val) =&gt; {<br/>+     bloomPass.threshold = Number(val)<br/>+   })</span></pre><p id="343a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿™éœ€è¦ä¸€äº›å®éªŒæ¥è·å¾—é€‚åˆåœºæ™¯çš„é«˜å…‰å‚æ•°ã€‚éšç€è¿™æœ€åçš„æ¶¦è‰²åˆ°ä½ï¼Œæ•´ä¸ªåœºæ™¯ç°åœ¨ç…§äº®äº†âœ¨:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/ea9ede7e6c89eaf532b54f0581d39253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*or1Gfq5My0GRs2O_56KiIQ.png"/></div></div><p class="ns nt gj gh gi nu nv bd b be z dk translated">ä¸€æ—¦ä½ å¼€èŠ±äº†ï¼Œå°±å†ä¹Ÿä¸ä¼šå›æ¥äº†ã€‚</p></figure></div><div class="ab cl pb pc hu pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="ij ik il im in"><p id="c6ae" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿™å°±æ˜¯äº†ã€‚æ‚¨å·²ç»å®Œæˆäº†æ•™ç¨‹ï¼</p><p id="23e9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¯´å®è¯ï¼Œåœ¨åŠ¨ç¬”ä¹‹å‰ï¼Œæˆ‘å·²ç»æ­å»ºäº†ä¸€ä¸ªæˆ‘è®¤ä¸ºè¶³å¤Ÿå¥½çš„ç‰ˆæœ¬ã€‚ç„¶è€Œï¼Œå½“æˆ‘å¼€å§‹å†™è¿™ç¯‡æ–‡ç« æ—¶ï¼Œæˆ‘å‘ç°å®ƒå¹¶ä¸å¥½ï¼</p><p id="32cf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªå¤æ‚çš„è‡ªå®šä¹‰<code class="fe nn no np nq b">BufferGeometry</code>æ„å»ºåœ°å½¢å‡ ä½•å›¾å½¢ã€‚è§†è§‰æ•ˆæœå’Œæ€§èƒ½æ¯”æˆ‘ç°åœ¨å¾—åˆ°çš„ç»“æœæ›´å·®ã€‚æ„Ÿè°¢é˜…è¯»ã€‚</p></div></div>    
</body>
</html>