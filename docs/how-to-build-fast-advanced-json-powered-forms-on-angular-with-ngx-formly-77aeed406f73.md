# å¦‚ä½•ä½¿ç”¨ ngx-formly åœ¨ Angular ä¸Šæ„å»ºå¿«é€Ÿã€é«˜çº§çš„ JSON è¡¨å•

> åŸæ–‡ï¼š<https://betterprogramming.pub/how-to-build-fast-advanced-json-powered-forms-on-angular-with-ngx-formly-77aeed406f73>

## éªŒè¯ã€å¯é‡å¤éƒ¨åˆ†ã€æ¡ä»¶å­—æ®µï¼Œä»¥åŠå°†è¡¨å•æäº¤ç»™ API

![](img/213df91a6b76f63a03d0c787a3c5e76a.png)

ç”±[å‡¯åˆ©Â·è¥¿å…‹ç›](https://unsplash.com/@kellysikkema?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

æœ¬æ–‡æ˜¯åä¸ºâ€œAngular ä¸­çš„ JSON Powered Formsâ€çš„ä¸¤éƒ¨åˆ†ç³»åˆ—çš„ç¬¬äºŒéƒ¨åˆ†å¦‚æœä½ æ²¡æœ‰æ£€æŸ¥ç¬¬ä¸€éƒ¨åˆ†ï¼Œæˆ‘å»ºè®®ä½ å…ˆæ£€æŸ¥ã€‚

åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è®¨è®ºäº†å¦‚ä½•ç”¨ UI æ¡†æ¶ [Angular Material](https://material.angular.io/) åœ¨ Angular é¡¹ç›®ä¸­å®ç° [ngx-formly](https://github.com/ngx-formly/ngx-formly) ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­åŒä¸€ä¸ªé¡¹ç›®ã€‚æˆ‘ä»¬å°†å®ç°åŸºæœ¬éªŒè¯ã€è‡ªå®šä¹‰éªŒè¯ã€å¯é‡å¤éƒ¨åˆ†ã€æ¡ä»¶å­—æ®µã€å¦‚ä½•é‡ç½®è¡¨å•ä»¥åŠå¦‚ä½•å°†è¡¨å•æäº¤ç»™ API ç«¯ç‚¹ã€‚

åä¸‹æ¥ï¼Œç»™è‡ªå·±å¼„ç‚¹å–çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¦å¸¦ç€ ngx-formly åœ¨ Angular é‡Œæ½œå…¥é«˜çº§å½¢æ€çš„å…”å­æ´ã€‚

```
**Part 1** 1\. [Whatâ€™s Ngx Formly?](https://medium.com/@devbyrayray/b7a00733e66e#3d0d)
2\. [Install Dependencies](https://medium.com/@devbyrayray/b7a00733e66e#8175)
3\. [Set Up an Angular Project](https://medium.com/@devbyrayray/b7a00733e66e#0e6c)
4\. [Add Ngx Formly and Your UI Framework](https://medium.com/@devbyrayray/b7a00733e66e#8521)
5\. [Create a Simple Form](https://medium.com/@devbyrayray/b7a00733e66e#1778)
6\. [Check the Data From the Form](https://medium.com/@devbyrayray/b7a00733e66e#ded9)**Part 2**
**1\.** [**Validation**](https://medium.com/@devbyrayray/77aeed406f73) **2\.** [**Repeating Sections**](https://medium.com/@devbyrayray/77aeed406f73) **3\.** [**Conditional Fields**](https://medium.com/@devbyrayray/77aeed406f73) **4\.** [**Reset Form**](https://medium.com/@devbyrayray/77aeed406f73) **5\.** [**Submit Form**](https://medium.com/@devbyrayray/77aeed406f73)
```

# 1.ç¡®è®¤

å…ˆè¯´éªŒè¯ã€‚æ¯ä¸ªè¡¨å•éƒ½åº”è¯¥æœ‰ä¸€äº›éªŒè¯æ¥å¸®åŠ©ç”¨æˆ·å¡«å†™æ­£ç¡®çš„ä¿¡æ¯ã€‚

æ·»åŠ åŸºæœ¬éªŒè¯éå¸¸ç®€å•ï¼Œåªéœ€å‘å¯¹è±¡æ·»åŠ ä¸€äº›å±æ€§ã€‚å¦‚æœæ‚¨æƒ³è¦è‡ªå®šä¹‰éªŒè¯ï¼Œæ‚¨åªéœ€åˆ›å»ºä¸¤ä¸ªå‡½æ•°å¹¶å°†å®ƒä»¬æ·»åŠ åˆ° formly æ¨¡å—ä¸­ã€‚

## 1.1 åŸºæœ¬éªŒè¯

æ‚¨å¯ä»¥é€šè¿‡å‘è¾“å…¥å¯¹è±¡æ·»åŠ å±æ€§æ¥æ·»åŠ ä¸€äº›éªŒè¯ã€‚

*   `required`:å¦‚æœæ˜¯å¿…å¡«å­—æ®µã€‚
*   `min`:ä»…ç”¨äºæ•°å­—è¾“å…¥æ å®šä¹‰ä¸€ä¸ªæœ€å°æ•°å­—ã€‚
*   `max`:è¿™åªæ˜¯ä¸ºæ•°å­—è¾“å…¥åŸŸå®šä¹‰ä¸€ä¸ªæœ€å¤§æ•°å­—ã€‚
*   `minlength`:é€šè¿‡è¯¥å±æ€§ï¼Œæ‚¨å¯ä»¥å®šä¹‰æœ€å°å­—ç¬¦æ•°ã€‚
*   `maxlength`:è¯¥å±æ€§å¯ä»¥å®šä¹‰æœ€å¤§å­—ç¬¦æ•°ã€‚

åœ¨æ¯ä¸ªè¾“å…¥å¯¹è±¡ä¸­ï¼Œæ‚¨å¯ä»¥æ·»åŠ è¿™äº›å±æ€§ã€‚å¦‚æœä¸æ·»åŠ è¯¥å­—æ®µï¼Œå°†ä¸ä¼šå¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚

å¦‚æœæ‚¨æƒ³è¦æ‰€éœ€å±æ€§çš„éªŒè¯æ¶ˆæ¯ï¼Œæ‚¨å¿…é¡»å°†å…¶æ·»åŠ åˆ°`angular.module.ts`ä¸­ã€‚

ä½¿ç”¨å‚æ•°`field`ï¼Œæ‚¨å¯ä»¥è®¿é—®å·²ç»å¡«å……åˆ°éªŒè¯å±æ€§ä¸­çš„å€¼ã€‚è¿™å°†æœ‰åŠ©äºä½¿å®ƒæ›´æœ‰æ´»åŠ›ã€‚

åœ¨ GitHub ä¸Šæ£€æŸ¥ç¤ºä¾‹é¡¹ç›®ä¸­çš„[æäº¤ã€‚](https://github.com/raymonschouwenaar/angular-ngx-formly-material-example/tree/d8a1f15ffd82f3505a06fe947f643e588fc0a276)

## 1.2 è‡ªå®šä¹‰éªŒè¯

å¦‚æœæ‚¨æƒ³è¦å¯¹æ‚¨çš„å­—æ®µè¿›è¡Œè‡ªå®šä¹‰éªŒè¯ï¼Œæ‚¨éœ€è¦æ·»åŠ ä¸¤ä¸ªå‡½æ•°ã€‚ä¸€ä¸ªå‡½æ•°(`IpValidator`)è¿›è¡ŒéªŒè¯ï¼Œå¦ä¸€ä¸ªå‡½æ•°(`IpValidatorMessage`)å¤„ç†éªŒè¯æ¶ˆæ¯ã€‚è¿™äº›åŠŸèƒ½éœ€è¦åŒ…å«åœ¨`FormlyModule`ä¸­ã€‚

åœ¨`FormModule.forRoot()`ä¸­ï¼Œä½ ç»™å‡ºä¸€ä¸ªé…ç½®å¯¹è±¡ã€‚å¯¹äºéªŒè¯å‡½æ•°ï¼Œæ‚¨æ·»åŠ äº†å±æ€§`validators`ï¼Œå…¶ä¸­æ·»åŠ äº†ä¸€ä¸ªå¸¦æœ‰ä¸€ä¸ªå¯¹è±¡(`{ name: 'ip', validation: IpValidator }`)çš„æ•°ç»„ã€‚è¦æ·»åŠ éªŒè¯æ¶ˆæ¯ï¼Œæ‚¨éœ€è¦æ·»åŠ å±æ€§`validationMessages`ï¼Œåœ¨å…¶ä¸­æ·»åŠ ä¸€ä¸ªå¸¦æœ‰å¯¹è±¡(`{ name: 'ip', message: IpValidatorMessage }`)çš„æ•°ç»„ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

ä½ çš„`app.module.ts`åº”è¯¥æ˜¯è¿™æ ·çš„:

åœ¨æ‚¨æƒ³è¦è¿›è¡Œè‡ªå®šä¹‰éªŒè¯çš„å­—æ®µçš„å­—æ®µé…ç½®ä¸­ï¼Œæ‚¨å¿…é¡»æ·»åŠ å±æ€§`validators`ï¼Œè¯¥å±æ€§åŒ…å«ä¸€ä¸ªå€¼ä¸º`["ip"]`çš„`validation`å±æ€§ã€‚è¯¥å€¼ä¸æ‚¨åœ¨`app.module.ts`ä¸­æ·»åŠ çš„å€¼ç›¸åŒã€‚

åœ¨ GitHub ä¸Šæ£€æŸ¥ç¤ºä¾‹é¡¹ç›®ä¸­çš„[æäº¤ã€‚](https://github.com/raymonschouwenaar/angular-ngx-formly-material-example/tree/0571ff48b5e396f9622d14ab7ff8269de9b83c92)

# 2.æ·»åŠ å¯é‡å¤çš„éƒ¨åˆ†

ä¸æ˜¯æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦è¿™æ ·ã€‚ä½†æ˜¯å½“ä½ éœ€è¦çš„æ—¶å€™ï¼Œè¿™ä¸ªåŠŸèƒ½å°±å˜å¾—éå¸¸å¥½ç”¨äº†ã€‚

æ‚¨å¯ä»¥å¯¹å­—æ®µæ•°ç»„è¿›è¡Œåˆ†ç»„ï¼Œä½¿å…¶å¯é‡å¤ã€‚ä½†æ˜¯é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çš„ formly ç±»å‹(`RepeatTypeComponent`)ï¼Œå®ƒåŒ…æ‹¬ä¸€ä¸ª`<formly-field>`å’Œä¸€ä¸ªæŒ‰é’®ï¼Œç”¨äºåˆ›å»ºä¸€ç»„æ–°çš„è¾“å…¥ç±»å‹ã€‚

æˆ‘ä»¬å¿…é¡»å°†è¿™ä¸ªè¡¨å•ç±»å‹æ·»åŠ åˆ°`declaration`å±æ€§å’Œ`FormlyModule`ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨è¡¨å•é…ç½®ä¸­ä½¿ç”¨å®ƒã€‚

ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†å®ƒæ·»åŠ åˆ°è¡¨å•é…ç½®æ•°ç»„ä¸­ã€‚

å¦‚æœæ‚¨åœ¨`<pre>{{model | json }}</pre>`ä¸­è¾“å‡ºæ‚¨çš„æ¨¡å‹ï¼Œç‚¹å‡»+æŒ‰é’®å¹¶å¡«å†™è¾“å…¥å­—æ®µã€‚ç°åœ¨ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¿¡æ¯çš„æ•°ç»„ã€‚

åœ¨ GitHub ä¸Šæ£€æŸ¥ç¤ºä¾‹é¡¹ç›®ä¸­çš„[æäº¤ã€‚](https://github.com/raymonschouwenaar/angular-ngx-formly-material-example/tree/100723445ab5308651e9dde890f7fd02efa13039)

# 3.æ·»åŠ æ¡ä»¶å­—æ®µ

å¦‚æœä½ æ­£åœ¨ç”¨ Angular æ„å»ºä¸€ä¸ªå¤§çš„åº”ç”¨ç¨‹åºï¼Œä½ å¯èƒ½éœ€è¦æ¡ä»¶å­—æ®µã€‚æœ‰äº† formlyï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸ç®€å•åœ°åšåˆ°è¿™ä¸€ç‚¹ã€‚

æ‚¨åªéœ€å‘æ‚¨çš„å­—æ®µé…ç½®æ·»åŠ ä¸€ä¸ª`hideExpression`å±æ€§ã€‚è¯¥å€¼å°†å¼•ç”¨æ¨¡å‹ã€‚å¦‚æœä¹‹å‰çš„è¾“å…¥åç§°ä¸ºç©ºï¼Œåˆ™`email`å­—æ®µå°†è¢«éšè—ã€‚å½“å®ƒåŒ…å«ä¸€ä¸ªå€¼æ—¶ï¼Œå®ƒå°†è¢«æ˜¾ç¤ºã€‚

æœ€æ£’çš„æ˜¯,`email`å±æ€§åœ¨æ¨¡å‹ä¸­ä¹Ÿæ˜¯ä¸å¯è§çš„ï¼Œæ‰€ä»¥æ‚¨ä¸ä¼šå‘é€å®ƒã€‚

åœ¨ GitHub ä¸Šæ£€æŸ¥ç¤ºä¾‹é¡¹ç›®ä¸­çš„[æäº¤ã€‚](https://github.com/raymonschouwenaar/angular-ngx-formly-material-example/tree/575b4febae9758ace7894ba657edfbaeab048822)

# **4ã€‚é‡ç½®è¡¨å•**

ä½¿ç”¨ formlyï¼Œæ·»åŠ ä¸€ä¸ªé‡ç½®æŒ‰é’®æ¥æ¸…é™¤è¡¨å•ä¸­çš„æ‰€æœ‰å€¼ä¹Ÿéå¸¸å®¹æ˜“ã€‚

åªéœ€æ·»åŠ æŒ‰é’®ï¼Œåœ¨ç±»å‹ä¸º`FormlyFormOptions`çš„ç»„ä»¶ç±»ä¸­åˆ›å»ºä¸€ä¸ª`options`å±æ€§ï¼Œå¹¶å°†æŒ‰é’®æ·»åŠ åˆ°è¡¨å•ä¸­ã€‚ç„¶åå°†`[options]=â€optionsâ€`æ·»åŠ åˆ°è¡¨å•ç»„ä»¶ï¼Œå°†`(click)=â€options.resetModel()â€`æ·»åŠ åˆ°æŒ‰é’®ã€‚

é‡è¦çš„æ˜¯è¦çŸ¥é“ï¼Œå¦‚æœæ‚¨çš„æ¨¡å‹å·²ç»å¡«å……äº†å€¼ï¼Œè¯¥åŠŸèƒ½ä¸ä¼šåˆ é™¤è¿™äº›ä¿¡æ¯ã€‚å½“æ‚¨æ›´æ”¹è¯¥å€¼æˆ–æ·»åŠ æ–°å€¼æ—¶ï¼Œå®ƒå°†é‡ç½®è¿™äº›å€¼ã€‚

åœ¨ GitHub ä¸Šæ£€æŸ¥ç¤ºä¾‹é¡¹ç›®ä¸­çš„[æäº¤ã€‚](https://github.com/raymonschouwenaar/angular-ngx-formly-material-example/tree/10852832404b515b216ac4fceb9374c2b6335eb4)

# **5ã€‚æäº¤è¡¨æ ¼**

ä½¿ç”¨ formly æäº¤æˆ‘ä»¬çš„è¡¨å•ä¹Ÿå¾ˆå®¹æ˜“ã€‚

å‘æ‚¨çš„`<form>`æ ‡ç­¾æ·»åŠ ä¸€ä¸ª`(ngSubmit)=â€œsubmit()â€`ï¼Œå®ƒå°†è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æ¥æäº¤åº”è¯¥åœ¨è¯¥ç»„ä»¶ä¸­å£°æ˜çš„å†…å®¹ã€‚

```
onSubmit() {
  if (this.form.valid) {
    console.log(JSON.stringify(this.model));
  }
}
```

ç°åœ¨ï¼Œè¿™å°†åœ¨æ§åˆ¶å°ä¸­æ˜¾ç¤ºæ¨¡å‹æ•°æ®ã€‚ä½†æ˜¯æˆ‘çŒœæƒ³å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ Angularï¼Œä½ åº”è¯¥ç†Ÿæ‚‰å¦‚ä½•åœ¨å…¶ä¸­å‘é€è¯·æ±‚ã€‚å¦‚æœä¸æ˜¯ï¼Œè¯·ç”¨è¿™ä¸ªä¾‹å­ã€‚

ç¡®ä¿æ‚¨å·²ç»åœ¨æ‚¨çš„`app.module.ts`ä¸­åŠ è½½äº† [HttpClientModule](https://angular.io/api/common/http/HttpClientModule) ã€‚

åœ¨æ‚¨çš„ç»„ä»¶ä¸­ï¼Œç¡®ä¿æ‚¨åœ¨æ„é€ å‡½æ•°ä¸­åŒ…å«äº†`HttpClient`ï¼Œè¿™å°†ç¡®ä¿æ‚¨å¯ä»¥åœ¨æ‚¨çš„ç»„ä»¶ä¸­ä½¿ç”¨è¿™ä¸ª`.http`ã€‚

```
constructor(private http: HttpClient) { }
```

åœ¨`submit`æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`HttpClient`æ¥æ‰§è¡Œ post è¯·æ±‚ã€‚

æˆ‘ä»¬çŸ¥é“è¿™ä¸ª URL æ˜¯æ— æ•ˆçš„ï¼Œæ‰€ä»¥å®ƒä¼šå¯¼è‡´ä¸€ä¸ªé”™è¯¯ã€‚ä½†æ˜¯å¦‚æœä½ ç”¨ä¸€ä¸ªæœ‰æ•ˆçš„æ›¿æ¢å®ƒï¼Œå®ƒå°±èƒ½å·¥ä½œã€‚

æ›´å¥½çš„åšæ³•æ˜¯é€šè¿‡åœºå¤–çš„è§’åº¦æœåŠ¡æ¥è¯·æ±‚ï¼Œä½†æˆ‘ä¼šæŠŠè¿™ç•™ç»™ä½ ã€‚

åœ¨ GitHub ä¸Šæ£€æŸ¥ç¤ºä¾‹é¡¹ç›®ä¸­çš„[æäº¤ã€‚](https://github.com/raymonschouwenaar/angular-ngx-formly-material-example/tree/15e0f3800da0825c36585d8da37e2c1dcb548a7b)

# **ç»“è®º**

æˆ‘å¸Œæœ›æœ¬æ•™ç¨‹çš„ç¬¬äºŒéƒ¨åˆ†èƒ½å¤Ÿå¸®åŠ©æ‚¨ç”¨ ngx-formly æ„å»ºæ›´é«˜çº§çš„è¡¨å•ã€‚å¦‚æœä½ è¿˜æœ‰å…³äºå¦‚ä½•åšæŸäº›äº‹æƒ…çš„é—®é¢˜ï¼Œè¯·æ·»åŠ åˆ°è¯„è®ºä¸­ã€‚

ä½ è¿˜ä¸ç¡®å®š ngx-formly å¯¹ä¼ä¸šçº§åº”ç”¨æ˜¯å¦æœ‰æ•ˆå—ï¼Ÿæˆ‘å¯ä»¥å‘æ‚¨ä¿è¯ï¼Œæˆ‘å’Œæˆ‘çš„å›¢é˜Ÿè‡ªå·±ä½¿ç”¨å®ƒæ¥æ„å»ºå…·æœ‰å¤šä¸ªè¾“å…¥å­—æ®µçš„æ‰€æœ‰è¡¨å•ã€‚

æˆ‘ä»¬ç”šè‡³åœ¨åŸºäºå¼€æ”¾ API è§„èŒƒ 3.0 çš„ API ä¸­è®©å®ƒå˜å¾—å¦‚æ­¤é€šç”¨ã€‚å¯¹äºæ¯ä¸ªæ¨¡å‹ï¼Œå®ƒéƒ½ä¼šè‡ªåŠ¨æ„å»ºè¡¨å•ã€‚

å¦‚æœä½ éœ€è¦å¸®åŠ©è®¾ç½®ä½ çš„è¡¨å•ï¼Œè¯·æŸ¥çœ‹ GitHub ä¸Šçš„[ç¤ºä¾‹æŠ¥å‘Šã€‚](https://github.com/raymonschouwenaar/angular-ngx-formly-material-example)

# è°¢è°¢ï¼

![](img/2bd571bb1ce9f466ae279fa98111b086.png)

è¯»å®Œè¿™ä¸ªæ•…äº‹åï¼Œæˆ‘å¸Œæœ›ä½ å­¦åˆ°äº†ä¸€äº›æ–°çš„ä¸œè¥¿ï¼Œæˆ–è€…å—åˆ°å¯å‘å»åˆ›é€ ä¸€äº›æ–°çš„ä¸œè¥¿ï¼ğŸ¤—

å¦‚æœæˆ‘ç»™ä½ ç•™ä¸‹äº†é—®é¢˜æˆ–ä¸€äº›è¦è¯´çš„è¯ä½œä¸ºå›åº”ï¼Œå‘ä¸‹æ»šåŠ¨å¹¶ç»™æˆ‘é”®å…¥ä¸€æ¡æ¶ˆæ¯ã€‚å¦‚æœä½ æƒ³ä¿å¯†ï¼Œè¯·åœ¨ Twitter @DevByRayRay ä¸Šç»™æˆ‘å‘ä¸€æ¡ [DMã€‚æˆ‘çš„ DM æ°¸è¿œæ˜¯å¼€æ”¾çš„ğŸ˜](https://twitter.com/@devbyrayray)

[**é€šè¿‡ç”µå­é‚®ä»¶è·å–æˆ‘çš„æ–‡ç« ç‚¹å‡»è¿™é‡Œ**](https://byrayray.medium.com/subscribe) **|** [**è´­ä¹° 5 ç¾å…ƒä¸­ç­‰ä¼šå‘˜**](https://byrayray.medium.com/membership)

# é˜…è¯»æ›´å¤š

![RayRay](img/992af170033696163d6cc0269218aedd.png)

é›·é›·

## è’è¯çš„æ•…äº‹

[View list](https://byrayray.medium.com/list/angular-stories-24674407532a?source=post_page-----77aeed406f73--------------------------------)6 stories![](img/b94f2b7d2929c90566cd2dd6f657a751.png)![](img/02b73423a62d73b113af9fdf9629c79f.png)![Stacked books](img/b02a2f57c0093e04ab1d11d3a55f35ea.png)![RayRay](img/992af170033696163d6cc0269218aedd.png)

[é›·é›·](https://byrayray.medium.com/?source=post_page-----77aeed406f73--------------------------------)

## æœ€æ–°çš„ JavaScript å’Œ TypeScript æ•…äº‹

[View list](https://byrayray.medium.com/list/latest-javascript-typescript-stories-0358ad941491?source=post_page-----77aeed406f73--------------------------------)14 stories![](img/c93ca03b33796c40dcc47873de2697c2.png)![](img/86f37efa11855f6f0f0f62984c37f696.png)![](img/ddbaa6d0bea676316247e82043d60b63.png)