# JavaScript ä¸­ map()å’Œ forEach()æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

> åŸæ–‡ï¼š<https://betterprogramming.pub/what-is-the-difference-between-map-and-foreach-in-javascript-9bc49afa2703>

## ç”¨æ³•ã€é€Ÿåº¦æ¯”è¾ƒç­‰ç­‰

![](img/d8aa0518024f17025ade8d0fbac98024.png)

ç…§ç‰‡ç”±[å°¼å…‹Â·è´¹å› æ–¯](https://unsplash.com/@jannerboy62?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)åœ¨ [Unsplash](https://unsplash.com/s/photos/difference?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šæ‹æ‘„

JavaScript ä¸­ä¸€äº›æœ€å—æ¬¢è¿çš„å‡½æ•°å¯èƒ½æ˜¯`map`å’Œ`forEach`ã€‚å®ƒä»¬éƒ½æ˜¯ä» ECMAScript 5 æˆ–è€…ç®€ç§°ä¸º`es5`å¼€å§‹å­˜åœ¨çš„ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è°ˆè®ºå®ƒä»¬ä¹‹é—´çš„ä¸»è¦åŒºåˆ«ï¼Œå¹¶å‘ä½ å±•ç¤ºä¸€äº›å®ƒä»¬çš„ç”¨æ³•ã€‚

# é˜…è¯»å‰

åŸºæœ¬ä¸Šï¼Œåœ¨ JavaScript ä¸­éå†ä¸€ä¸ªå¯¹è±¡å–å†³äºè¯¥å¯¹è±¡æ˜¯å¦æ˜¯ä¸€ä¸ª`iterable`ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°ç»„æ˜¯å¯è¿­ä»£çš„ã€‚

`map`å’Œ`forEach`éƒ½åŒ…å«åœ¨`Array.prototype`é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘`iterable`ã€‚å¦‚æœä½ æƒ³è¿›ä¸€æ­¥å­¦ä¹ ï¼Œæˆ‘å»ºè®®ä½ çœ‹çœ‹ JavaScript ä¸­çš„`iterable`å¯¹è±¡æ˜¯ä»€ä¹ˆï¼

# ä»€ä¹ˆæ˜¯`map()`å’Œ`forEach()`ï¼Ÿ

`map`å’Œ`forEach`æ˜¯ array ä¸­çš„ helper æ–¹æ³•ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°å¾ªç¯æ•°ç»„ã€‚æˆ‘ä»¬æ›¾ç»åœ¨ä¸€ä¸ªæ•°ç»„ä¸Šå¾ªç¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œæ²¡æœ‰ä»»ä½•å¸®åŠ©å‡½æ•°ã€‚

ä» JavaScript æ—¶ä»£ä¸€å¼€å§‹ï¼Œå¾ªç¯å°±ä¼´éšç€æˆ‘ä»¬ã€‚å®ƒéœ€è¦ 3 ä¸ªè¡¨è¾¾å¼:åˆå§‹å€¼ã€æ¡ä»¶å’Œæœ€ç»ˆè¡¨è¾¾å¼ã€‚

è¿™æ˜¯å¾ªç¯æ•°ç»„çš„ç»å…¸æ–¹å¼ã€‚è‡ª ECMAScript 5 ä»¥æ¥ï¼Œæ–°çš„å‡½æ•°ä¼¼ä¹è®©æˆ‘ä»¬æ›´å¿«ä¹ã€‚

## åœ°å›¾

`map`ä¸`for`å¾ªç¯åšçš„å®Œå…¨ä¸€æ ·ï¼Œé™¤äº†`map`åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œç»“æœæ˜¯åœ¨è°ƒç”¨æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä¸Šè°ƒç”¨ä¸€ä¸ªæä¾›çš„å‡½æ•°ã€‚

å®ƒæœ‰ä¸¤ä¸ªå‚æ•°:ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç¨åè°ƒç”¨`map`æˆ–`forEach`æ—¶ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸Šä¸‹æ–‡å˜é‡`thisArg`ï¼Œå›è°ƒå‡½æ•°åœ¨è°ƒç”¨æ—¶ä¼šç”¨åˆ°è¿™ä¸ªå˜é‡ã€‚

å›è°ƒå‡½æ•°å¯ä»¥å¦‚ä¸‹ä½¿ç”¨ã€‚

```
arr.map((str) => { console.log(Number(str)); })
```

`map`çš„ç»“æœä¸ç­‰äºåŸæ•°ç»„ã€‚

```
const arr = [1];
const new_arr = arr.map(d => d);arr === new_arr; // false
```

æ‚¨ä¹Ÿå¯ä»¥å°†å¯¹è±¡ä½œä¸º`thisArg`ä¼ é€’ç»™`map`ã€‚

å¯¹è±¡`obj`å˜æˆäº†`map`çš„`thisArg`ã€‚ä½†ç®­å¤´å›è°ƒå‡½æ•°æ— æ³•è·å–`obj`ä½œä¸ºå…¶`thisArg`ã€‚

è¿™æ˜¯å› ä¸ºç®­å¤´å‡½æ•°çš„å·¥ä½œæ–¹å¼ä¸åŒäºæ™®é€šå‡½æ•°ã€‚è®¿é—®[è¿™ç¯‡æ–‡ç« ](https://www.geeksforgeeks.org/difference-between-regular-functions-and-arrow-functions/)çœ‹çœ‹ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°æœ‰ä»€ä¹ˆä¸åŒã€‚

## ä¸ºæ¯ä¸€ä¸ª

`forEach`æ˜¯æ•°ç»„çš„å¦ä¸€ä¸ªå¾ªç¯å‡½æ•°ï¼Œä½†æ˜¯`map`å’Œ`forEach`åœ¨ä½¿ç”¨ä¸Šæœ‰æ‰€ä¸åŒã€‚æœ‰ä¸¤ä¸ªå‚æ•°`map`å’Œ`forEach`å¯ä»¥æ¥å—â€”â€”ä¸€ä¸ªå›è°ƒå‡½æ•°å’Œ`thisArg`,å®ƒä»¬å°†è¿™ä¸¤ä¸ªå‚æ•°ç”¨ä½œå®ƒä»¬çš„ *thisã€‚*

é‚£ä¹ˆï¼Œæœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ

`map`è¿”å›åŸæ•°ç»„çš„æ–°æ•°ç»„ã€‚ç„¶è€Œ`forEach`å´æ²¡æœ‰ã€‚ä½†ä¸¤è€…éƒ½ä¿è¯äº†åŸå¯¹è±¡çš„ä¸å˜æ€§ã€‚

```
[1,2,3].map(d => d + 1); // [2, 3, 4];
[1,2,3].forEach(d => d + 1); // undefined;
```

**~~ç¼–è¾‘~~**

`forEach`å¦‚æœæ‚¨æ›´æ”¹æ•°ç»„å†…éƒ¨çš„å€¼ï¼Œä¸ä¼šç¡®ä¿æ•°ç»„çš„ä¸å˜æ€§ã€‚è¿™ä¸ªæ–¹æ³•åªåœ¨ä½ ä¸æ¥è§¦é‡Œé¢çš„ä»»ä½•å€¼çš„æ—¶å€™ä¿è¯ä¸å˜æ€§ã€‚

```
[{a: 1, b: 2}, {a: 10, b: 20}].forEach((obj) => obj.a += 1);
// [{a: 2, b: 2}, {a: 11, b: 21}]
// The array has been changed!
```

ä¸Šé¢çš„ä¾‹å­æ¥è‡ªäº[è‚¯å°¼Â·é©¬ä¸Â·é‡Œæ ¼æ–¯](https://medium.com/u/34f1ed47628d?source=post_page-----9bc49afa2703--------------------------------)ã€‚è°¢è°¢å¤§å®¶ï¼ğŸ‘

# ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ map()å’Œ forEach()ï¼Ÿ

å› ä¸ºå®ƒä»¬ä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äºæ˜¯å¦æœ‰è¿”å›å€¼ï¼Œæ‰€ä»¥æ‚¨å¯èƒ½å¸Œæœ›ä½¿ç”¨`map`æ¥åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œè€Œä½¿ç”¨`forEach`æ¥æ˜ å°„è¿™ä¸ªæ•°ç»„ã€‚

è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚

ä¾‹å¦‚ï¼Œåœ¨ React ä¸­ï¼Œ`map`éå¸¸å¸¸ç”¨äºåˆ›å»ºå…ƒç´ ï¼Œå› ä¸º`map`åœ¨æ“ä½œåŸå§‹æ•°ç»„çš„æ•°æ®ååˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚

å¦ä¸€æ–¹é¢ï¼Œ`forEach`åœ¨æ‚¨æƒ³å¯¹æ•°æ®åšä¸€äº›äº‹æƒ…è€Œä¸åˆ›å»ºæ–°æ•°ç»„æ—¶å¾ˆæœ‰ç”¨ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè¿™ä¸ªä¾‹å­å¯ä»¥ç”¨`filter`æ¥é‡æ„ã€‚

```
subjects.filter(subject => mySubjectId.includes(subject.id)).length;
```

æ€»çš„æ¥è¯´ï¼Œæˆ‘å»ºè®®æ‚¨åœ¨åˆ›å»ºå°†è¦ä½¿ç”¨çš„æ–°æ•°ç»„æ—¶ä½¿ç”¨`map`,åœ¨ä¸éœ€è¦åˆ›å»ºæ–°æ•°ç»„æ—¶ä½¿ç”¨`forEach`,ä½†æ˜¯æ‚¨éœ€è¦å¯¹æ•°æ®åšä¸€äº›äº‹æƒ…ã€‚

# é€Ÿåº¦æ¯”è¾ƒ

æœ‰äº›å¸–å­æåˆ°`map`æ¯”`forEach`å¿«ã€‚æ‰€ä»¥ï¼Œæˆ‘å¾ˆå¥½å¥‡è¿™æ˜¯ä¸æ˜¯çœŸçš„ã€‚æˆ‘å‘ç°äº†è¿™ä¸ªå¯¹æ¯”ç»“æœ:

![](img/396861c9c5f37cfa740763c6b2a80a67.png)![](img/c4a650d50a4d615672b5e5d231941754.png)

[å·¦ç»“æœ jsPerf](https://jsperf.com/foreach-v-map) å’Œ[å³ç»“æœ jsPerf](https://jsperf.com/map-vs-foreach-speed-test?source=post_page-----f38111822c0f----------------------)

ä»£ç çœ‹èµ·æ¥éå¸¸ç›¸ä¼¼ï¼Œä½†ç»“æœå´ç›¸åã€‚ä¸€äº›æµ‹è¯•è¯´`forEach`æ›´å¿«ï¼Œä¸€äº›æµ‹è¯•è¯´`map`æ›´å¿«ã€‚

ä¹Ÿè®¸ä½ åœ¨å‘Šè¯‰è‡ªå·±`map` / `forEach`æ¯”å¦ä¸€ä¸ªæ›´å¿«ï¼Œä½ å¯èƒ½æ˜¯å¯¹çš„ã€‚è€å®è¯´ï¼Œæˆ‘ä¸ç¡®å®šã€‚æˆ‘è®¤ä¸ºå¯¹äºç°ä»£ web å¼€å‘æ¥è¯´ï¼Œå¯è¯»æ€§æ¯”`map`å’Œ`forEach`ä¹‹é—´çš„é€Ÿåº¦æ›´é‡è¦ã€‚

ä½†æœ‰ä¸€ç‚¹å¯ä»¥è‚¯å®šâ€”â€”å®ƒä»¬éƒ½æ¯” JavaScript çš„å†…ç½®ç‰¹æ€§`for` loop æ…¢ã€‚

# ç»“è®º

`map`å’Œ`forEach`æ˜¯å¾ªç¯éå†ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡çš„æ–¹ä¾¿å‡½æ•°ï¼Œå¯èƒ½ä¼šç¾åŒ–ä½ çš„ä»£ç ï¼Œç»™ä½ æ›´å¤šçš„å¯è¯»æ€§ã€‚

ä½†æ˜¯è¦è®°ä½çš„ä¸€ä¸ªçœŸæ­£é‡è¦çš„åŸºè°ƒæ˜¯ç†è§£æ¯ä¸€ä¸ªéƒ½åšä»€ä¹ˆä»¥åŠä½•æ—¶ä½¿ç”¨å®ƒä»¬ã€‚

å½“æ‚¨æƒ³åˆ›å»ºä¸€ä¸ªä¸å½±å“åŸå§‹æ•°ç»„çš„æ–°æ•°ç»„æ—¶ï¼Œ`map`ä¼šæ¯”è¾ƒå¥½ï¼Œè€Œå½“æ‚¨åªæƒ³æ˜ å°„ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œ`forEach`ä¼šæ›´å¥½ã€‚

# èµ„æº

*   [ç”¨äºå¾ªç¯ MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for)
*   [åœ°å›¾ MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map)
*   [ç®­å¤´åŠŸèƒ½ä¸æ™®é€šåŠŸèƒ½](https://www.geeksforgeeks.org/difference-between-regular-functions-and-arrow-functions/)
*   [forEach MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach)
*   [map vs forEach jsPerf](https://jsperf.com/foreach-v-map)â€”`forEach`æ›´å¿«
*   [map vs forEach jsPerf](https://jsperf.com/map-vs-foreach-speed-test?source=post_page-----f38111822c0f----------------------)â€”`map`æ›´å¿«