<html>
<head>
<title>Introducing The AppIntents Framework â€” A New Way to Integrate Appâ€™s Functionality Into the System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä»‹ç»AppIntentsæ¡†æ¶â€”â€”ä¸€ç§å°†AppåŠŸèƒ½é›†æˆåˆ°ç³»ç»Ÿä¸­çš„æ–°æ–¹æ³•</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://betterprogramming.pub/the-appintents-framework-a-new-way-to-hook-up-apps-functionality-to-the-system-96279feb4cce?source=collection_archive---------8-----------------------#2022-09-15">https://betterprogramming.pub/the-appintents-framework-a-new-way-to-hook-up-apps-functionality-to-the-system-96279feb4cce?source=collection_archive---------8-----------------------#2022-09-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3f08" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">æ¼”ç¤ºAppIntentsæ¡†æ¶çš„è´¹ç”¨è·Ÿè¸ªå™¨åº”ç”¨ç¨‹åº</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b52a27e2ca5594421f07b7f9cf89afd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Kd_2Sd0t1QEXckaT"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ç±³æ ¼å°”Â·æ‰˜é©¬æ–¯åœ¨<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</p></figure><p id="c842" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">WWDCä¸€ç›´æ˜¯è‹¹æœæ¯å¹´æœ€å¤§çš„æ´»åŠ¨ä¹‹ä¸€ï¼Œå› ä¸ºä¸–ç•Œä¸Šæœ€å¤§çš„æŠ€æœ¯å…¬å¸å‘å…¶å®¢æˆ·ã€åª’ä½“å’Œä¸–ç•Œå…¶ä»–åœ°æ–¹ï¼Œæ›´é‡è¦çš„æ˜¯å‘å¼€å‘è€…å®£å¸ƒå…¶æœ€æ–°çš„è½¯ä»¶å’Œç¡¬ä»¶äº§å“ï¼Œè¿™äº›äº§å“é‡‡ç”¨äº†å°–ç«¯æŠ€æœ¯ã€‚</p><p id="90c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ¯ä¸ªiOSå¼€å‘è€…éƒ½ä¼šåœ¨è¿™ä¸€å¤©èµ¶ä¸Šè‹¹æœçš„æœ€æ–°äº§å“ï¼Œå¹¶é€šè¿‡æ•´åˆè‹¹æœæ“ä½œç³»ç»Ÿæ–°ç‰ˆæœ¬å‘å¸ƒçš„æ–°åŠŸèƒ½æ¥å¢åŠ åº”ç”¨ç¨‹åºçš„ä»·å€¼ã€‚</p><p id="0f27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">éšç€iOS 16å’ŒXcode 14çš„å‘å¸ƒï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥åœ¨æˆ‘ä»¬çš„iPhoneså’Œå¼€å‘ç¯å¢ƒä¸­å®Œå…¨è®¿é—®iOS 16åŠŸèƒ½ã€‚</p><p id="1918" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨è‹¹æœåœ¨iOS 16ä¸­å¼•å…¥çš„ä¸€ä¸ªå¾ˆé…·çš„åŠŸèƒ½ï¼Œä»¥å¢å¼ºæˆ‘ä»¬çš„iOSåº”ç”¨ç¨‹åºå¹¶ä½¿å…¶æ›´åŠ ç”¨æˆ·å‹å¥½ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„åº”ç”¨ç¨‹åºæ„å›¾ã€‚</p><p id="36ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åº”ç”¨æ„å‘æ¡†æ¶æä¾›äº†ä¸€ç§ç¼–ç¨‹æ–¹æ³•ï¼Œä½¿ç³»ç»ŸæœåŠ¡å¯ä»¥è®¿é—®æ‚¨çš„åº”ç”¨çš„å†…å®¹å’ŒåŠŸèƒ½ã€‚è¿™äº›æ„å›¾æ˜¯å¯ä»¥åœ¨æ•´ä¸ªç³»ç»Ÿä¸­ä½¿ç”¨çš„åŠ¨ä½œã€‚åº”ç”¨ç¨‹åºæ„å›¾ä½¿æ‚¨çš„åº”ç”¨ç¨‹åºçš„åŠŸèƒ½åœ¨æ›´å¤šåœ°æ–¹å¯ç”¨ï¼ŒåŒ…æ‹¬å¿«æ·æ–¹å¼ã€Spotlightã€ç„¦ç‚¹æ»¤é•œå’ŒSiriï¼Œè¿™ä¸ºæ‚¨çš„å®¢æˆ·å¸¦æ¥äº†å·¨å¤§çš„å¥½å¤„ã€‚å¬èµ·æ¥å¾ˆæ£’ï¼Œå¯¹å§ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬æ¥è¯•ç€ç†è§£ä¸€ä¸‹è¿™äº›Appæ„å›¾çš„ç»“æ„ã€‚</p><p id="86f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ„å›¾æ˜¯ä½ çš„åº”ç”¨ç¨‹åºå‘ç³»ç»Ÿå…¬å¼€çš„å•ä¸€åŠŸèƒ½ã€‚è¿™é¡¹åŠŸèƒ½å¯ä»¥ä»æ‚¨çš„åº”ç”¨ç¨‹åºä¸­è·å–ä¸€äº›æ•°æ®ï¼Œä¾‹å¦‚æ‰¾å‡ºä¸‹ä¸€æ¬¡ä¼šè®®çš„æ—¶é—´å’Œæ‚¨çš„è®¢å•æ‰€åœ¨çš„ä½ç½®ï¼Œå¹¶å°†æ•°æ®æ¨é€åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œè€Œæ— éœ€åœ¨å‰å°å¯åŠ¨ï¼Œä¾‹å¦‚å‘æ‚¨çš„æ—¥å†æ·»åŠ æ–°äº‹ä»¶ã€‚è¿™äº›åŠŸèƒ½å®Œå…¨å–å†³äºä½ çš„åº”ç”¨ç¨‹åºçš„åŠŸèƒ½å’Œä½ çš„åˆ›é€ åŠ›ã€‚</p><p id="2f4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸€ä¸ªæ„å‘ä¸»è¦ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼›</p><ul class=""><li id="5d6b" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">å…ƒæ•°æ®(å…³äºæ„å›¾çš„ä¿¡æ¯ï¼Œå¦‚å¿«æ·æ–¹å¼åº”ç”¨ç¨‹åºä¸­æ˜¾ç¤ºçš„æ ‡é¢˜)ã€‚</li><li id="3061" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">å‚æ•°(æ‚¨çš„æ„å›¾éœ€è¦ç”¨æˆ·é€šè¿‡ä½¿ç”¨é”®ç›˜ã€äº¤äº’æˆ–Siriè¿›è¡Œçš„è¾“å…¥)ã€‚</li><li id="a887" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">æ‰§è¡Œæ–¹æ³•(åœ¨æ‰§è¡Œæ„å›¾æ—¶è´Ÿè´£è¿è¡Œä¸»å‡½æ•°)ã€‚</li></ul><p id="af19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åº”ç”¨ç¨‹åºçš„æ„å›¾å°±åƒå†™å‡ è¡Œä»£ç é›†æˆåˆ°ä½ çš„åº”ç”¨ç¨‹åºä¸­ä¸€æ ·ç®€å•ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³è¦åˆ›å»ºæ›´å¤æ‚çš„ç‰¹æ€§ï¼Œæ¡†æ¶ä¹Ÿå¯ä»¥è®©æ‚¨è¿™æ ·åšã€‚æ‚¨å¯ä»¥ä½¿ç”¨Swiftä¸ºæˆ‘ä»¬æä¾›çš„æ‰€æœ‰åŠŸèƒ½æ¥åˆ›å»ºæ„å›¾ã€‚ä¸éœ€è¦é‡æ„æ‚¨çš„é¡¹ç›®æˆ–ä¸€äº›è‡ªåŠ¨ä»£ç ç”Ÿæˆæ­¥éª¤ã€‚</p><p id="a536" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†æ›´å¥½åœ°å¯è§†åŒ–å¦‚ä½•å°†åº”ç”¨ç¨‹åºæ„å›¾æ·»åŠ åˆ°iOSé¡¹ç›®ä¸­ï¼Œæˆ‘å°†åˆ›å»ºä¸€ä¸ªåä¸ºHarcaMAçš„è´¹ç”¨è·Ÿè¸ªå™¨åº”ç”¨ç¨‹åºã€‚å°±å…¶åŠŸèƒ½å’Œç”¨æˆ·ç•Œé¢è€Œè¨€ï¼Œè¿™æ¬¾åº”ç”¨ä¸ä¼šæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„ï¼Œä½†å®ƒè¶³ä»¥è§£é‡Šåº”ç”¨æ„å›¾æ¡†æ¶çš„åŠ›é‡ã€‚</p><p id="5c5c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘å°†åœ¨ä½¿ç”¨SnapKitè®¾è®¡ç”¨æˆ·ç•Œé¢æ—¶ä»¥ç¼–ç¨‹æ–¹å¼ä½¿ç”¨UIKitï¼Œä½†åŒæ ·å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ‚¨ä¹Ÿå¯ä»¥å°†åº”ç”¨ç¨‹åºæ„å›¾åº”ç”¨äºæ‚¨çš„SwiftUIåº”ç”¨ç¨‹åºã€‚</p><p id="53d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°†æœ‰ä¸‰é¡µã€‚ç¬¬ä¸€ä¸ªæ˜¯æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€åšçš„è´¹ç”¨åˆ—è¡¨ï¼Œç¬¬äºŒä¸ªæ˜¯æ·»åŠ æ–°çš„è´¹ç”¨ï¼Œç¬¬ä¸‰ä¸ªæ˜¯ç¼–è¾‘å½“å‰çš„è´¹ç”¨ã€‚æˆ‘ä»¬è¿˜å°†æœ‰æœºä¼šä»ç”³è¯·ä¸­åˆ é™¤è´¹ç”¨ã€‚æ‰€æœ‰è¿™äº›è´¹ç”¨éƒ½å°†å­˜å‚¨åœ¨æ ¸å¿ƒæ•°æ®ä¸­ã€‚æˆ‘å°†éµå¾ªMVVMçš„å§”æ‰˜è®¾è®¡æ¨¡å¼æ¥åˆ›å»ºè¿™ä¸ªåº”ç”¨ç¨‹åºã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬ä»ä»Xcodeåˆ›å»ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå¼€å§‹ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mg"><img src="../Images/24cb836a0766401a78eb5d17cd0b218b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kPQ2ZCI2jyvggVQJ"/></div></div></figure><p id="0da2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">é€‰æ‹©storyboardç•Œé¢ï¼Œswiftä½œä¸ºè¯­è¨€ï¼Œå¹¶é€‰ä¸­â€œä½¿ç”¨æ ¸å¿ƒæ•°æ®â€é€‰é¡¹ï¼Œç„¶åå°†é¡¹ç›®ä¿å­˜åœ¨å­˜å‚¨å™¨ä¸­çš„æŸä¸ªä½ç½®ã€‚</p><p id="c3c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ­£å¦‚æˆ‘æ‰€è¯´çš„ï¼Œæˆ‘ä»¬ä¸ä¼šä½¿ç”¨æ•…äº‹æ¿æ¥åˆ›å»ºç”¨æˆ·ç•Œé¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»é¡¹ç›®å¯¼èˆªå™¨ä¸­åˆ é™¤<code class="fe mh mi mj mk b">Main.storyboard</code>æ–‡ä»¶ã€‚å¹¶å¼€å§‹é…ç½®æˆ‘ä»¬çš„é¡¹ç›®ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="85cb" class="mp mq iq mk b gy mr ms l mt mu">func scene(_ scene: UIScene, willConnectTo session: UISceneSession, options connectionOptions: UIScene.ConnectionOptions) {<br/><br/>        guard let windowScene = (scene as? UIWindowScene) else { return }<br/>        window = UIWindow(windowScene: windowScene)<br/>        window?.rootViewController = UINavigationController(rootViewController: ViewController())<br/>        window?.makeKeyAndVisible()<br/>    }</span></pre><p id="f401" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è½¬åˆ°<code class="fe mh mi mj mk b">SceneDelegate</code>æ–‡ä»¶ï¼Œç”¨ä¸Šé¢çš„ä»£ç æ›¿æ¢<code class="fe mh mi mj mk b">connectionOptions</code>å‡½æ•°çš„å†…å®¹ã€‚</p><p id="ec70" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç„¶åæ‰“å¼€<code class="fe mh mi mj mk b">Info.plist</code>æ–‡ä»¶ï¼Œåˆ é™¤é”®ä¸º<code class="fe mh mi mj mk b">UISceneStoryboardFile</code>å€¼ä¸º<code class="fe mh mi mj mk b">Main</code>çš„å±æ€§ã€‚</p><p id="a492" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æœ€åè½¬åˆ°ç›®æ ‡çš„æ„å»ºè®¾ç½®ï¼Œè¿‡æ»¤<code class="fe mh mi mj mk b">Main</code>çš„å†…å®¹ï¼Œå¹¶åˆ é™¤UIKitä¸»æ•…äº‹æ¿æ–‡ä»¶åŸºæœ¬åç§°å±æ€§çš„å€¼ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/7602fbf55d91addc223e601346076a71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iG3tTTK4RlzELeQz"/></div></div></figure><p id="699f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å®‰å…¨åœ°ç§»é™¤äº†æ•…äº‹æ¿ï¼Œå¹¶å‡†å¤‡åˆ›å»ºç”¨æˆ·ç•Œé¢â€”â€”åœ¨å°†SnapKitä½œä¸ºä¾èµ–é¡¹æ·»åŠ åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¹‹åã€‚</p><p id="c605" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘å°†ä½¿ç”¨SwiftåŒ…ç®¡ç†å™¨ï¼Œä½†ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨CocoaPodsæˆ–Carthageã€‚è½¬åˆ°æ–‡ä»¶èœå•ï¼Œå¹¶ä»Xcodeé€‰é¡¹ä¸­é€‰æ‹©æ·»åŠ åŒ…ã€‚æœç´¢â€œ<a class="ae kv" href="https://github.com/SnapKit/SnapKit.git" rel="noopener ugc nofollow" target="_blank">https://github.com/SnapKit/SnapKit.git</a>â€ï¼Œç„¶åæŒ‰æ·»åŠ åŒ…æŒ‰é’®ã€‚</p><p id="e13e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨ä¸€å°æ®µæ—¶é—´åï¼Œå®ƒä¼šè¯¢é—®æ‚¨è¦åœ¨åº”ç”¨ç¨‹åºä¸­åŒ…å«çš„äº§å“åŒ…ã€‚ä»…é€‰æ‹©SnapKitå°±è¶³ä»¥æ»¡è¶³æˆ‘ä»¬çš„ç›®çš„ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/2bd55c975bc28d4b20c598e16b49c359.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PTTT6Gpo3aBwV6cx"/></div></div></figure><p id="d555" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨ä½ å¯ä»¥åœ¨é¡¹ç›®å¯¼èˆªå™¨çš„<code class="fe mh mi mj mk b">PackageDependencies</code>ä¸­çœ‹åˆ°SnapKitã€‚è®©æˆ‘ä»¬ç»§ç»­ä¸ºé¡¹ç›®åˆ›å»ºæ–‡ä»¶å¤¹ç»“æ„ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/6b96d98131d6750091267ff798bb2895.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pPlb7NGYayvs1-aM"/></div></div></figure><p id="ed78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨å¼€å§‹å¼€å‘ä¹‹å‰ï¼Œæˆ‘åˆ›å»ºäº†ä¸€äº›æ–‡ä»¶å¤¹æ¥ç»„ç»‡æˆ‘ä»¬çš„é¡¹ç›®ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ç¬¬ä¸€é¡µï¼Œå®ƒåˆ—å‡ºäº†æˆ‘ä»¬åœ¨<code class="fe mh mi mj mk b">tableview</code>ä¸­çš„èŠ±è´¹ã€‚ç”±äºæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ª<code class="fe mh mi mj mk b">UITableView</code>ï¼Œæˆ‘è®¤ä¸ºä»è®¾è®¡è¡¨æ ¼è§†å›¾çš„å•å…ƒæ ¼å¼€å§‹æ˜¯ä¸€ä¸ªå¥½æ–¹æ³•ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="94fe" class="mp mq iq mk b gy mr ms l mt mu">import UIKit<br/>import SnapKit<br/>class ExpenseListTableViewCell: UITableViewCell {<br/>    static let identifier = "ExpenseListTableViewCell"<br/>    <br/>    var expense: Expense? {<br/>        didSet {<br/>            self.configure()<br/>        }<br/>    }<br/>    <br/>    private lazy var stackView: UIStackView = {<br/>        let stackView = UIStackView()<br/>        stackView.layoutMargins = UIEdgeInsets(top: 0, left: 20, bottom: 0, right: 20)<br/>        stackView.isLayoutMarginsRelativeArrangement = true<br/>        stackView.axis = .horizontal<br/>        return stackView<br/>    }()<br/>    <br/>    private lazy var tailStackView: UIStackView = {<br/>        let stackView = UIStackView()<br/>        stackView.spacing = 50<br/>        return stackView<br/>    }()<br/>    <br/>    private lazy var titleLabel: UILabel = {<br/>        let label = UILabel()<br/>        return label<br/>    }()<br/>    <br/>    private lazy var dateLabel: UILabel = {<br/>        let label = UILabel()<br/>        label.textAlignment = .right<br/>        return label<br/>    }()<br/>    <br/>    private lazy var priceLabel: UILabel = {<br/>        let label = UILabel()<br/>        return label<br/>    }()<br/>    <br/>    private func configure(){<br/>        self.titleLabel.text = expense?.title.shorted(to: 15)<br/>        self.dateLabel.text = expense?.formattedDate<br/>        let price = expense?.price ?? 0<br/>        self.priceLabel.text = "$ \(price)"<br/>        setupConsts()<br/>    }<br/>    <br/>    override init(style: UITableViewCell.CellStyle, reuseIdentifier: String?) {<br/>        super.init(style: style, reuseIdentifier: reuseIdentifier)<br/>    }<br/>    <br/>    required init?(coder: NSCoder) {<br/>        fatalError("init(coder:) has not been implemented")<br/>    }<br/>    <br/>    private func setupConsts(){<br/>        tailStackView.addArrangedSubview(dateLabel)<br/>        tailStackView.addArrangedSubview(priceLabel)<br/>        priceLabel.snp.makeConstraints { $0.width.equalTo(70) }<br/>        stackView.addArrangedSubview(titleLabel)<br/>        stackView.addArrangedSubview(tailStackView)<br/>        contentView.addSubview(stackView)<br/>        stackView.snp.makeConstraints { $0.edges.equalToSuperview() }<br/>    }<br/>}</span></pre><p id="f7e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å°†ä¸Šé¢çš„ä»£ç ç²˜è´´åˆ°ä¸€ä¸ªåä¸º<code class="fe mh mi mj mk b">ExpenseListTableViewCell</code> .swiftçš„æ–‡ä»¶ä¸­ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸ºexpenseçš„å±æ€§ï¼Œå®ƒä»£è¡¨ä¸€ä¸ª<code class="fe mh mi mj mk b">Expense</code>ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ¨¡å‹ã€‚å½“è¯¥è´¹ç”¨è¢«è®¾ç½®ä¸ºç”¨è¯¥å±æ€§çš„å†…å®¹å¡«å……è§†å›¾æ—¶ï¼Œæˆ‘ä»¬è¿è¡Œé…ç½®åŠŸèƒ½ã€‚è®©æˆ‘ä»¬ä¹Ÿå°†è´¹ç”¨ç»“æ„æ·»åŠ åˆ°<code class="fe mh mi mj mk b">Models</code>æ–‡ä»¶å¤¹ä¸­ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="9d2c" class="mp mq iq mk b gy mr ms l mt mu">struct Expense {<br/>    let title: String<br/>    let date: Date<br/>    let price: Double<br/>    var formattedDate: String {<br/>        let formatter = DateFormatter()<br/>        formatter.dateFormat = "MM-dd HH:mm"<br/>        return formatter.string(from: date)<br/>    }<br/>}</span></pre><p id="fb36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬çš„<code class="fe mh mi mj mk b">Expense</code>æ¨¡å‹ç°åœ¨ç”±ä¸‰ä¸ªå­˜å‚¨çš„å’Œä¸€ä¸ªè®¡ç®—çš„å±æ€§ç»„æˆã€‚</p><p id="16cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®©æˆ‘ä»¬å°†é»˜è®¤çš„<code class="fe mh mi mj mk b">ViewController</code>é‡å‘½åä¸º<code class="fe mh mi mj mk b">ExpenseListViewController</code>ï¼Œå¹¶å¼€å§‹æ·»åŠ æˆ‘ä»¬çš„è¡¨æ ¼è§†å›¾ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="556c" class="mp mq iq mk b gy mr ms l mt mu">class ExpenseListViewController: UIViewController {<br/>    <br/>    let viewModel: ExpenseListViewModel<br/>    <br/>    private lazy var tableView: UITableView = {<br/>        let tableView = UITableView()<br/>        return tableView<br/>    }()<br/>    <br/>    init(context: NSManagedObjectContext) {<br/>        self.viewModel = ExpenseListViewModel(context: context)<br/>        super.init(nibName: nil, bundle: nil)<br/>    }<br/>    required init?(coder: NSCoder) {<br/>        fatalError("init(coder:) has not been implemented")<br/>    }<br/>    override func viewDidLoad() {<br/>        super.viewDidLoad()<br/>        view.addSubview(tableView)<br/>        tableView.delegate = self<br/>        tableView.dataSource = self<br/>        tableView.register(ExpenseListTableViewCell.self, forCellReuseIdentifier: ExpenseListTableViewCell.identifier)<br/>        configureNavigationBar()<br/>    }<br/>    <br/>    override func viewDidLayoutSubviews() {<br/>        super.viewDidLayoutSubviews()<br/>        tableView.frame = view.bounds<br/>    }<br/>    private func configureNavigationBar(){<br/>        self.title = "Expenses"<br/>        let titleTextAttrs = [NSAttributedString.Key.foregroundColor: UIColor.black]<br/>        navigationController?.navigationBar.titleTextAttributes = titleTextAttrs<br/>        navigationController?.navigationBar.prefersLargeTitles = true<br/>        navigationItem.rightBarButtonItem = UIBarButtonItem(barButtonSystemItem: .add, target: self, action: #selector(didTapAddExpense))<br/>    }<br/>    @objc private func didTapAddExpense(){<br/>    <br/><br/>    }<br/>}</span><span id="1dc7" class="mp mq iq mk b gy my ms l mt mu">extension ExpenseListViewController: UITableViewDelegate, UITableViewDataSource {<br/>    <br/>    func numberOfSections(in tableView: UITableView) -&gt; Int {<br/>        1<br/>    }<br/>    <br/>    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int {<br/>        1<br/>    }<br/>    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell {<br/>        UITableViewCell()<br/>    }<br/>    func tableView(_ tableView: UITableView, viewForHeaderInSection section: Int) -&gt; UIView? {<br/>        nil<br/>    }<br/>    func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -&gt; CGFloat {<br/>        50<br/>    }<br/>    func tableView(_ tableView: UITableView, heightForHeaderInSection section: Int) -&gt; CGFloat {<br/>        40<br/>    }<br/>    func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {<br/>        <br/>    }<br/>}</span></pre><p id="a2cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å°†ä¸Šé¢çš„ä»£ç ç²˜è´´åˆ°è§†å›¾æ§åˆ¶å™¨ä¸­ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºè¡¨æ ¼è§†å›¾ï¼Œè®¾ç½®å…¶çº¦æŸï¼Œæ³¨å†Œå•å…ƒæ ¼ï¼Œå¹¶é€šè¿‡æ·»åŠ åŠ å·æŒ‰é’®æ¥é…ç½®æˆ‘ä»¬çš„å¯¼èˆªæ ï¼Œä»¥ä¾¿ç¨åæ·»åŠ æ–°çš„è´¹ç”¨ã€‚</p><p id="c1da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†å¯åŠ¨è¡¨è§†å›¾æ•°æ®æºå’Œå§”æ‰˜åŠŸèƒ½ï¼Œæˆ‘ä»¬è¿˜å°†ä¸ºä¸Šé¢çš„è§†å›¾æ§åˆ¶å™¨åˆ›å»ºä¸€ä¸ªæ‰©å±•ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="3261" class="mp mq iq mk b gy mr ms l mt mu">struct ExpenseListViewModel {<br/>    <br/>    var expenseList = [Expense]()<br/>}</span></pre><p id="763f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬çš„è§†å›¾æ¨¡å‹ç›®å‰è¿˜å¾ˆåŸºæœ¬ï¼Œä½†æ˜¯æˆ‘ä»¬ä»¥åä¼šæ”¹è¿›å®ƒã€‚ç°åœ¨è®©æˆ‘ä»¬å°†ä¸€ä¸ªè§†å›¾æ¨¡å‹å®ä¾‹æ·»åŠ åˆ°è§†å›¾æ§åˆ¶å™¨ä¸­ã€‚å¹¶å¡«å……ä¸€äº›è¡¨è§†å›¾å§”æ‰˜å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="e47a" class="mp mq iq mk b gy mr ms l mt mu">func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int {<br/>        viewModel.expenseList.count<br/>    }</span><span id="427b" class="mp mq iq mk b gy my ms l mt mu">    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell {<br/>        guard let cell = tableView.dequeueReusableCell(withIdentifier: ExpenseListTableViewCell.identifier, for: indexPath) as? ExpenseListTableViewCell else { return UITableViewCell() }<br/>        cell.expense = viewModel.expenseList[indexPath.row]<br/>        return cell<br/>    }</span><span id="168b" class="mp mq iq mk b gy my ms l mt mu">    func tableView(_ tableView: UITableView, viewForHeaderInSection section: Int) -&gt; UIView? {<br/>        let stackView = UIStackView()<br/>        stackView.axis = .horizontal<br/>        stackView.backgroundColor = .systemGray<br/>        stackView.layoutMargins = UIEdgeInsets(top: 0, left: 20, bottom: 0, right: 20)<br/>        stackView.isLayoutMarginsRelativeArrangement = true<br/>        let titleLabel = UILabel()<br/>        titleLabel.text = "Title"<br/>        let tailStackView = UIStackView()<br/>        tailStackView.spacing = 100<br/>        let dateLabel = UILabel()<br/>        dateLabel.text = "Date"<br/>        let priceLabel = UILabel()<br/>        priceLabel.text = "Price"<br/>        stackView.addArrangedSubview(titleLabel)<br/>        tailStackView.addArrangedSubview(dateLabel)<br/>        tailStackView.addArrangedSubview(priceLabel)<br/>        stackView.addArrangedSubview(tailStackView)<br/>        return stackView<br/>    }</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/69fa9310c16b06c53d653d25edad3f9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/format:webp/1*2suN2G4QgcI9qYqG9Mz7ww.png"/></div></figure><p id="6a0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçœ‹èµ·æ¥åƒè¿™æ ·ã€‚ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºåˆ›å»ºå’Œç¼–è¾‘è´¹ç”¨é¡µé¢ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="128c" class="mp mq iq mk b gy mr ms l mt mu">import UIKit<br/><br/>protocol AddUpdateExpanseDelegate: AnyObject {<br/>    func addNewExpanse(title: String, date: Date, price: Double)<br/>    func updateExpanse(with expense: Expense)<br/>}<br/><br/>public enum AddEditExpenseMode {<br/>    case update<br/>    case add<br/>}<br/><br/>class AddUpdateExpenseViewController: UIViewController {<br/>    private let mode: AddEditExpenseMode<br/>    private let expense: Expense?<br/>    <br/>    weak var delegate: AddUpdateExpanseDelegate?<br/>    <br/>    private lazy var titleTextField: UITextField = {<br/>        let textField = UITextField()<br/>        textField.attributedPlaceholder = NSAttributedString(string: "Title...", attributes: [NSAttributedString.Key.foregroundColor: UIColor.lightGray])<br/>        textField.leftView = UIView(frame: CGRect(x: 0, y: 0, width: 10, height: 0))<br/>        textField.leftViewMode = .always<br/>        textField.layer.borderWidth = 1<br/>        textField.layer.borderColor = UIColor.lightGray.cgColor<br/>        textField.layer.cornerRadius = 12<br/>        textField.returnKeyType = .continue<br/>        return textField<br/>    }()<br/>    <br/>    private lazy var priceTextField: UITextField = {<br/>        let textField = UITextField()<br/>        textField.attributedPlaceholder = NSAttributedString(string: "Amount...", attributes: [NSAttributedString.Key.foregroundColor: UIColor.lightGray])<br/>        textField.leftView = UIView(frame: CGRect(x: 0, y: 0, width: 10, height: 0))<br/>        textField.leftViewMode = .always<br/>        textField.layer.borderWidth = 1<br/>        textField.layer.borderColor = UIColor.lightGray.cgColor<br/>        textField.layer.cornerRadius = 12<br/>        textField.keyboardType = .decimalPad<br/>        textField.returnKeyType = .done<br/>        return textField<br/>    }()<br/>    <br/>    private lazy var dateStackView: UIStackView = {<br/>        let stackView = UIStackView()<br/>        stackView.layer.borderWidth = 1<br/>        stackView.layer.borderColor = UIColor.lightGray.cgColor<br/>        stackView.layer.cornerRadius = 12<br/>        stackView.layoutMargins = UIEdgeInsets(top: 0, left: 10, bottom: 0, right: 10)<br/>        stackView.isLayoutMarginsRelativeArrangement = true<br/>        return stackView<br/>    }()<br/>    <br/>    private lazy var dateLabel: UILabel = {<br/>        let label = UILabel()<br/>        label.text = "Date"<br/>        label.textColor = .lightGray<br/>        return label<br/>    }()<br/>    <br/>    <br/>    private lazy var datePicker: UIDatePicker = {<br/>        let datePicker = UIDatePicker(frame: .zero)<br/>        datePicker.datePickerMode = .dateAndTime<br/>        datePicker.timeZone = TimeZone.current<br/>        return datePicker<br/>    }()<br/>    <br/>    private lazy var addUpdateButton: UIButton = {<br/>        let button = UIButton()<br/>        button.setTitle(self.mode == .add ? "Add Expense" : "Save Changes", for: .normal)<br/>        button.setTitleColor(.white, for: .normal)<br/>        button.backgroundColor = .systemPurple<br/>        button.contentEdgeInsets = UIEdgeInsets(top: 8, left: 12, bottom: 8, right: 12)<br/>        button.layer.borderWidth = 1<br/>        button.layer.borderColor = UIColor.lightGray.cgColor<br/>        button.layer.cornerRadius = 8<br/>        button.addTarget(self, action: #selector(didTapButton), for: .touchUpInside)<br/>        return button<br/>    }()<br/>    <br/>    init(mode: AddEditExpenseMode, expense: Expense?) {<br/>        self.mode = mode<br/>        self.expense = expense<br/>        super.init(nibName: nil, bundle: nil)<br/>    }<br/>    <br/>    required init?(coder: NSCoder) {<br/>        fatalError("init(coder:) has not been implemented")<br/>    }<br/>    <br/>    override func viewDidLoad() {<br/>        super.viewDidLoad()<br/>        self.hideKeyboardWhenTappedAround()<br/>        configureNavigationBar()<br/>        view.backgroundColor = .systemBackground<br/>        titleTextField.delegate = self<br/>        priceTextField.delegate = self<br/>        titleTextField.becomeFirstResponder()<br/>        addSubviews()<br/>    }<br/>    <br/>    <br/>    private func configureNavigationBar(){<br/>        self.title = self.mode == .add ? "Add Expense" : "Update Expense"<br/>        let titleTextAttrs = [NSAttributedString.Key.foregroundColor: UIColor.label]<br/>        navigationController?.navigationBar.titleTextAttributes = titleTextAttrs<br/>        navigationController?.navigationBar.prefersLargeTitles = true<br/>    }<br/>    <br/>    private func addSubviews(){<br/>        view.addSubview(titleTextField)<br/>        view.addSubview(priceTextField)<br/>        dateStackView.addArrangedSubview(dateLabel)<br/>        dateStackView.addArrangedSubview(datePicker)<br/>        view.addSubview(dateStackView)<br/>        view.addSubview(addUpdateButton)<br/>        guard let expense = self.expense, self.mode == .update else { return }<br/>        fillFields(with: expense)<br/>    }<br/>    <br/>    private func fillFields(with expense: Expense){<br/>        self.titleTextField.text = expense.title<br/>        self.priceTextField.text = String(expense.price)<br/>        self.datePicker.date = expense.date<br/>    }<br/>    <br/>    override func viewDidLayoutSubviews() {<br/>        titleTextField.snp.makeConstraints { make in<br/>            make.top.equalToSuperview().offset(200)<br/>            make.leading.equalToSuperview().offset(50)<br/>            make.trailing.equalToSuperview().inset(50)<br/>            make.height.equalTo(52)<br/>        }<br/>        priceTextField.snp.makeConstraints { make in<br/>            make.leading.trailing.equalTo(titleTextField)<br/>            make.top.equalTo(titleTextField.snp.bottom).offset(20)<br/>            make.height.equalTo(52)<br/>        }<br/>        <br/>        dateStackView.snp.makeConstraints { make in<br/>            make.leading.trailing.equalTo(titleTextField)<br/>            make.top.equalTo(priceTextField.snp.bottom).offset(20)<br/>            make.height.equalTo(52)<br/>        }<br/>        <br/>        addUpdateButton.snp.makeConstraints { make in<br/>            make.trailing.equalTo(titleTextField)<br/>            make.top.equalTo(dateStackView.snp.bottom).offset(20)<br/>        }<br/>    }<br/>    <br/>    @objc private func didTapButton(){<br/>        guard let priceText = priceTextField.text,<br/>              let price = Double(priceText),<br/>              let title = titleTextField.text else { return }<br/>        let date = datePicker.date<br/>        if self.mode == .add {<br/>            delegate?.addNewExpanse(title: title, date: date, price: price)<br/>        } else {<br/>            let newExpense = Expense(title: title, date: date, price: price)<br/>            delegate?.updateExpanse(with: newExpense)<br/>        }<br/>        self.dismiss(animated: true)<br/>    }<br/>    <br/>}<br/>extension AddUpdateExpenseViewController: UITextFieldDelegate {<br/>    func textFieldShouldReturn(_ textField: UITextField) -&gt; Bool {<br/>        if textField == titleTextField {<br/>            priceTextField.becomeFirstResponder()<br/>        } else if textField == priceTextField {<br/>            view.endEditing(true)<br/>            <br/>        }<br/>        return true<br/>    }<br/>}</span></pre><p id="cc89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬å°†é€šè¿‡modeå‚æ•°åœ¨åŒä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨ä¸­å¤„ç†æ·»åŠ å’Œæ›´æ–°æ“ä½œã€‚æˆ‘ä»¬å°†ä½¿ç”¨<code class="fe mh mi mj mk b">AddUpdateExpanseDelegate</code>åè®®æ¥è§¦å‘æ·»åŠ å’Œç¼–è¾‘æ“ä½œã€‚</p><p id="e4bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç”±äºæˆ‘ä»¬çš„ç”¨æˆ·ç•Œé¢å·²ç»æ¥è¿‘å®Œæˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºæ ¸å¿ƒæ•°æ®å®ä½“æ¨¡å‹åŠå…¶é…ç½®æ–‡ä»¶ã€‚æ‰“å¼€<code class="fe mh mi mj mk b">HarcaMA.xcdatamodeld</code>æ–‡ä»¶å¹¶ç‚¹å‡»ä¸‹æ–¹çš„<code class="fe mh mi mj mk b">Add Entity</code>æŒ‰é’®ã€‚å°†å®ä½“å‘½åä¸º<code class="fe mh mi mj mk b">ExpenseItem</code>ï¼Œå¹¶æ·»åŠ å…·æœ‰å…¼å®¹æ•°æ®ç±»å‹çš„å±æ€§ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ­¤å¤–ï¼Œä»æ•°æ®æ¨¡å‹æ£€æŸ¥å™¨ä¸­é€‰æ‹©æ‰‹åŠ¨ä»£ç ç”Ÿæˆé€‰é¡¹ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/b1b8b56e84c4adb51f56e7b97eb9cb69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2hykb2iYxGosqOVy"/></div></div></figure><p id="d7ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å½“æ‚¨åœ¨Xcodeä¸­é€‰æ‹©<code class="fe mh mi mj mk b">datamodel</code>æ–‡ä»¶æ—¶ï¼Œè¿›å…¥ç¼–è¾‘å™¨å¹¶é€‰æ‹©<code class="fe mh mi mj mk b">Create NSManagedObject Subclass</code>é€‰é¡¹ã€‚å½“æ‚¨é€‰æ‹©å®ä½“æ¨¡å‹å¹¶é€‰æ‹©createæ—¶ï¼ŒXcodeå°†ä¸º<code class="fe mh mi mj mk b">Entity</code>åˆ›å»º<code class="fe mh mi mj mk b">CoreDataClass</code>ï¼Œä»¥åŠä¸€ä¸ªåŒ…å«å…¶å±æ€§çš„æ‰©å±•æ–‡ä»¶ã€‚</p><p id="637e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨è¿™äº›æ­¥éª¤ä¹‹åï¼Œå¦‚æœæ‚¨æˆåŠŸåœ°æ„å»ºäº†æ‚¨çš„é¡¹ç›®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­åˆ›å»ºæˆ‘ä»¬çš„æœåŠ¡ç»“æ„ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="84a7" class="mp mq iq mk b gy mr ms l mt mu">struct ExpenseService {<br/>    <br/>    let context: NSManagedObjectContext<br/>    <br/>    init(context: NSManagedObjectContext) {<br/>        self.context = context<br/>    }<br/>    <br/>    public func fetchExpenseItems(completion: @escaping (Result&lt;[ExpenseItem], ExpenseServiceErrors&gt;) -&gt; (Void)){<br/>        do {<br/>            let items = try context.fetch(ExpenseItem.fetchRequest())<br/>            completion(.success(items))<br/>        } catch  {<br/>            completion(.failure(.fetchError))<br/>        }<br/>    }<br/>    <br/>    public func addExpenseItem(title: String, date: Date, price: Double, completion: @escaping (Bool) -&gt; (Void)){<br/>        let newItem = ExpenseItem(context: context)<br/>        newItem.title = title<br/>        newItem.date = date<br/>        newItem.price = price<br/>        do {<br/>            try context.save()<br/>            completion(true)<br/>        } catch  {<br/>            completion(false)<br/>        }<br/>    }<br/>    <br/>    public func updateExpenseItem(with newExpense: Expense, completion: @escaping (Bool) -&gt; (Void)){<br/>        guard let prevExpense = context.object(with: newExpense.id) as? ExpenseItem else {<br/>            completion(false)<br/>            return<br/>        }<br/>        prevExpense.title = newExpense.title<br/>        prevExpense.date = newExpense.date<br/>        prevExpense.price = newExpense.price<br/>        do {<br/>            try context.save()<br/>            completion(true)<br/>        } catch  {<br/>            completion(false)<br/>        }<br/>    }<br/>    <br/>    public func deleteExpenseItem(with id: NSManagedObjectID, completion: @escaping (Bool) -&gt; (Void)){<br/>        guard let expense = context.object(with: id) as? ExpenseItem else {<br/>            completion(false)<br/>            return<br/>        }<br/>        context.delete(expense)<br/>        do {<br/>            try context.save()<br/>            completion(true)<br/>        } catch  {<br/>            completion(false)<br/>        }<br/>    }<br/>    <br/>    public func totalExpenseAmount() -&gt; Double? {<br/>        do {<br/>            let items = try context.fetch(ExpenseItem.fetchRequest())<br/>            let total = items.reduce(0) { $0 + $1.price }<br/>            return total<br/>        } catch  {<br/>            return nil<br/>        }<br/>    }<br/>}<br/><br/>public enum ExpenseServiceErrors: Error {<br/>    case fetchError<br/>}</span></pre><p id="bcac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬çš„æœåŠ¡åœ¨<code class="fe mh mi mj mk b">ExpenseItem</code>å®ä½“ä¸Šæœ‰åŸºæœ¬çš„CRUDæ“ä½œã€‚ä¸ºäº†å®‰å…¨åœ°æ‰§è¡Œè¿™äº›æ“ä½œï¼Œæˆ‘ä»¬è¿˜åœ¨è´¹ç”¨æ¨¡å‹ä¸­æ·»åŠ äº†ä¸€ä¸ªç±»å‹ä¸º<code class="fe mh mi mj mk b">NSManagedObjectID</code>çš„idå‚æ•°ï¼Œå®ƒæ˜¯ä¸ºæ¯ä¸ªæ¡ç›®è‡ªåŠ¨ç”Ÿæˆçš„ã€‚</p><p id="f639" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨æˆ‘ä»¬éœ€è¦ä¿®æ”¹æˆ‘ä»¬çš„è§†å›¾æ¨¡å‹ï¼Œä»¥åˆ©ç”¨æˆ‘ä»¬æœåŠ¡ä¸­çš„å‡½æ•°ã€‚ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢è§†å›¾æ¨¡å‹çš„å†…å®¹ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="1236" class="mp mq iq mk b gy mr ms l mt mu">class ExpenseListViewModel {<br/>    <br/>    var expenseList = [Expense]()<br/>    let service: ExpenseService<br/>    <br/>    init(context: NSManagedObjectContext) {<br/>        self.service = ExpenseService(context: context)<br/>        fetchExpenses(completion: nil)<br/>    }<br/>    <br/>    public func fetchExpenses(completion: (() -&gt; Void)?){<br/>        service.fetchExpenseItems {[weak self] result in<br/>            switch result {<br/>            case .success(let expenses):<br/>                self?.expenseList = expenses.map { Expense(id: $0.objectID, title: $0.title, date: $0.date, price: $0.price) }<br/>                completion?()<br/>            case .failure(_):<br/>                print("error")<br/>            }<br/>        }<br/>    }<br/>    <br/>    public func addExpense(title: String, date: Date, price: Double, completion: @escaping () -&gt; Void){<br/>        service.addExpenseItem(title: title, date: date, price: price) {[weak self] success in<br/>            if success {<br/>                self?.fetchExpenses(completion: completion)<br/>            }<br/>        }<br/>    }<br/>    <br/>    public func deleteExpense(id: NSManagedObjectID, completion: @escaping () -&gt; Void){<br/>        service.deleteExpenseItem(with: id) {[weak self] success in<br/>            if success {<br/>                self?.fetchExpenses(completion: completion)<br/>            }<br/>        }<br/>    }<br/>    <br/>    public func updateExpense(with newExpense: Expense, completion: @escaping () -&gt; Void){<br/>        service.updateExpenseItem(with: newExpense) {[weak self] success in<br/>            if success {<br/>                self?.fetchExpenses(completion: completion)<br/>            }<br/>        }<br/>    }<br/>    <br/>}</span></pre><p id="cebf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç„¶åï¼Œæˆ‘ä»¬å°†å‘ExpenseListViewControlleræ·»åŠ å¦ä¸€ä¸ªæ‰©å±•ï¼Œå¹¶éµå¾ªæˆ‘ä»¬çš„åè®®ã€‚å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°viewcontrollerç±»ä¸­ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="6c97" class="mp mq iq mk b gy mr ms l mt mu">extension ExpanseListViewController: AddUpdateExpanseDelegate {<br/>    func updateExpanse(with expense: Expense) {<br/>        viewModel.updateExpense(with: expense) {[weak self] in<br/>            self?.tableView.reloadData()<br/>        }<br/>    }<br/>    <br/>    func addNewExpanse(title: String, date: Date, price: Double) {<br/>        viewModel.addExpense(title: title, date: date, price: price) {[weak self] in<br/>            self?.tableView.reloadData()<br/>        }<br/>    }<br/>}</span></pre><p id="c3bc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç„¶åæ”¹å˜<code class="fe mh mi mj mk b">didSelectRowAt</code>åŠŸèƒ½çš„å†…å®¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="6e6d" class="mp mq iq mk b gy mr ms l mt mu">func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {<br/>        tableView.deselectRow(at: indexPath, animated: true)<br/>        showAlertSheet(for: viewModel.expenseList[indexPath.row])<br/>        <br/>    }<br/>    <br/>    private func showAlertSheet(for expense: Expense){<br/>        let alert = UIAlertController(title: "What to do with this expense?", message: expense.title, preferredStyle: .actionSheet)<br/>        let deleteAction = UIAlertAction(title: "Delete", style: .destructive) {[weak self] _ in<br/>            guard let strongSelf = self else { return }<br/>            strongSelf.viewModel.deleteExpense(id: expense.id) {<br/>                strongSelf.tableView.reloadData()<br/>            }<br/>        }<br/>        let editAction = UIAlertAction(title: "Edit", style: .default) { [weak self] _ in<br/>            guard let strongSelf = self else { return }<br/>            let vc = AddUpdateExpenseViewController(mode: .update, expense: expense)<br/>            vc.delegate = strongSelf<br/>            strongSelf.present(UINavigationController(rootViewController: vc), animated: true)<br/>        }<br/>        alert.addAction(UIAlertAction(title: "Dismiss", style: .cancel))<br/>        alert.addAction(editAction)<br/>        alert.addAction(deleteAction)<br/>        present(alert, animated: true)<br/>    }</span></pre><p id="2648" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ­å–œğŸ‰ã€‚ç°åœ¨æ‚¨æœ‰äº†ä¸€ä¸ªæ¼‚äº®çš„è´¹ç”¨è·Ÿè¸ªåº”ç”¨ç¨‹åºã€‚ç°åœ¨è®©æˆ‘ä»¬è·³è½¬åˆ°æœ¬æ–‡çš„ä¸»ä½“éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯<code class="fe mh mi mj mk b">AppIntents</code>ã€‚</p><h1 id="d128" class="nb mq iq bd nc nd ne nf ng nh ni nj nk jw nl jx nm jz nn ka no kc np kd nq nr bi translated">å°†åº”ç”¨æ„å›¾é›†æˆåˆ°åº”ç”¨ä¸­</h1><p id="6827" class="pw-post-body-paragraph kw kx iq ky b kz ns jr lb lc nt ju le lf nu lh li lj nv ll lm ln nw lp lq lr ij bi translated">åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªä¸åŒçš„åº”ç”¨ç¨‹åºæ„å›¾ã€‚</p><p id="9c01" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å…¶ä¸­ä¹‹ä¸€æ˜¯æ·»åŠ æ–°çš„è´¹ç”¨è®°å½•ã€‚</p><p id="0165" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦ä¸€ä¸ªæ˜¯å¾—åˆ°æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢çš„æ€»æ”¯å‡ºã€‚</p><p id="e9f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™äº›åŠŸèƒ½å¯ä»¥ä»å¿«æ·æ–¹å¼åº”ç”¨ç¨‹åºã€Spotlightå’ŒSiriä¸­è®¿é—®ã€‚è®©æˆ‘ä»¬ä»åˆ›å»ºç¬¬äºŒä¸ªæ„å›¾å¼€å§‹ã€‚</p><p id="1c5c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿›å…¥<code class="fe mh mi mj mk b">Intents</code>æ–‡ä»¶å¤¹ï¼Œæ–°å»ºä¸€ä¸ªåä¸º<code class="fe mh mi mj mk b">ShowTotalExpense.swift</code>çš„Swiftæ–‡ä»¶ï¼Œå¯¼å…¥<code class="fe mh mi mj mk b">AppIntents</code>æ¡†æ¶ã€‚</p><p id="343e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä»»ä½•æ„å›¾éƒ½å¯ä»¥é€šè¿‡éµå®ˆä¸€ä¸ªå«åš<code class="fe mh mi mj mk b">AppIntent</code>çš„åè®®æ¥åˆ›å»ºã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="f301" class="mp mq iq mk b gy mr ms l mt mu">import AppIntents<br/><br/>struct ShowTotalExpense: AppIntent {<br/>    static var title: LocalizedStringResource = ""<br/>    func perform() async throws -&gt; some IntentResult {<br/>           return .result()<br/>    }<br/>}</span></pre><p id="ed07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¯ä»¥ç”¨è¿™ä¸¤ä¸ªå‚æ•°åˆ›å»ºæ„å›¾ï¼Œè¿™ä¸¤ä¸ªå‚æ•°æ˜¯titleå’Œä»¥æœ€ç®€å•çš„å½¢å¼æ‰§è¡ŒåŠŸèƒ½ã€‚å¦‚æœæ‚¨çš„performå‡½æ•°éœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œæ‚¨å¯ä»¥é€šè¿‡æ·»åŠ <code class="fe mh mi mj mk b">@MainActor</code>æ³¨é‡Šæ¥å®ç°ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="cd9e" class="mp mq iq mk b gy mr ms l mt mu">@MainActor<br/>func perform() async throws -&gt; some IntentResult {<br/>    print("You know, I am doing something on the main thread...")<br/>    return .result()<br/>}</span></pre><p id="9022" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ ‡é¢˜å‚æ•°æ˜¯å¿«æ·æ–¹å¼ç¼–è¾‘å™¨ä¸­æ˜¾ç¤ºçš„å‚æ•°ã€‚æ‚¨å¯ä»¥å°†å…¶è®¾ç½®ä¸ºé™æ€å€¼ï¼Œæˆ–è€…å°†å…¶è®¾ç½®ä¸ºæ³¨å†Œåˆ°å¯æœ¬åœ°åŒ–æ–‡ä»¶ä¸­çš„æœ¬åœ°åŒ–é”®ï¼Œå¹¶ä½¿ç”¨è¯¥é”®çš„å€¼ã€‚</p><p id="d275" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†é¿å…è¿™ç¯‡æ–‡ç« å¤ªé•¿ï¼Œæˆ‘ä»¬å°†ä¸è®¨è®ºæœ¬åœ°åŒ–æ­¥éª¤ï¼Œä½†æ˜¯æ‚¨å¯ä»¥æ‰¾åˆ°å¤§é‡çš„èµ„æºæ¥è§£é‡Šå¦‚ä½•ä¸ºæ‚¨çš„iOSåº”ç”¨ç¨‹åºæ·»åŠ æœ¬åœ°åŒ–æ”¯æŒã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="facb" class="mp mq iq mk b gy mr ms l mt mu">struct ShowTotalExpense: AppIntent {<br/>    static var title: LocalizedStringResource = "Show my total expense"<br/>    <br/>    func perform() async throws -&gt; some IntentResult &amp; ProvidesDialog {<br/>        let total = await getTotalExpanse()<br/>        let dialog = IntentDialog(total)<br/>        return .result(dialog: dialog)<br/>    }<br/>    <br/>    private func getTotalExpanse() async -&gt; LocalizedStringResource {<br/>        let service = await ExpenseService(context: (UIApplication.shared.delegate as! AppDelegate).persistentContainer.viewContext)<br/>        guard let total = service.totalExpenseAmount() else { return LocalizedStringResource(stringLiteral: "0") }<br/>        return LocalizedStringResource(stringLiteral: String(format: "%2.f", total))<br/>    }<br/>}</span></pre><p id="9999" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬çš„æ„å›¾çš„æœ€ç»ˆå¤–è§‚å°†å¦‚ä¸Šæ‰€ç¤ºã€‚æˆ‘ä»¬è¿è¡Œä¸€ä¸ªæœåŠ¡å‡½æ•°æ¥è·å–æ€»è´¹ç”¨å¹¶è¿”å›å®ƒã€‚æœ€åï¼Œæˆ‘ä»¬æä¾›ä¸€ä¸ªå¯¹è¯æ¡†ä½œä¸ºè¿è¡Œè¿™ä¸ªæ„å›¾çš„ç»“æœã€‚</p><p id="5623" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœä½ ç”¨è¿™æ®µä»£ç è¿è¡Œä½ çš„åº”ç”¨ç¨‹åºï¼Œä½ ä¸ä¼šçœ‹åˆ°ä¸ºä½ çš„åº”ç”¨ç¨‹åºåˆ›å»ºçš„å¿«æ·æ–¹å¼ï¼Œä¹Ÿä¸ä¼šåœ¨èšå…‰ç¯ä¸‹æ‰¾åˆ°å®ƒï¼Œå› ä¸ºæˆ‘ä»¬è¿˜åº”è¯¥å‘Šè¯‰ç³»ç»Ÿå“ªä¸ª<code class="fe mh mi mj mk b">AppIntents</code>å¯¹ç”¨æˆ·å¯ç”¨ï¼Œå¹¶é…ç½®è¿™äº›æ„å›¾ã€‚</p><p id="043d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†ä¿æŒé¡¹ç›®çš„æ¨¡å—åŒ–ï¼Œè®©æˆ‘ä»¬åœ¨Intentsæ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„swiftæ–‡ä»¶å¹¶å‘½åä¸º<code class="fe mh mi mj mk b">HarcaMAShortCuts.swift</code>ã€‚è¯¥æ–‡ä»¶å°†åŒ…å«ä¸€ä¸ªç¬¦åˆAppShortcutsProvideråè®®çš„ç»“æ„ï¼Œå¹¶å°†æˆä¸ºå¿«æ·æ–¹å¼çš„ä¸»æ¡ç›®ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="8dad" class="mp mq iq mk b gy mr ms l mt mu">struct HarcaMAShortCuts: AppShortcutsProvider {<br/>    static var appShortcuts: [AppShortcut] {<br/>        AppShortcut(<br/>            intent: ShowTotalExpense(),<br/>            phrases: [<br/>                "What is my total expense in \(.applicationName)?",<br/>                "Show my total expense in \(.applicationName)",<br/>                "How much did I spend in \(.applicationName)?"<br/>            ]<br/>        )<br/>    }<br/>}</span></pre><p id="24be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¯¥ç»“æ„æœ‰ä¸€ä¸ªåä¸º<code class="fe mh mi mj mk b">appShortcuts</code>çš„é™æ€å±æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»å‹ä¸º<code class="fe mh mi mj mk b">AppShortcut</code>çš„æ•°ç»„ã€‚è¯·è®°ä½ï¼Œç›®å‰æˆ‘ä»¬é™åˆ¶ä¸€ä¸ªiOSåº”ç”¨ç¨‹åºæœ€å¤šæœ‰10ä¸ªåº”ç”¨ç¨‹åºå¿«æ·æ–¹å¼ã€‚åœ¨è®¾ç½®äº†æ„å›¾å’ŒçŸ­è¯­å‚æ•°ä¹‹åï¼Œç°åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå¯ä»¥åœ¨ä¸åŒçš„åœ°æ–¹ä½¿ç”¨æˆ‘ä»¬çš„<code class="fe mh mi mj mk b">AppIntent</code>ã€‚</p><p id="1bcd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ‚¨å¯ä»¥æ·»åŠ ä»»æ„æ•°é‡çš„çŸ­è¯­ã€‚é€šè¿‡åœ¨Spotlightä¸­é”®å…¥æˆ–å‘Šè¯‰Siriï¼Œè¿™äº›çŸ­è¯­å°†ç”¨äºè§¦å‘æ„å›¾çš„æ‰§è¡Œæ–¹æ³•ã€‚çŸ­è¯­æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å°†æ˜¯æ˜¾ç¤ºç»™ç”¨æˆ·çš„å…ƒç´ ã€‚</p><p id="bcc9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨è®©æˆ‘ä»¬è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œçœ‹çœ‹æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ˜¯å¦å¦‚é¢„æœŸçš„é‚£æ ·å·¥ä½œã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/eb07defae96b71b4fb4b61b465f213b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*5KufOyf99t9z3rRjxmzgig.png"/></div></figure><p id="b135" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœä½ çœ‹åˆ°äº†ä½ çš„<code class="fe mh mi mj mk b">AppIntent</code>å¹¶è·å¾—äº†æˆåŠŸçš„ç»“æœï¼Œé‚£ä¹ˆä¸ºè‡ªå·±éª„å‚²å§ï¼ç°åœ¨ä½ å·²ç»åˆ›é€ äº†ä¸€ä¸ª<code class="fe mh mi mj mk b">AppIntent</code>ã€‚</p><p id="f747" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®©æˆ‘ä»¬åˆ›å»ºç¬¬äºŒä¸ªåº”ç”¨ç¨‹åºæ„å›¾ï¼Œå®ƒä½¿ç”¨æˆ·èƒ½å¤Ÿæ·»åŠ æ–°çš„è´¹ç”¨é¡¹ç›®ã€‚åœ¨Intentsæ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º<code class="fe mh mi mj mk b">AddExpense.swift</code>çš„æ–°æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="6c98" class="mp mq iq mk b gy mr ms l mt mu">struct AddExpense: AppIntent {<br/>    <br/>    static var title: LocalizedStringResource = "Add a new expense"<br/>    <br/>    @Parameter(title: "Title")<br/>    var title: String<br/>    <br/>    @Parameter(title: "Price")<br/>    var price: Double<br/>    <br/>    @Parameter(title: "Date")<br/>    var date: Date<br/>    <br/>    <br/>    func perform() async throws -&gt; some IntentResult &amp; ProvidesDialog  {<br/>        await addExpense()<br/>        let dialog = IntentDialog("Successfully added your \(title) expense!")<br/>        return .result(dialog: dialog)<br/>    }<br/>    <br/>    <br/>    private func addExpense() async {<br/>        let service = await ExpenseService(context: (UIApplication.shared.delegate as! AppDelegate).persistentContainer.viewContext)<br/>        service.addExpenseItem(title: title, date: date, price: price, completion: {_ in})<br/>    }<br/>    <br/>}</span></pre><p id="b4a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">é™¤äº†æ ‡é¢˜å‚æ•°å’Œæ‰§è¡Œå‡½æ•°ä¹‹å¤–ï¼Œè¿™ä¸ªintentè¿˜æœ‰ä¸‰ä¸ªè¾“å…¥å‚æ•°ã€‚å½“æ·»åŠ åˆ°<code class="fe mh mi mj mk b">AppIntent</code>ä¸­æ—¶ï¼Œæˆ‘ä»¬ä¸ºè¿™ç§è¾“å…¥æ·»åŠ äº†<code class="fe mh mi mj mk b">@Parameter</code>å±æ€§åŒ…è£…å™¨ã€‚</p><p id="4388" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨ç”¨äº<code class="fe mh mi mj mk b">AppIntent</code>ä¹‹å‰ï¼Œæ¯ä¸ªIntentå‚æ•°åº”ç¬¦åˆ<code class="fe mh mi mj mk b">AppEnum</code>åè®®ã€‚å¦‚æœä½ æƒ³æœ‰ä¸€äº›è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œä¸è¦å¿˜è®°éµå®ˆè¿™ä¸ªåè®®ã€‚ç”±äºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåªä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦ï¼Œå› ä¸ºå®ƒä»¬å·²ç»ç¬¦åˆè¯¥åè®®ã€‚</p><p id="0bbf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨ä»ç”¨æˆ·é‚£é‡Œè·å¾—è¾“å…¥(æ— è®ºæ˜¯é€šè¿‡é”®ç›˜è¿˜æ˜¯Siri)åï¼Œåœ¨performå‡½æ•°ä¸­è¿è¡Œå¦ä¸€ä¸ªæœåŠ¡æ–¹æ³•ã€‚ç„¶åå‘ç”¨æˆ·æ˜¾ç¤ºä¸€ä¸ªå¯¹è¯æ¡†ã€‚ç°åœ¨æˆ‘ä»¬è¿˜éœ€è¦å°†è¿™ä¸ªæ„å›¾æ·»åŠ åˆ°<code class="fe mh mi mj mk b">AppShortcutsProvider</code>ä¸­ã€‚</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="bbf1" class="mp mq iq mk b gy mr ms l mt mu">struct HarcaMAShortCuts: AppShortcutsProvider {<br/>    static var appShortcuts: [AppShortcut] {<br/>        AppShortcut(<br/>            intent: ShowTotalExpense(),<br/>            phrases: [<br/>                "What is my total expense in \(.applicationName)?",<br/>                "Show my total expense in \(.applicationName)",<br/>                "How much did I spend in \(.applicationName)?"<br/>            ]<br/>        )<br/>        <br/>        AppShortcut(<br/>            intent: AddExpense(),<br/>            phrases: [<br/>                "Add a new expense to \(.applicationName)",<br/>                "Create an expense in \(.applicationName)"<br/>            ]<br/>        )<br/>    }<br/>}</span></pre><p id="5faa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœæ‚¨è¿è¡Œè¯¥åº”ç”¨ç¨‹åºï¼Œæ‚¨å°†ä¼šçœ‹åˆ°æˆ‘ä»¬çš„æ–°æ„å›¾ã€‚è®©æˆ‘ä»¬è¯•è¯•å®ƒæ˜¯å¦åƒé¢„æœŸçš„é‚£æ ·å·¥ä½œã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/c10cb43223cfb5e6f070b1d1be2220f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*EZ5IsAc0HiD4IlcVkMbDpA.png"/></div></figure><p id="47b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åšå¾—å¥½ï¼Œå®ƒçš„å·¥ä½œåƒä¸€ä¸ªé­”å’’ï¼ï¼æˆ‘ä»¬ç°åœ¨ä¸ºç”¨æˆ·æä¾›äº†å¦ä¸€ç§æ–¹å¼ï¼Œæ— éœ€æ‰“å¼€åº”ç”¨ç¨‹åºå°±å¯ä»¥ä»å¤šä¸ªåœ°æ–¹æ³¨å†Œæ–°çš„è´¹ç”¨ã€‚ç›¸ä¿¡æˆ‘ï¼Œè¿™äº›åŠŸèƒ½ä½¿æ‚¨çš„iOSåº”ç”¨ç¨‹åºæ›´åŠ ç”¨æˆ·å‹å¥½ï¼Œç”¨æˆ·å°†å¿«é€Ÿå®Œæˆæ—¥å¸¸ä»»åŠ¡ï¼Œè¿™å¯¹æ‚¨å’Œæ‚¨çš„å®¢æˆ·éƒ½æœ‰å·¨å¤§çš„å¥½å¤„ã€‚</p><p id="d733" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ç§æ— éœ€åœ¨å‰å°å¯åŠ¨å°±èƒ½ä¸åº”ç”¨ç¨‹åºäº¤äº’çš„æ–¹æ³•ã€‚ä½†æ˜¯AppIntentsæ¡†æ¶å…è®¸çš„ä¸æ­¢è¿™äº›ï¼Œæ‚¨å¯ä»¥é€šè¿‡åœ¨æ‚¨çš„<code class="fe mh mi mj mk b">AppIntent</code>ç»“æ„ä¸­å°†<code class="fe mh mi mj mk b">openAppWhenRun</code>å‚æ•°è®¾ç½®ä¸ºtrueæ¥æ‰“å¼€æ‚¨çš„åº”ç”¨ç¨‹åºçš„æŸäº›ç‰¹å®šéƒ¨åˆ†ï¼Œåˆ›å»ºå®šä¹‰å¦‚ä½•å¡«å……intentå‚æ•°çš„å‚æ•°æ‘˜è¦å¹¶æ˜¾ç¤ºè‡ªå®šä¹‰ç”¨æˆ·ç•Œé¢ï¼Œå¦‚SwiftUIè§†å›¾ï¼Œåˆ›å»ºè‡ªå®šä¹‰å®ä½“å¹¶ç¼–å†™æŸ¥è¯¢æ¥æ”¶é›†å®ƒä»¬ï¼Œé€šè¿‡æ·»åŠ <code class="fe mh mi mj mk b">ReturnsResult</code>åè®®ä»intentè¿”å›ç»“æœå¹¶åœ¨å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºintentä¸­ä½¿ç”¨è¯¥ç»“æœï¼Œç­‰ç­‰ã€‚</p><p id="dee0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½†æ˜¯ï¼Œåœ¨è®¡åˆ’æ‚¨å°†ä¸ºåº”ç”¨ç¨‹åºæä¾›çš„åº”ç”¨ç¨‹åºå¿«æ·æ–¹å¼ä¹‹å‰ï¼Œä¹Ÿè¦è€ƒè™‘è¿™äº›é™åˆ¶ã€‚ä¸€ä¸ªiOSåº”ç”¨ç¨‹åºä¸èƒ½æœ‰10ä¸ªä»¥ä¸Šçš„åº”ç”¨ç¨‹åºå¿«æ·æ–¹å¼ã€‚æ­¤å¤–ï¼Œå¦‚æœä½ æƒ³åœ¨åº”ç”¨ç¨‹åºæ„å›¾ä¸­æ˜¾ç¤ºä½ çš„è‡ªå®šä¹‰è§†å›¾ï¼Œè¿™äº›è§†å›¾ä¸èƒ½åŒ…æ‹¬äº¤äº’æ€§æˆ–åŠ¨ç”»ã€‚æˆ‘å¼ºçƒˆå»ºè®®ä½ åœ¨è®¡åˆ’ä½ çš„åº”ç”¨æ„å›¾ä¹‹å‰è€ƒè™‘è¿™äº›ã€‚æœ€åï¼Œæˆ‘ä»¬è¿˜åº”è¯¥è€ƒè™‘æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå¿«æ·æ–¹å¼å°†è¢«ç”¨æˆ·å‘ç°çš„æ–¹å¼ã€‚</p><p id="c1fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å°½ç®¡å¦‚æ­¤ï¼ŒAppIntentsæ¡†æ¶ä¼¼ä¹æ˜¯ä¸€ç§å¢åŠ ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„äº¤äº’å¹¶ä¸ºæˆ‘ä»¬çš„iOSåº”ç”¨ç¨‹åºåˆ›é€ æ›´å¤šä»·å€¼çš„ç»ä½³æ–¹å¼ã€‚è®©æˆ‘ä»¬æƒ³æƒ³æˆ‘ä»¬çš„å¿«æ·æ–¹å¼ï¼Œçœ‹çœ‹ä¸ºiOSåº”ç”¨ç¨‹åºåˆ›å»ºçš„ä¼Ÿå¤§AppIntentåˆ›æ„ã€‚</p><p id="e658" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">GitHubèµ„æºåº“:</p><div class="nz oa gp gr ob oc"><a href="https://github.com/sadikcoban/HarcaMA" rel="noopener  ugc nofollow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd ir gy z fp oh fr fs oi fu fw ip bi translated">GitHub - sadikcoban/HarcaMA</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">æ­¤æ—¶æ‚¨ä¸èƒ½æ‰§è¡Œè¯¥æ“ä½œã€‚æ‚¨å·²ä½¿ç”¨å¦ä¸€ä¸ªæ ‡ç­¾é¡µæˆ–çª—å£ç™»å½•ã€‚æ‚¨å·²åœ¨å¦ä¸€ä¸ªé€‰é¡¹å¡ä¸­æ³¨é”€ï¼Œæˆ–è€…â€¦</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">github.com</p></div></div><div class="ol l"><div class="om l on oo op ol oq kp oc"/></div></div></a></div><h1 id="306e" class="nb mq iq bd nc nd ne nf ng nh ni nj nk jw nl jx nm jz nn ka no kc np kd nq nr bi translated"><strong class="ak"> <em class="or">å‚è€ƒæ–‡çŒ®</em> </strong></h1><ul class=""><li id="6931" class="ls lt iq ky b kz ns lc nt lf os lj ot ln ou lr lx ly lz ma bi translated"><a class="ae kv" href="https://developer.apple.com/documentation/AppIntents" rel="noopener ugc nofollow" target="_blank">è‹¹æœå¼€å‘è€…æ–‡æ¡£</a></li><li id="0a28" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://developer.apple.com/videos/play/wwdc2022/10032/" rel="noopener ugc nofollow" target="_blank">æ·±å…¥äº†è§£åº”ç”¨æ„å›¾</a></li><li id="b9dd" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://developer.apple.com/videos/play/wwdc2022/10170" rel="noopener ugc nofollow" target="_blank">ä½¿ç”¨åº”ç”¨æ„å›¾å®ç°åº”ç”¨å¿«æ·æ–¹å¼</a></li></ul></div></div>    
</body>
</html>