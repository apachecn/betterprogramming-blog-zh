# æ„å»ºè½»é‡çº§è§’åº¦å†…å®¹æœåŠ¡çš„æœ€å¿«æ–¹å¼

> åŸæ–‡ï¼š<https://betterprogramming.pub/the-fastest-way-to-build-lightweight-angular-content-service-1970fbc67681>

## æœ€å¥½çš„è§£å†³æ–¹æ¡ˆå¾ˆç®€å•ï¼

![](img/07c33c2f132aa7e7180c6bdcafff3b54.png)

ç…§ç‰‡ç”±[éŸ¦æ–¯Â·å»·å¾·å°”](https://unsplash.com/@lonestarexotic?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)åœ¨ [Unsplash](https://unsplash.com/s/photos/racecar?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šæ‹æ‘„

åœ¨å…¸å‹çš„è§’åº¦åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å¤§é‡çš„æ ‡é¢˜ã€æ ‡ç­¾ã€æ ‡é¢˜å’Œæ›´å¤šçš„å†…å®¹ã€‚ä½†æ˜¯å¦‚æœä½ éœ€è¦ä¸€ç§æ–¹æ³•æŠŠè¿™äº›å†…å®¹å…ƒç´ æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œä½ éœ€è¦ä¸€ä¸ªç±»ä¼¼å­—å…¸çš„ä¸œè¥¿ã€‚å®ƒæ˜¯å°å•è¯å’Œæ›´å¹¿æ³›çš„å¥å­çš„ç»„åˆã€‚

ä¸€äº›åº”ç”¨ç¨‹åºéœ€è¦å¤šç§è¯­è¨€ï¼Œä½†å…¶ä»–åº”ç”¨ç¨‹åºéœ€è¦ä¸€ç§è¯­è¨€ï¼Œä½†æœ‰å¤§é‡å†…å®¹å¯ä»¥é‡ç”¨ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘æƒ³å‘æ‚¨å±•ç¤ºä¸ºæ‚¨çš„ Angular åº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ª`ContentService`(æœ‰äººç§°ä¹‹ä¸ºå­—å…¸)çš„æœ€å¿«æ–¹æ³•ã€‚

> å¦‚æœä½ éœ€è¦å¤šè¯­è¨€çš„å†…å®¹æœåŠ¡ï¼Œæˆ‘å¼ºçƒˆæ¨è [NGX-Translate](http://www.ngx-translate.com/) ã€‚è¿™ä¸ªåŒ…æä¾›äº†ä¸€ä¸ªç®€å•çš„ API å’Œç®¡é“æœºåˆ¶æ¥é‡ç”¨å†…å®¹ï¼Œä½†ä¹Ÿæ”¯æŒå¤šç§è¯­è¨€ã€‚

# åˆ›å»ºå†…å®¹æœåŠ¡

åˆ›å»º Angular æœåŠ¡æœ€ç®€å•å¿«æ·çš„æ–¹æ³•æ˜¯ä½¿ç”¨ Angular CLIã€‚

```
ng generate service services/content
```

é€šè¿‡è¿è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œæ‚¨å°†ç”Ÿæˆä¸€ä¸ª Angular æœåŠ¡ï¼Œè‡ªåŠ¨æ·»åŠ åˆ°`app.module.ts`æ–‡ä»¶ä¸­ã€‚å¦‚æœæ‚¨çš„é¡¹ç›®å…·æœ‰ä¸åŒçš„ CLI è®¾ç½®ï¼Œå®ƒå¯èƒ½ä¼šå‡ºç°åœ¨å¦ä¸€ä¸ª Angular æ¨¡å—ä¸­ã€‚

ç°åœ¨å†…å®¹æœåŠ¡çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ã€‚

# åˆ›å»ºä¸€ä¸ª JSON å­—å…¸æ–‡ä»¶

æ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªå­—å…¸æ–‡ä»¶æ¥æ”¾å…¥æ‚¨æ‰€æœ‰çš„æ ‡é¢˜ã€æ ‡ç­¾å’Œå…¶ä»–å†…å®¹ã€‚è¯·å°†å®ƒæ”¾åœ¨æœ€é€‚åˆæ‚¨çš„åº”ç”¨çš„åœ°æ–¹ã€‚

æˆ‘åˆ›å»ºäº†ä¸€ä¸ª`dictionary`æ–‡ä»¶å¤¹ï¼Œåœ¨é‚£é‡Œæˆ‘åˆ›å»ºäº†`general.dictionary.json`æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘å¯ä»¥åœ¨é‚£é‡Œæœ‰æ›´å¤šçš„å­—å…¸æ–‡ä»¶ã€‚

æˆ‘æ”¾è¿›å»çš„å†…å®¹æ˜¯è¿™æ ·çš„ã€‚

ä½ å¯ä»¥åˆ›å»ºä»»ä½•ä½ å–œæ¬¢çš„ç»“æ„ï¼›è¿™å–å†³äºä½ æ€ä¹ˆåšæœ€å¥½ã€‚

# ä¸ºå¯é‡ç”¨æ€§å‡†å¤‡å†…å®¹æœåŠ¡

æˆ‘ä»¬ä»åˆ›å»ºç§æœ‰è´¢äº§`cache$`å¼€å§‹ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬åˆ¶ä½œä¸€ä¸ª`BehaviourSubject`ã€‚æˆ‘ä»¬è¿™æ ·åšæ˜¯å› ä¸ºæˆ‘ä»¬å¯ä»¥ä»åº”ç”¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹è®¢é˜…è¿™ä¸ª`BehaviourSubject`ã€‚æœ€æ£’çš„æ˜¯ï¼Œå½“ä¸€ä¸ªå†…å®¹é¡¹è¢«æ›´æ–°æ—¶ï¼Œå®ƒå°†è‡ªåŠ¨åœ¨ä»»ä½•åœ°æ–¹è¢«æ›´æ–°ã€‚

> æˆ‘åˆ›å»ºäº†ä¸€ä¸ª [StackBlitz ç¤ºä¾‹](https://stackblitz.com/edit/angular-content-dictionary-service?file=README.md)ï¼Œæ¥å±•ç¤ºä¸ºä»€ä¹ˆ`BehaviourSubject`æ˜¯æœåŠ¡çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ã€‚

> å¦‚æœä½ æƒ³çŸ¥é“ä¸åŒä¸»é¢˜ä¹‹é—´çš„åŒºåˆ«ï¼Œè¯·æŸ¥çœ‹è¿™ä¸ªå¸–å­"[å½“åœ¨ Angular](https://hasnode.byrayray.dev/rxjs-subject-behavioursubject-replaysubject-asyncsubject-void-subject-angular) ä¸­ä½¿ç”¨ RxJS ä¸»é¢˜ã€behaviour ä¸»é¢˜ã€replay ä¸»é¢˜ã€async ä¸»é¢˜æˆ– Void ä¸»é¢˜æ—¶"

ä¸‹ä¸€æ­¥æ˜¯åœ¨é¡¶éƒ¨å¯¼å…¥å­—å…¸æ–‡ä»¶ã€‚

åœ¨æœåŠ¡çš„æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›ç¡®ä¿å¦‚æœ`BehaviourSubject`æ˜¯`null`ï¼Œæˆ‘ä»¬éœ€è¦ä»å­—å…¸æ–‡ä»¶ä¸­æ·»åŠ å†…å®¹ã€‚

ç°åœ¨æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–¹æ³•å°†`BehaviourSubject`åŠå…¶å†…å®¹å…¬å¼€ç»™è®¢é˜…è€…ã€‚æˆ‘ä»¬é€šè¿‡è¿”å›`cache$`å±æ€§æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ–¹æ³•çš„è¿”å›ç±»å‹æ˜¯`any`,å› ä¸ºæ‚¨ä¸å¿…é”®å…¥å­—å…¸çš„ç»“æ„ã€‚ä½†æ˜¯å¦‚æœä½ æƒ³ï¼Œä½ å¯ä»¥åšåˆ°ã€‚

ä¸ºäº†ä½¿æœåŠ¡æ›´é€‚åˆåœ¨ HTML æ¨¡æ¿ä¸­ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å…¬å¼€é“¾æ¥äº†`.getValue()`æ–¹æ³•çš„`content()`æ–¹æ³•ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬çš„æœåŠ¡ä¸­æœ‰äº†ä¸€åˆ‡å¯ä»¥ä½¿ç”¨çš„ä¸œè¥¿ã€‚æœåŠ¡çš„å®Œæ•´ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ç®€å•å³ğŸ˜‰ã€‚

# ä½¿ç”¨å†…å®¹ä¸­çš„å†…å®¹æœåŠ¡

æˆ‘çŒœä½ çŸ¥é“æ€ä¹ˆåšä¸€ä¸ªæœ‰è§’åº¦çš„ç»„ä»¶ã€‚CLI æ˜¯æˆ‘æœ€å–œæ¬¢çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œæ‚¨ç”Ÿæˆä¸€ä¸ª`HomepageComponent`ã€‚

```
ng generate component components/homepage
```

å¦‚æœä½ è‡ªå·±æœ‰ä¸ªè§’çš„æˆåˆ†ï¼Œé‚£ä¹Ÿæ²¡é—®é¢˜ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†`ContentService`å¯¼å…¥åˆ°æˆ‘ä»¬çš„ç»„ä»¶ä¸­ï¼Œå¹¶é€šè¿‡`constructor`å…¬å¼€å®ƒã€‚

ç°åœ¨æˆ‘ä»¬æƒ³å°†æ¥è‡ª`ContentService`çš„å†…å®¹æš´éœ²ç»™ HTML æ¨¡æ¿ã€‚æˆ‘ä»¬åœ¨ç»„ä»¶ä¸­åˆ›å»ºä¸€ä¸ª`content`å±æ€§ï¼Œå¹¶é€šè¿‡`constructor`æ·»åŠ å€¼ã€‚

é€šè¿‡`console.log`ï¼Œæ‚¨å¯ä»¥æµ‹è¯•æ˜¯å¦ä¸€åˆ‡æ­£å¸¸ã€‚

ç°åœ¨ä½¿ç”¨`ContentService`å°†å­—å…¸æ–‡ä»¶ä¸­çš„æ ‡é¢˜æ·»åŠ åˆ° HTML æ¨¡æ¿ä¸­ã€‚

åœ¨ç¤ºä¾‹ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å‘æ¨¡æ¿æ·»åŠ äº†ä¸€ä¸ªè¡¨è¾¾å¼ã€‚åœ¨è¿™ä¸ªè¡¨è¾¾å¼ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æ— æ•ˆç¢°æ’æŠ€æœ¯ã€‚æˆ‘ä»¬è¿™æ ·åšï¼Œæ‰€ä»¥å½“å±æ€§ä¸åœ¨å­—å…¸æ–‡ä»¶ä¸­æ—¶ï¼Œæˆ‘ä»¬ä¸ä¼šå¾—åˆ°é”™è¯¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒåªæ˜¯å‘ä½ æ˜¾ç¤ºâ€œæ ‡é¢˜â€ã€‚å¦‚æœè¯¥å€¼å¯ç”¨ï¼Œå®ƒå°†äº¤ä»˜è¯¥å€¼ã€‚

# èµ„æº

**StackBlitz** ä¸­çš„ä»£ç ç¤ºä¾‹ğŸ‘‡

[](https://stackblitz.com/edit/angular-content-dictionary-service?ctl=1&embed=1&file=src/app/app.component.ts&hideExplorer=1&hideNavigation=1) [## è§’åº¦å†…å®¹/å­—å…¸æœåŠ¡(RxJS) - StackBlitz

### ç¼–è¾‘æè¿°

stackblitz.com](https://stackblitz.com/edit/angular-content-dictionary-service?ctl=1&embed=1&file=src/app/app.component.ts&hideExplorer=1&hideNavigation=1) 

**Github** ç¤ºä¾‹ğŸ‘‡

[](https://github.com/devbyray/angular-content-dictionary-service/tree/master) [## github-dev byray/angular-content-dictionary-service:ç”¨ StackBlitz âš¡ï¸åˆ›å»º

### ç”±æ–¯å¡”å…‹å¸ƒé‡Œå…¹Â·âš¡ï¸.åˆ›ä½œé€šè¿‡åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œä¸º devbyray/angular-content-dictionary-service å¼€å‘åšå‡ºè´¡çŒ®

github.com](https://github.com/devbyray/angular-content-dictionary-service/tree/master) 

# ç»“è®º

ç°åœ¨ï¼Œæ‚¨åœ¨ Angular ä¸­æœ‰äº†ä¸€ä¸ªç®€å•çš„å†…å®¹æœåŠ¡ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨å¤–éƒ¨åŒ…ã€‚æ‰€ä»¥å®ƒé‡é‡è½»ï¼Œé€Ÿåº¦è¶…å¿«ï¼Œè¿™æ˜¯å®ƒæœ€å¤§çš„ä¼˜ç‚¹ã€‚æˆ‘ä»¬å¯èƒ½ç»å¸¸è®¤ä¸ºå®ƒå¤ªå¤æ‚ï¼Œä½†æˆ‘ä»¬éœ€è¦çš„åªæ˜¯ç®€å•çš„ä¸œè¥¿ã€‚

å¸Œæœ›è¿™æœ‰åŠ©äºæ‚¨æ„å»ºæ˜“äºç»´æŠ¤çš„å‡ºè‰²çš„è§’åº¦åº”ç”¨ç¨‹åºã€‚

# è°¢è°¢ï¼

![](img/2bd571bb1ce9f466ae279fa98111b086.png)

è¯»å®Œè¿™ä¸ªæ•…äº‹åï¼Œæˆ‘å¸Œæœ›ä½ å­¦åˆ°äº†ä¸€äº›æ–°çš„ä¸œè¥¿ï¼Œæˆ–è€…å—åˆ°å¯å‘å»åˆ›é€ ä¸€äº›æ–°çš„ä¸œè¥¿ï¼ğŸ¤—

å¦‚æœæˆ‘ç»™ä½ ç•™ä¸‹äº†é—®é¢˜æˆ–ä¸€äº›è¦è¯´çš„è¯ä½œä¸ºå›åº”ï¼Œå‘ä¸‹æ»šåŠ¨å¹¶ç»™æˆ‘é”®å…¥ä¸€æ¡æ¶ˆæ¯ã€‚å¦‚æœä½ æƒ³ä¿å¯†ï¼Œè¯·åœ¨ Twitter @DevByRayRay ä¸Šç»™æˆ‘å‘ä¸€æ¡ [DMã€‚æˆ‘çš„ DM æ°¸è¿œæ˜¯å¼€æ”¾çš„ğŸ˜](https://twitter.com/@devbyrayray)

[**é€šè¿‡ç”µå­é‚®ä»¶è·å–æˆ‘çš„æ–‡ç« ç‚¹å‡»è¿™é‡Œ**](https://byrayray.medium.com/subscribe) **|** [**è´­ä¹° 5 ç¾å…ƒä¸­ç­‰ä¼šå‘˜èµ„æ ¼**](https://byrayray.medium.com/membership)

# **é˜…è¯»æ›´å¤š**

![RayRay](img/992af170033696163d6cc0269218aedd.png)

[é›·é›·](https://byrayray.medium.com/?source=post_page-----1970fbc67681--------------------------------)

## è’è¯çš„æ•…äº‹

[View list](https://byrayray.medium.com/list/angular-stories-24674407532a?source=post_page-----1970fbc67681--------------------------------)6 stories![](img/b94f2b7d2929c90566cd2dd6f657a751.png)![](img/02b73423a62d73b113af9fdf9629c79f.png)![Stacked books](img/b02a2f57c0093e04ab1d11d3a55f35ea.png)