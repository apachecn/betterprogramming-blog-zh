<html>
<head>
<title>You Must Be 64-Bit to Ride This Ferry</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ‚¨å¿…é¡»æ˜¯64ä½æ‰èƒ½ä¹˜åæ­¤æ¸¡è½®</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://betterprogramming.pub/you-must-be-64-bit-to-ride-this-ferry-61ed45c57a93?source=collection_archive---------0-----------------------#2022-11-23">https://betterprogramming.pub/you-must-be-64-bit-to-ride-this-ferry-61ed45c57a93?source=collection_archive---------0-----------------------#2022-11-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8fa0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">é€†å‘å·¥ç¨‹çš„åƒç´ 7æ›´æ–°çº½çº¦æ°´è·¯åº”ç”¨ç¨‹åº</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a3a9d6d412de3314cce65fb8869765ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Bl-jHgViHpPQerBR"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">éº¦å…‹æ–¯éŸ¦Â·é‡Œå¥‡éŸ¦åœ¨<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</p></figure><blockquote class="kw kx ky"><p id="da69" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ir"> TLDR </strong>:å¦‚æœä½ æœ‰æ›´æ–°çš„Androidè®¾å¤‡ï¼Œä¸å…è®¸ä½ å®‰è£…NY Waterwayï¼Œä½ å¯ä»¥<strong class="lc ir">ä¸‹è½½</strong> <a class="ae kv" href="https://drive.google.com/file/d/1k4sC932ZZDepRbTJ3wCLZxJR1NsQMa_s/view?usp=share_link" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir">æˆ‘çš„ä¿®æ”¹ç‰ˆåº”ç”¨</strong> </a>ã€‚ä½ åº”è¯¥å§‹ç»ˆå°å¿ƒå®‰è£…éšæœºåº”ç”¨ç¨‹åºï¼Œå°¤å…¶æ˜¯æ¥è‡ªå®˜æ–¹Play Storeä¹‹å¤–çš„æ¥æºâ€”â€”å°±åƒè¿™ç¯‡ç”±ä¸€ä¸ªä½ ä»æœªå¬è¯´è¿‡çš„éšæœºå®¶ä¼™å†™çš„æ–‡ç« ã€‚å¦‚æœæ‚¨æƒ³ç‰¹åˆ«å°å¿ƒï¼Œæ‚¨å¯ä»¥æå‰é˜…è¯»ï¼Œçœ‹çœ‹APKæ˜¯å¦‚ä½•ä¿®æ”¹çš„(å¦‚æœæ‚¨æ„¿æ„ï¼Œç”šè‡³å¯ä»¥è‡ªå·±é‡å¤è¿™äº›æ­¥éª¤)ã€‚</p></blockquote><p id="6d0b" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">2019å¹´ï¼Œ<a class="ae kv" href="https://android-developers.googleblog.com/2019/01/get-your-apps-ready-for-64-bit.html" rel="noopener ugc nofollow" target="_blank"> Googleå¯¹Play Storeä¸­æ‰€æœ‰æ–°çš„å’Œæ›´æ–°çš„åº”ç”¨åšå‡ºäº†64ä½æ”¯æŒè¦æ±‚</a>ã€‚ä»2021å¹´8æœˆå¼€å§‹ï¼Œä¸æ”¯æŒ64ä½æ¶æ„çš„åº”ç”¨ç¨‹åºå°†æ— æ³•åœ¨Play Storeä¸­ç”¨äº64ä½è®¾å¤‡ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<a class="ae kv" href="https://android-developers.googleblog.com/2022/10/64-bit-only-devices.html" rel="noopener ugc nofollow" target="_blank">æ–°çš„Pixel 7å’ŒPixel 7 Proæ ¹æœ¬ä¸æ”¯æŒå®‰è£…ä»…32ä½çš„åº”ç”¨<em class="lb"/></a>ã€‚</p><p id="a354" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">å¯¹äºä¹˜åå“ˆå¾·é€Šæ²³æ¸¡è½®çš„çº½çº¦äººæ¥è¯´ï¼Œè¿™ç›¸å½“ä¸æ–¹ä¾¿ï¼Œå› ä¸ºåœ¨ä½ çš„æ‰‹æœºä¸Šæä¾›ç”µå­èˆ¹ç¥¨çš„åº”ç”¨ç¨‹åº<a class="ae kv" href="https://play.google.com/store/apps/details?id=co.bytemark.nywaterway" rel="noopener ugc nofollow" target="_blank">NY Waterway</a><em class="lb">å®åœ¨æ˜¯å¤ªè€äº†</em>ã€‚å®ƒæœ€è¿‘ä¸€æ¬¡å‘å¸ƒæ˜¯åœ¨2018å¹´6æœˆï¼ŒåªåŒ…å«32ä½æ¶æ„çš„åŸç”Ÿåº“â€¦â€¦å› æ­¤ï¼Œå¯¹äºæ–°Pixelè®¾å¤‡çš„ç”¨æˆ·æ¥è¯´ï¼Œ<strong class="lc ir">å“ˆå¾·é€Šæ²³è½®æ¸¡</strong>æ²¡æœ‰ç”µå­ç¥¨ç»™ä½ ï¼</p><p id="7fc1" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">æˆ‘åœ¨å¾ˆå¤šå¹´å‰å°±å¼€å§‹ä½¿ç”¨iPhoneäº†ï¼Œä½†æ˜¯å½“æˆ‘è¿˜æ˜¯Androidç”¨æˆ·çš„æ—¶å€™ï¼Œæˆ‘ç»å¸¸ä¿®æ”¹æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºâ€”â€”å®‰è£…å®šåˆ¶çš„romå’Œåç¼–è¯‘åº”ç”¨ç¨‹åºã€‚æˆ‘çš„ä¸€ä¸ªå¥½æœ‹å‹æœ‰äº†æ–°çš„Pixel 7 Proï¼Œå¹¶ä¸”ä¸€ç›´ä¹˜åå“ˆå¾·é€Šæ²³æ¸¡è½®ï¼Œæ‰€ä»¥ä»–å¼€ç©ç¬‘åœ°æ•¦ä¿ƒæˆ‘ä¸ºä»–ä¿®å¤è¿™ä¸ªåº”ç”¨ç¨‹åºã€‚å¼€å§‹äº†ã€‚</p><h1 id="d453" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">çª¥è§†åº”ç”¨ç¨‹åº</h1><p id="1606" class="pw-post-body-paragraph kz la iq lc b ld mr jr lf lg ms ju li lw mt ll lm lx mu lp lq ly mv lt lu lv ij bi translated">è®©æˆ‘ä»¬ä»æ£€æŸ¥NY Waterwayåº”ç”¨ç¨‹åºå¼€å§‹ï¼Œä»¥ç¡®å®šåªæœ‰32ä½çš„éƒ¨åˆ†ï¼Œè¿™äº›éƒ¨åˆ†é˜»æ­¢äº†å®ƒçš„å®‰è£…ã€‚ä½¿ç”¨<code class="fe mw mx my mz b"><a class="ae kv" href="https://ibotpeaches.github.io/Apktool/" rel="noopener ugc nofollow" target="_blank">apktool</a></code>ï¼Œæˆ‘ä»¬å¯ä»¥æå–Androidåº”ç”¨ç¨‹åºå¹¶æ£€æŸ¥å…¶ä»£ç ã€‚</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="ab72" class="ne ma iq mz b be nf ng l nh ni">$ apktool d ./NYWaterway.apk<br/>I: Using Apktool 2.6.1 on NYWaterway.apk<br/>I: Loading resource table...<br/>I: Decoding AndroidManifest.xml with resources...<br/>I: Loading resource table from file: /Users/joeywatts/Library/apktool/framework/1.apk<br/>I: Regular manifest package...<br/>I: Decoding file-resources...<br/>I: Decoding values */* XMLs...<br/>I: Baksmaling classes.dex...<br/>I: Copying assets and libs...<br/>I: Copying unknown files...<br/>I: Copying original files...<br/>$ cd ./NYWaterway<br/>$ ls -l<br/>total 72<br/>-rw-r--r--    1 joeywatts  staff   8797 Nov 21 18:37 AndroidManifest.xml<br/>-rw-r--r--    1 joeywatts  staff  21382 Nov 21 18:37 apktool.yml<br/>drwxr-xr-x   14 joeywatts  staff    448 Nov 21 18:37 assets<br/>drwxr-xr-x    5 joeywatts  staff    160 Nov 21 18:37 lib<br/>drwxr-xr-x    4 joeywatts  staff    128 Nov 21 18:37 original<br/>drwxr-xr-x  178 joeywatts  staff   5696 Nov 21 18:37 res<br/>drwxr-xr-x   10 joeywatts  staff    320 Nov 21 18:37 smali<br/>drwxr-xr-x   10 joeywatts  staff    320 Nov 21 18:37 unknown</span></pre><p id="ef86" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><code class="fe mw mx my mz b">apktool</code>å°†è¾“å‡ºä¸€ä¸ªæ–°ç›®å½•ï¼Œå…¶ä¸­åŒ…å«ä»äºŒè¿›åˆ¶æ–‡ä»¶åç¼–è¯‘æˆäººç±»å¯è¯»çš„åŸºäºæ–‡æœ¬çš„æ ¼å¼Smaliçš„åº”ç”¨ç¨‹åºå­—èŠ‚ç ã€æ†ç»‘çš„èµ„æº(æ¯”å¦‚å›¾åƒ)ã€æœ¬åœ°åº“å’Œåº”ç”¨ç¨‹åºé…ç½®ã€‚Smaliå¯èƒ½çœ‹èµ·æ¥å¾ˆå¯æ€•ï¼Œä½†å®ƒæ¯”ä½ æƒ³è±¡çš„æ›´å®¹æ˜“æ¥è¿‘â€”â€”ç¨åä¼šè¯¦ç»†ä»‹ç»â€¦â€¦ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸“æ³¨äºä¿®å¤64ä½å…¼å®¹æ€§ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£æ­£åœ¨ä½¿ç”¨å“ªäº›æœ¬åœ°åº“ã€‚</p><h1 id="640f" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">64ä½å…¼å®¹æ€§å’Œæœ¬åœ°åº“</h1><p id="00d5" class="pw-post-body-paragraph kz la iq lc b ld mr jr lf lg ms ju li lw mt ll lm lx mu lp lq ly mv lt lu lv ij bi translated">Androidåº”ç”¨ç¨‹åºé€šå¸¸æ˜¯ç”¨Javaæˆ–Kotlinç¼–å†™çš„ï¼Œè¿™ä¸¤ç§è¯­è¨€éƒ½é¢å‘Javaè™šæ‹Ÿæœºï¼Œè¿™æ˜¯ä¸€ç§é«˜çº§æŠ½è±¡ï¼Œé€šå¸¸å¯ä»¥è®©æ‚¨ä¸å¿…æ‹…å¿ƒç‰¹å®šäºå¹³å°çš„å…¼å®¹æ€§ã€‚ç„¶è€Œï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<em class="lb"> Javaæœ¬åœ°æ¥å£</em> (JNI)æ¥è°ƒç”¨æœ¬åœ°çš„ã€ç‰¹å®šäºå¹³å°çš„ä»£ç (é€šå¸¸ç”±Cæˆ–C++ç­‰ä½çº§è¯­è¨€ç¼–è¯‘)ã€‚å¦‚æœæˆ‘ä»¬æŸ¥çœ‹<code class="fe mw mx my mz b">libs</code>ç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°çº½çº¦æ°´é“åº”ç”¨ç¨‹åºä¸­åŒ…å«çš„æœ¬åœ°åº“ã€‚</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="7bbb" class="ne ma iq mz b be nf ng l nh ni">$ ls -lR lib/*<br/>lib/armeabi:<br/>total 8352<br/>-rw-r--r--  1 joeywatts  staff   177900 Nov 21 18:37 libdatabase_sqlcipher.so<br/>-rw-r--r--  1 joeywatts  staff  1369284 Nov 21 18:37 libsqlcipher.so<br/>-rw-r--r--  1 joeywatts  staff  2314540 Nov 21 18:37 libsqlcipher_android.so<br/>-rw-r--r--  1 joeywatts  staff   402604 Nov 21 18:37 libstlport_shared.so<br/><br/>lib/armeabi-v7a:<br/>total 2552<br/>-rw-r--r--  1 joeywatts  staff  1303788 Nov 21 18:37 libsqlcipher.so<br/><br/>lib/x86:<br/>total 14616<br/>-rw-r--r--  1 joeywatts  staff  1476500 Nov 21 18:37 libdatabase_sqlcipher.so<br/>-rw-r--r--  1 joeywatts  staff  2246448 Nov 21 18:37 libsqlcipher.so<br/>-rw-r--r--  1 joeywatts  staff  3294132 Nov 21 18:37 libsqlcipher_android.so<br/>-rw-r--r--  1 joeywatts  staff   455740 Nov 21 18:37 libstlport_shared.so</span></pre><p id="3563" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code class="fe mw mx my mz b">lib</code>ä¸‹æœ‰ä¸‰ä¸ªç›®å½•ï¼Œåˆ†åˆ«å¯¹åº”ä¸åŒçš„å¹³å°:<code class="fe mw mx my mz b">x86</code>ã€<code class="fe mw mx my mz b">armeabi</code>ã€<code class="fe mw mx my mz b">armeabi-v7a</code>ã€‚è¿™ä¸‰ä¸ªå¹³å°éƒ½æ˜¯32ä½çš„ã€‚ç»å¤§å¤šæ•°Androidè®¾å¤‡(åŸºæœ¬ä¸Šæ‰€æœ‰æ‰‹æœº)éƒ½ä½¿ç”¨ARMæ¶æ„ã€‚â€œarmeabiâ€æ˜¯é—ç•™çš„ARMæ¶æ„(Androidä¸å†æ”¯æŒ)ã€‚ARM V7(â€œARM eabi-v7aâ€)æ˜¯32ä½ARMæ¶æ„ã€‚å¯¹äº64ä½ARMæ”¯æŒï¼Œæˆ‘ä»¬æœŸæœ›æœ‰ä¸€ä¸ª<code class="fe mw mx my mz b">arm64-v8a</code>æ–‡ä»¶å¤¹ã€‚</p><p id="26c2" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">è¿™é‡Œçš„å¦ä¸€ä¸ªè§‚å¯Ÿæ˜¯<code class="fe mw mx my mz b">armeabi</code>å’Œ<code class="fe mw mx my mz b">x86</code>æœ‰å››ä¸ªåº“ï¼Œè€Œ<code class="fe mw mx my mz b">armeabi-v7a</code>åªæœ‰ä¸€ä¸ªã€‚å¯¹äºè¦ç”±Androidåº”ç”¨ç¨‹åºåŠ è½½çš„åº“ï¼Œå®ƒå¿…é¡»è°ƒç”¨<code class="fe mw mx my mz b">java.lang.System.loadLibrary</code>æˆ–<code class="fe mw mx my mz b">java.lang.Runtime.loadLibrary</code>ã€‚åœ¨Smaliä»£ç ä¸­æœç´¢â€œloadLibrary â€,åªèƒ½æ‰¾åˆ°ä¸€ä¸ªåŠ è½½æœ¬åœ°åº“çš„åœ°æ–¹ã€‚</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="2556" class="ne ma iq mz b be nf ng l nh ni">$ grep -r loadLibrary smali/<br/>smali//net/sqlcipher/database/SQLiteDatabase.smali:    invoke-static {v0}, Ljava/lang/System;-&gt;loadLibrary(Ljava/lang/String;)V<br/>$ grep loadLibrary -A 2 -B 3 smali/net/sqlcipher/database/SQLiteDatabase.smali<br/>    :try_start_0<br/>    const-string v0, "sqlcipher"<br/><br/>    invoke-static {v0}, Ljava/lang/System;-&gt;loadLibrary(Ljava/lang/String;)V<br/>    :try_end_0<br/>    .catchall {:try_start_0 .. :try_end_0} :catchall_0</span></pre><p id="8a46" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">å”¯ä¸€ç”±åº”ç”¨ç¨‹åºç›´æ¥åŠ è½½çš„åº“æ˜¯â€œsqlcipherâ€(<code class="fe mw mx my mz b">libsqlcipher.so</code>)ã€‚ä¸ºæŸäº›æ¶æ„åˆ—å‡ºçš„å…¶ä»–åº“æ–‡ä»¶è¦ä¹ˆæ˜¯æœªä½¿ç”¨çš„ï¼Œè¦ä¹ˆåªæ˜¯<code class="fe mw mx my mz b">libsqlcipher.so</code>çš„å¯ä¼ é€’ä¾èµ–ã€‚</p><p id="76f7" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">æˆ‘ä»¬éœ€è¦ä¸€ä¸ª64ä½ARMæ„å»ºçš„<code class="fe mw mx my mz b">lib/arm64-v8a</code>ä¸­çš„<code class="fe mw mx my mz b">libsqlcipher.so</code>æ¥ä½¿åº”ç”¨ç¨‹åºä¸æ–°çš„åƒç´ è®¾å¤‡å…¼å®¹ã€‚æ–¹ä¾¿çš„æ˜¯ï¼ŒSQLCipheræ˜¯ä¸€ä¸ªå¼€æºåº“ã€‚æŸ¥çœ‹ç”¨äºä¸æœ¬åœ°sqlcipheråº“äº¤äº’çš„é«˜çº§ç²˜åˆä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‰€ä½¿ç”¨çš„åº“çš„ç‰ˆæœ¬ã€‚</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="4d3d" class="ne ma iq mz b be nf ng l nh ni">$ grep -ri version smali/net/sqlcipher <br/>smali/net/sqlcipher/database/SQLiteDatabase.smali:.field public static final SQLCIPHER_ANDROID_VERSION:Ljava/lang/String; = "3.5.4"</span></pre><p id="d8b8" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">åœ¨å¯¹å¼€æºrepoåšäº†ä¸€äº›å¿«é€ŸæŒ–æ˜åï¼Œæˆ‘å¯ä»¥çœ‹åˆ°çœŸæ­£çš„64ä½æ”¯æŒ<a class="ae kv" href="https://github.com/sqlcipher/android-database-sqlcipher/compare/v3.5.4...v3.5.5" rel="noopener ugc nofollow" target="_blank">æ˜¯åœ¨v3.5.5 </a>ä¸­å®ç°çš„(æ¯”NY Waterwayä¸­ä½¿ç”¨çš„ç‰ˆæœ¬æ›´æ–°äº†ä¸€ä¸ªè¡¥ä¸ç‰ˆæœ¬)ã€‚æˆ‘ä»¬è¯•è¯•å‡çº§å§ï¼</p><h2 id="0f03" class="nj ma iq bd mb nk nl dn mf nm nn dp mj lw no np ml lx nq nr mn ly ns nt mp nu bi translated">å°†SQLCipherå‡çº§åˆ°v3.5.5</h2><p id="6183" class="pw-post-body-paragraph kz la iq lc b ld mr jr lf lg ms ju li lw mt ll lm lx mu lp lq ly mv lt lu lv ij bi translated">å‡çº§è¿‡ç¨‹åŒ…æ‹¬ç”¨æ–°ç‰ˆæœ¬çš„ä»£ç æ›¿æ¢SQLCipher Smaliä»£ç å’Œæœ¬åœ°åº“ã€‚å¦‚æœSQLCipherçš„å…¬å…±APIè¡¨é¢å‘ç”Ÿæ˜¾è‘—å˜åŒ–ï¼Œè¿™å°†å¯¼è‡´é—®é¢˜(ä¾‹å¦‚ï¼Œå¦‚æœNY Waterwayä½¿ç”¨çš„å…¬å…±å‡½æ•°æ›´æ”¹äº†ç­¾åæˆ–è¢«åˆ é™¤ï¼Œé‚£ä¹ˆç”¨æ–°ç‰ˆæœ¬æ›¿æ¢å®ƒå°†å¯¼è‡´é—®é¢˜)ã€‚å¿«é€Ÿæµè§ˆä¸€ä¸‹ä»v3.5.4åˆ°v3.5.5çš„å˜åŒ–ï¼Œè¿™é‡Œä¼¼ä¹ä¸ä¼šå‡ºç°é—®é¢˜ã€‚æˆ‘ä¸‹è½½äº†SQLCipher v3.5.5çš„AARæ–‡ä»¶<a class="ae kv" href="https://search.maven.org/artifact/net.zetetic/android-database-sqlcipher/3.5.5/aar" rel="noopener ugc nofollow" target="_blank">ï¼Œç„¶åç”¨<code class="fe mw mx my mz b">unzip</code>è§£å‹ã€‚</a></p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="fe24" class="ne ma iq mz b be nf ng l nh ni">$ mkdir ../sqlcipher &amp;&amp; cd ../sqlcipher<br/>$ unzip ~/Downloads/android-database-sqlcipher-3.5.5.aar<br/>Archive:  /Users/joeywatts/Downloads/android-database-sqlcipher-3.5.5.aar<br/>  inflating: AndroidManifest.xml     <br/>   creating: res/<br/>  inflating: classes.jar             <br/>   creating: jni/<br/>   creating: jni/arm64-v8a/<br/>   creating: jni/armeabi/<br/>   creating: jni/armeabi-v7a/<br/>   creating: jni/x86/<br/>   creating: jni/x86_64/<br/>  inflating: jni/arm64-v8a/libsqlcipher.so  <br/>  inflating: jni/armeabi/libsqlcipher.so  <br/>  inflating: jni/armeabi-v7a/libsqlcipher.so  <br/>  inflating: jni/x86/libsqlcipher.so  <br/>  inflating: jni/x86_64/libsqlcipher.so</span></pre><p id="3a3b" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">æå–ä¹‹åï¼Œæˆ‘ä»¬çœ‹åˆ°åœ¨<code class="fe mw mx my mz b">jni</code>ç›®å½•ä¸‹æ˜¯æœ¬åœ°åº“ã€‚å®ƒè¿˜è¾“å‡ºä¸€ä¸ªåŒ…å«æ‰€æœ‰è°ƒç”¨æœ¬åœ°åº“çš„Javaç±»æ–‡ä»¶çš„<code class="fe mw mx my mz b">classes.jar</code>æ–‡ä»¶ã€‚è¿™äº›ä¸æ˜¯å°æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è½¬æ¢è¿™äº›ä»£ç ï¼Œä»¥ä¾¿å°†å…¶è½¬æ¢æˆ<code class="fe mw mx my mz b">apktool</code>èƒ½å¤Ÿç†è§£çš„æ ¼å¼ã€‚</p><p id="8ce8" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">Android SDKæä¾›äº†ä¸€ä¸ªåä¸º<code class="fe mw mx my mz b">d8</code>çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥å°†<code class="fe mw mx my mz b">jar</code>æ–‡ä»¶ç¼–è¯‘æˆAndroidå­—èŠ‚ç (<code class="fe mw mx my mz b">classes.dex</code>æ–‡ä»¶)ã€‚è¿˜æœ‰ä¸€ä¸ªå«åš<code class="fe mw mx my mz b"><a class="ae kv" href="https://github.com/JesusFreke/smali" rel="noopener ugc nofollow" target="_blank">baksmali</a></code>çš„å·¥å…·å¯ä»¥å°†<code class="fe mw mx my mz b">dex</code>æ–‡ä»¶åç¼–è¯‘æˆ<code class="fe mw mx my mz b">smali</code>ã€‚å°†è¿™äº›æ­¥éª¤ç»“åˆåœ¨ä¸€èµ·:</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="1844" class="ne ma iq mz b be nf ng l nh ni">$ export ANDROID_HOME=/Users/joeywatts/Library/Android/sdk<br/>$ $ANDROID_HOME/build-tools/33.0.0/d8 classes.jar \<br/>   --lib $ANDROID_HOME/platforms/android-31/android.jar<br/>$ java -jar ../baksmali.jar dis ./classes.dex</span></pre><p id="0bba" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">è¿™ä¼šäº§ç”Ÿä¸€ä¸ªåŒ…å«åº“çš„Smaliä»£ç çš„<code class="fe mw mx my mz b">out</code>ç›®å½•ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†<code class="fe mw mx my mz b">smali/net/sqlcipher</code>æ›¿æ¢ä¸º<code class="fe mw mx my mz b">out/net/sqlcipher</code>ï¼Œå°†<code class="fe mw mx my mz b">lib</code>ç›®å½•æ›¿æ¢ä¸º<code class="fe mw mx my mz b">jni</code>ã€‚</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="33c2" class="ne ma iq mz b be nf ng l nh ni">$ rm -r ../NYWaterway/smali/net/sqlcipher ../NYWaterway/lib<br/>$ mv out/net/sqlcipher ../NYWaterway/smali/net/sqlcipher<br/>$ mv jni ../NYWaterway/lib</span></pre><h1 id="a9f4" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">æ„å»ºå’Œè¿è¡Œä¿®æ”¹åçš„åº”ç”¨ç¨‹åº</h1><p id="cebb" class="pw-post-body-paragraph kz la iq lc b ld mr jr lf lg ms ju li lw mt ll lm lx mu lp lq ly mv lt lu lv ij bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°æ„å»ºåº”ç”¨ç¨‹åºå¹¶å¯¹å…¶è¿›è¡Œç­¾åï¼Œè¿™æ ·å®ƒå°±å¯ä»¥å®‰è£…åœ¨è®¾å¤‡ä¸Šäº†ï¼</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="27f6" class="ne ma iq mz b be nf ng l nh ni">$ cd ../NYWaterway<br/>$ apktool b .<br/>$ keytool -genkey -v -keystore my-release-key.keystore -alias alias_name \<br/>    -keyalg RSA -keysize 2048 -validity 10000<br/>$ $ANDROID_HOME/build-tools/33.0.0/apksigner sign \<br/>    --ks my-release-key.keystore ./dist/NYWaterway.apk</span></pre><p id="08c4" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">å®‰è£…<code class="fe mw mx my mz b">./dist/NYWaterway.apk</code>åï¼Œæ˜¾ç¤ºè¿™ä¸ªç”»é¢ï¼</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/40e067cdfb3336cbae3e817c60473b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*1gTbmZxmJSdzS9Qa_4Ujhw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">å®ƒè·‘äº†ï¼æˆ‘ä»¬ç¡®å®æœ‰è¿™ä¸ªå” å¨çš„å¼¹å‡ºçª—å£ğŸ˜”</p></figure><h1 id="3edf" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">å¢åŠ ç›®æ ‡SDKç‰ˆæœ¬</h1><p id="3a8c" class="pw-post-body-paragraph kz la iq lc b ld mr jr lf lg ms ju li lw mt ll lm lx mu lp lq ly mv lt lu lv ij bi translated">ä¸ºäº†æ‘†è„±è¿™ä¸ªè¡¨æ˜åº”ç”¨ç¨‹åºæ˜¯ä¸ºæ—§ç‰ˆæœ¬Androidæ„å»ºçš„å¼¹å‡ºçª—å£ï¼Œæˆ‘ä»¬éœ€è¦åœ¨<code class="fe mw mx my mz b">apktool.yml</code>ä¸­å¢åŠ ç›®æ ‡SDKç‰ˆæœ¬ã€‚Play Storeä¸å†æ¥å—é’ˆå¯¹SDKç‰ˆæœ¬&lt; 31çš„åº”ç”¨ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©å°†å…¶å¢åŠ åˆ°é‚£ä¸ªç‰ˆæœ¬ã€‚</p><p id="edb0" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">é’ˆå¯¹è¾ƒæ–°ç‰ˆæœ¬çš„Android SDKå¯èƒ½éœ€è¦æ›´æ”¹ä»£ç ï¼Œå› ä¸ºä¸æ¨èä½¿ç”¨çš„APIåœ¨è¾ƒæ–°çš„SDKç‰ˆæœ¬ä¸­å˜å¾—ä¸å¯ç”¨ã€‚NY Waterwayéœ€è¦é’ˆå¯¹SDK v31è¿›è¡Œä¸€äº›æ›´æ”¹ã€‚</p><h2 id="9cc8" class="nj ma iq bd mb nk nl dn mf nm nn dp mj lw no np ml lx nq nr mn ly ns nt mp nu bi translated">æ›´å®‰å…¨çš„ç»„ä»¶å¯¼å‡º</h2><blockquote class="kw kx ky"><p id="150e" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><a class="ae kv" href="https://developer.android.com/about/versions/12/behavior-changes-12#exported" rel="noopener ugc nofollow" target="_blank">å¦‚æœæ‚¨çš„åº”ç”¨é¢å‘Android 12æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå¹¶ä¸”åŒ…å«ä½¿ç”¨æ„å›¾è¿‡æ»¤å™¨çš„æ´»åŠ¨ã€æœåŠ¡æˆ–å¹¿æ’­æ¥æ”¶å™¨ï¼Œæ‚¨å¿…é¡»ä¸ºè¿™äº›åº”ç”¨ç»„ä»¶æ˜¾å¼å£°æ˜</a> <code class="fe mw mx my mz b"><a class="ae kv" href="https://developer.android.com/about/versions/12/behavior-changes-12#exported" rel="noopener ugc nofollow" target="_blank">android:exported</a></code> <a class="ae kv" href="https://developer.android.com/about/versions/12/behavior-changes-12#exported" rel="noopener ugc nofollow" target="_blank">å±æ€§ã€‚</a></p></blockquote><p id="cb4e" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">æœ‰å‡ ä¸ªæ´»åŠ¨å’Œä¸€ä¸ªæ¥æ”¶è€…æœ‰<code class="fe mw mx my mz b">&lt;intent-filter&gt;</code> sï¼Œéœ€è¦åœ¨<code class="fe mw mx my mz b">AndroidManifest.xml</code>ä¸­æ·»åŠ ä¸€ä¸ª<code class="fe mw mx my mz b">android:exported="true"</code>å±æ€§ã€‚</p><h2 id="009f" class="nj ma iq bd mb nk nl dn mf nm nn dp mj lw no np ml lx nq nr mn ly ns nt mp nu bi translated">å¾…å®šæ„å‘å¯å˜æ€§</h2><blockquote class="kw kx ky"><p id="2c70" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><a class="ae kv" href="https://developer.android.com/about/versions/12/behavior-changes-12#pending-intent-mutability" rel="noopener ugc nofollow" target="_blank">å¦‚æœä½ çš„åº”ç”¨é¢å‘Android 12ï¼Œä½ å¿…é¡»æŒ‡å®šä½ çš„åº”ç”¨åˆ›å»ºçš„æ¯ä¸ª</a> <code class="fe mw mx my mz b"><a class="ae kv" href="https://developer.android.com/about/versions/12/behavior-changes-12#pending-intent-mutability" rel="noopener ugc nofollow" target="_blank">PendingIntent</a></code> <a class="ae kv" href="https://developer.android.com/about/versions/12/behavior-changes-12#pending-intent-mutability" rel="noopener ugc nofollow" target="_blank">å¯¹è±¡çš„å¯å˜æ€§ã€‚è¿™ä¸€é¢å¤–è¦æ±‚æé«˜äº†åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚</a></p></blockquote><p id="dfe1" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">è¿™ä¸€ä¸ªæ›´æ£˜æ‰‹ï¼Œå› ä¸ºå®ƒè¦æ±‚æˆ‘ä»¬æ›´æ”¹å®é™…çš„ä»£ç (ä¸é¡¹ç›®é…ç½®æˆ–å¤åˆ¶åº“çš„å‡çº§ç‰ˆæœ¬ç›¸å)ã€‚</p><p id="d2ad" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">ä»»ä½•æ—¶å€™åˆ›å»ºä¸€ä¸ª<code class="fe mw mx my mz b">PendingIntent</code>å¯¹è±¡ï¼Œå®ƒéƒ½éœ€è¦æ˜ç¡®æŒ‡å®š<code class="fe mw mx my mz b">FLAG_MUTABLE</code>æˆ–<code class="fe mw mx my mz b">FLAG_IMMUTABLE</code>ã€‚åœ¨ä»¥å‰çš„SDKç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šæ ‡å¿—ï¼Œ<code class="fe mw mx my mz b">FLAG_MUTABLE</code>æ˜¯é»˜è®¤çš„ã€‚<code class="fe mw mx my mz b">PendingIntent</code>å¯¹è±¡ç”±ç±»ä¸Šçš„ä¸€ç»„é™æ€æ–¹æ³•åˆ›å»º:<code class="fe mw mx my mz b">getActivity</code>ã€<code class="fe mw mx my mz b">getActivities</code>ã€<code class="fe mw mx my mz b">getBroadcast</code>æˆ–<code class="fe mw mx my mz b">getService</code>ã€‚æˆ‘ä»¬å¯ä»¥ä»æœç´¢è¿™äº›å‡½æ•°çš„è°ƒç”¨å¼€å§‹ã€‚</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="08aa" class="ne ma iq mz b be nf ng l nh ni">$ grep -r -E "PendingIntent;-&gt;(getActivity|getActivities|getBroadcast|getService)" smali<br/>smali/android/support/v4/f/a/ac.smali:    invoke-static {p1, v2, v0, v2}, Landroid/app/PendingIntent;-&gt;getBroadcast(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/>smali/com/google/firebase/iid/r.smali:    invoke-static {p0, p1, v0, p4}, Landroid/app/PendingIntent;-&gt;getBroadcast(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/>smali/com/google/firebase/iid/m.smali:    invoke-static {p0, v2, v0, v3}, Landroid/app/PendingIntent;-&gt;getBroadcast(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/>smali/com/google/firebase/messaging/c.smali:    invoke-static {v0, v2, v1, v3}, Landroid/app/PendingIntent;-&gt;getActivity(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/>smali/com/google/android/gms/common/m.smali:    invoke-static {p1, p3, v0, v1}, Landroid/app/PendingIntent;-&gt;getActivity(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/>smali/com/google/android/gms/common/api/GoogleApiActivity.smali:    invoke-static {p0, v0, v1, v2}, Landroid/app/PendingIntent;-&gt;getActivity(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/>smali/com/google/android/gms/c/cbx.smali:    invoke-static {v1, v2, v0, v3}, Landroid/app/PendingIntent;-&gt;getActivity(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/>smali/com/google/android/gms/c/cbx.smali:    invoke-static {v2, v7, v1, v7}, Landroid/app/PendingIntent;-&gt;getBroadcast(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/>smali/com/google/android/gms/c/v.smali:    invoke-static {v0, v1, v2, v3}, Landroid/app/PendingIntent;-&gt;getActivity(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/>smali/com/google/android/gms/c/bj.smali:    invoke-static {v1, p2, v0, v2}, Landroid/app/PendingIntent;-&gt;getActivity(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/>smali/com/google/android/gms/c/byd.smali:    invoke-static {v1, v4, v0, v4}, Landroid/app/PendingIntent;-&gt;getBroadcast(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/>smali/com/google/android/gms/c/mr.smali:    invoke-static {v1, v3, v0, v3}, Landroid/app/PendingIntent;-&gt;getBroadcast(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;</span></pre><p id="0650" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">ä¸å°‘ï¼å¹¸è¿çš„æ˜¯ï¼Œå¤§å¤šæ•°éƒ½æ˜¯ç›¸å½“ç®€å•çš„å˜åŒ–ã€‚æˆ‘ä»¬åªéœ€è¦å…ˆäº†è§£ä¸€ç‚¹å­—èŠ‚ç ã€‚</p><h2 id="d261" class="nj ma iq bd mb nk nl dn mf nm nn dp mj lw no np ml lx nq nr mn ly ns nt mp nu bi translated">ç†è§£Smali</h2><p id="af10" class="pw-post-body-paragraph kz la iq lc b ld mr jr lf lg ms ju li lw mt ll lm lx mu lp lq ly mv lt lu lv ij bi translated"><code class="fe mw mx my mz b">invoke-static</code>å­—èŠ‚ç æŒ‡ä»¤å°†ä¸€ç³»åˆ—å¯„å­˜å™¨ä½œä¸ºå‚æ•°ä¼ é€’ç»™é™æ€å‡½æ•°ã€‚é™æ€å‡½æ•°çš„ç¬¦å·çœ‹èµ·æ¥åƒ<code class="fe mw mx my mz b">Landroid/app/PendingIntent;-&gt;getBroadcast(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;</code>,å®ƒæ˜¯å®Œå…¨é™å®šç±»åå’Œå‡½æ•°ç­¾åçš„ç›´æ¥ç¿»è¯‘ã€‚å®ƒä»¥ç±»å<code class="fe mw mx my mz b">Landroid/app/PendingIntent;</code>(æˆ–æ™®é€šJavaè¯­æ³•ä¸­çš„<code class="fe mw mx my mz b">android.app.PendingIntent</code>)å¼€å§‹ã€‚ç„¶åæ˜¯å‡½æ•°å(<code class="fe mw mx my mz b">-&gt;getBroadcast</code>)ä»¥åŠå‚æ•°å’Œè¿”å›ç±»å‹ã€‚<code class="fe mw mx my mz b">Landroid/content/Context;ILandroid/content/Intent;I</code>ä¸ºå‚æ•°ï¼Œå¯æ‹†åˆ†ä¸ºå››ä¸ªå‚æ•°:<code class="fe mw mx my mz b">Landroid/content/Context;</code>(<code class="fe mw mx my mz b">android.content.Context</code>)<code class="fe mw mx my mz b">I</code>(<code class="fe mw mx my mz b">int</code>)<code class="fe mw mx my mz b">Landroid/content/Intent;</code>(<code class="fe mw mx my mz b">android.content.Intent</code>)<code class="fe mw mx my mz b">I</code>(<code class="fe mw mx my mz b">int</code>)ã€‚æœ€åï¼Œå³æ‹¬å·åæ˜¯è¿”å›ç±»å‹:<code class="fe mw mx my mz b">Landroid/app/PendingIntent;</code>ã€‚</p><p id="a7e3" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">å› æ­¤ï¼Œä¸Šè¿°å‡½æ•°çš„<code class="fe mw mx my mz b">invoke-static {v1, v2, v3, v4}</code>å°†é€šè¿‡<code class="fe mw mx my mz b">v1</code>ä½œä¸º<code class="fe mw mx my mz b">Context</code>ã€<code class="fe mw mx my mz b">v2</code>ä½œä¸ºç¬¬ä¸€ä¸ª<code class="fe mw mx my mz b">int</code>ã€<code class="fe mw mx my mz b">v3</code>ä½œä¸º<code class="fe mw mx my mz b">Intent</code>ã€<code class="fe mw mx my mz b">v4</code>ä½œä¸º<code class="fe mw mx my mz b">int</code>ã€‚å¯¹äºè¿™äº›<code class="fe mw mx my mz b">PendingIntent</code>APIï¼Œ<code class="fe mw mx my mz b">flags</code>æ€»æ˜¯æœ€åä¸€ä¸ªå‚æ•°(<code class="fe mw mx my mz b">int</code>)ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç¡®ä¿è¯¥å€¼æ€»æ˜¯è®¾ç½®äº†<code class="fe mw mx my mz b">FLAG_MUTABLE</code>æˆ–<code class="fe mw mx my mz b">FLAG_IMMUTABLE</code>ã€‚<a class="ae kv" href="https://developer.android.com/reference/android/app/PendingIntent#FLAG_MUTABLE" rel="noopener ugc nofollow" target="_blank"> Android SDKæ–‡æ¡£</a>æ­ç¤º<code class="fe mw mx my mz b">FLAG_MUTABLE</code>çš„å€¼ä¸º<code class="fe mw mx my mz b">0x02000000</code><code class="fe mw mx my mz b">FLAG_IMMUTABLE</code>ä¸º<code class="fe mw mx my mz b">0x04000000</code>ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæœ€åä¸€ä¸ªå‚æ•°è¢«æŒ‡å®šä¸ºä¸€ä¸ªå±€éƒ¨å˜é‡å¯„å­˜å™¨(<code class="fe mw mx my mz b">v#</code>)ï¼Œè¯¥å¯„å­˜å™¨è¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ªå¸¸æ•°å€¼(å¦‚<code class="fe mw mx my mz b">const/high16 v3, 0x8000000</code>æˆ–<code class="fe mw mx my mz b">const/4 v4, 0x0</code>)ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°æ£€æŸ¥<code class="fe mw mx my mz b">FLAG_MUTABLE</code>æˆ–<code class="fe mw mx my mz b">FLAG_IMMUTABLE</code>æ˜¯å¦è¢«è®¾ç½®ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±æ›´æ–°å¸¸é‡ã€‚</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="75af" class="ne ma iq mz b be nf ng l nh ni">-    const/high16 v3, 0x8000000<br/>+    const/high16 v3, 0xA000000<br/><br/>     invoke-static {v1, v2, v0, v3}, Landroid/app/PendingIntent;-&gt;getActivity(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/><br/># you may need to change from const/4 to const/high16 to specify the flag<br/># const/4 is a loading a signed 4-bit integer (seen used to load 0x0).<br/># const/high16 loads the high 16-bits from a value (the low 16-bits must be 0)<br/><br/>-    const/4 v4, 0x0<br/>+    const/high16 v4, 0x2000000</span></pre><p id="90ca" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">æœ‰ä¸€ç§æƒ…å†µ(åœ¨<code class="fe mw mx my mz b">com/google/firebase/iid/r.smali</code>ä¸­)æ˜¯<code class="fe mw mx my mz b">flags</code>ä½œä¸ºå‚æ•°(<code class="fe mw mx my mz b">p#</code>å¯„å­˜å™¨)ä¼ å…¥çš„ã€‚</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="408c" class="ne ma iq mz b be nf ng l nh ni">.method private static a(Landroid/content/Context;ILjava/lang/String;Landroid/content/Intent;I)Landroid/app/PendingIntent;<br/>    .locals 2<br/><br/>    new-instance v0, Landroid/content/Intent;<br/><br/>    const-class v1, Lcom/google/firebase/iid/FirebaseInstanceIdInternalReceiver;<br/><br/>    invoke-direct {v0, p0, v1}, Landroid/content/Intent;-&gt;&lt;init&gt;(Landroid/content/Context;Ljava/lang/Class;)V<br/><br/>    invoke-virtual {v0, p2}, Landroid/content/Intent;-&gt;setAction(Ljava/lang/String;)Landroid/content/Intent;<br/><br/>    const-string v1, "wrapped_intent"<br/><br/>    invoke-virtual {v0, v1, p3}, Landroid/content/Intent;-&gt;putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;<br/><br/>    invoke-static {p0, p1, v0, p4}, Landroid/app/PendingIntent;-&gt;getBroadcast(Landroid/content/Context;ILandroid/content/Intent;I)Landroid/app/PendingIntent;<br/><br/>    move-result-object v0<br/><br/>    return-object v0<br/>.end method</span></pre><p id="a53c" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">å¦‚æœ‰å¿…è¦ï¼Œæ›´æ–°<code class="fe mw mx my mz b">p4</code>ä»¥è®¾ç½®<code class="fe mw mx my mz b">FLAG_MUTABLE</code>ä½æ¯”è·Ÿè¸ªæ­¤åŠŸèƒ½çš„æ‰€æœ‰å¼•ç”¨ç›´åˆ°æŒ‡å®š<code class="fe mw mx my mz b">flags</code>æ›´å®¹æ˜“ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹å·¥ç¼–å†™ä¸€äº›å­—èŠ‚ç ï¼ç­‰æ•ˆçš„ç±»ä¼¼Javaçš„ä»£ç å¦‚ä¸‹æ‰€ç¤º:</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="9cd9" class="ne ma iq mz b be nf ng l nh ni">if (p4 &amp; (FLAG_IMMUTABLE | FLAG_MUTABLE) == 0) {<br/>    p4 |= FLAG_MUTABLE;<br/>}</span></pre><p id="27ad" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><code class="fe mw mx my mz b">FLAG_IMMUTABLE | FLAG_MUTABLE</code>æ˜¯å¸¸æ•°<code class="fe mw mx my mz b">0x6000000</code>ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code class="fe mw mx my mz b">const/high16</code>æŒ‡ä»¤å°†å®ƒåŠ è½½åˆ°å¯„å­˜å™¨ä¸­ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="fe mw mx my mz b">and-int</code>æŒ‡ä»¤ä¸<code class="fe mw mx my mz b">p4</code>è¿›è¡ŒæŒ‰ä½ANDè¿ç®—ã€‚<code class="fe mw mx my mz b">if-nez</code>å¦‚æœå¯„å­˜å™¨ä¸ç­‰äºé›¶ï¼Œå…è®¸æ‚¨è·³è½¬åˆ°æ ‡ç­¾ã€‚æœ€åï¼Œ<code class="fe mw mx my mz b">or-int</code>è®©æˆ‘ä»¬å¯¹ä¸¤ä¸ªå¯„å­˜å™¨è¿›è¡ŒæŒ‰ä½â€œæˆ–â€è¿ç®—ã€‚Googleæœ‰å…³äºDalvikå­—èŠ‚ç çš„<a class="ae kv" href="https://source.android.com/docs/core/runtime/dalvik-bytecode" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£ï¼Œè¿™å¯¹å‘ç°æŒ‡ä»¤åŠå…¶è¯­æ³•å¾ˆæœ‰ç”¨ã€‚å°†æ‰€æœ‰è¿™äº›æ”¾åœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸‹é¢çš„ä»£ç ï¼Œå®ƒå¯ä»¥åœ¨è°ƒç”¨<code class="fe mw mx my mz b">getBroadcast</code>ä¹‹å‰æ’å…¥ã€‚</a></p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="8ad6" class="ne ma iq mz b be nf ng l nh ni">const/high16 v3, 0x6000000 # v3 = FLAG_IMMUTABLE | FLAG_MUTABLE<br/>and-int v2, p4, v3         # v2 = p4 &amp; v3<br/>if-nez v2, :cond_0         # if (v2 != 0) { goto :cond_0; }<br/>const/high16 v3, 0x2000000 # v3 = FLAG_MUTABLE<br/>or-int p4, p4, v3          # p4 = p4 | v3<br/>:cond_0</span></pre><p id="1813" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">æœ€åï¼Œå‡½æ•°é¡¶éƒ¨çš„<code class="fe mw mx my mz b">.locals 2</code>æŒ‡ä»¤è¡¨ç¤ºåº”è¯¥ä¸ºæ­¤å‡½æ•°åˆ†é…ä¸¤ä¸ªå±€éƒ¨å˜é‡å¯„å­˜å™¨(<code class="fe mw mx my mz b">v0</code>å’Œ<code class="fe mw mx my mz b">v1</code>)ã€‚å› ä¸ºæˆ‘ä»¬åœ¨ä¸Šé¢çš„ä»£ç ä¸­åˆç”¨äº†ä¸¤ä¸ª(<code class="fe mw mx my mz b">v2</code>å’Œ<code class="fe mw mx my mz b">v3</code>)ï¼Œæ‰€ä»¥éœ€è¦æŠŠè¿™ä¸ªæ”¹æˆ<code class="fe mw mx my mz b">.locals 4</code>ã€‚</p><h2 id="5d4f" class="nj ma iq bd mb nk nl dn mf nm nn dp mj lw no np ml lx nq nr mn ly ns nt mp nu bi translated">æ–‡ä»¶ç³»ç»Ÿæƒé™æ›´æ”¹</h2><blockquote class="kw kx ky"><p id="d99f" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><a class="ae kv" href="https://developer.android.com/about/versions/nougat/android-7.0-changes#permfilesys" rel="noopener ugc nofollow" target="_blank">ç§æœ‰æ–‡ä»¶çš„æ–‡ä»¶æƒé™ä¸åº”å†è¢«æ‰€æœ‰è€…æ”¾æ¾ï¼Œè€Œè¯•å›¾ä½¿ç”¨</a> <code class="fe mw mx my mz b"><a class="ae kv" href="https://developer.android.com/about/versions/nougat/android-7.0-changes#permfilesys" rel="noopener ugc nofollow" target="_blank">MODE_WORLD_READABLE</a></code> <a class="ae kv" href="https://developer.android.com/about/versions/nougat/android-7.0-changes#permfilesys" rel="noopener ugc nofollow" target="_blank">å’Œ/æˆ–</a> <code class="fe mw mx my mz b"><a class="ae kv" href="https://developer.android.com/about/versions/nougat/android-7.0-changes#permfilesys" rel="noopener ugc nofollow" target="_blank">MODE_WORLD_WRITEABLE</a></code> <a class="ae kv" href="https://developer.android.com/about/versions/nougat/android-7.0-changes#permfilesys" rel="noopener ugc nofollow" target="_blank">è¿™æ ·åšï¼Œå°†ä¼šè§¦å‘</a> <code class="fe mw mx my mz b"><a class="ae kv" href="https://developer.android.com/about/versions/nougat/android-7.0-changes#permfilesys" rel="noopener ugc nofollow" target="_blank">SecurityException</a></code> <a class="ae kv" href="https://developer.android.com/about/versions/nougat/android-7.0-changes#permfilesys" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p></blockquote><p id="7245" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">åœ¨<code class="fe mw mx my mz b">com/google/android/gms/ads/identifier/AdvertisingIdClient.smali</code>æœ‰ä¸€äº›ä½¿ç”¨<code class="fe mw mx my mz b">MODE_WORLD_READABLE</code>çš„<code class="fe mw mx my mz b">SharedPreferences</code> APIç”¨æ³•ã€‚è¿™å¾ˆå®¹æ˜“è§£å†³ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªä»åˆ‡æ¢åˆ°<code class="fe mw mx my mz b">MODE_WORLD_READABLE</code> ( <code class="fe mw mx my mz b">0x1</code>)åˆ°<code class="fe mw mx my mz b">MODE_PRIVATE</code> ( <code class="fe mw mx my mz b">0x0</code>)çš„é—®é¢˜ã€‚</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="c036" class="ne ma iq mz b be nf ng l nh ni">--- a/smali/com/google/android/gms/ads/identifier/AdvertisingIdClient.smali<br/>+++ b/smali/com/google/android/gms/ads/identifier/AdvertisingIdClient.smali<br/>@@ -93,7 +93,7 @@<br/> <br/>     const-string v4, "google_ads_flags"<br/> <br/>-    const/4 v5, 0x1<br/>+    const/4 v5, 0x0<br/> <br/>     invoke-virtual {v2, v4, v5}, Landroid/content/Context;-&gt;getSharedPreferences(Ljava/lang/String;I)Landroid/content/SharedPreferences;</span></pre><h2 id="e211" class="nj ma iq bd mb nk nl dn mf nm nn dp mj lw no np ml lx nq nr mn ly ns nt mp nu bi translated">Apache HTTPå®¢æˆ·ç«¯å¼ƒç”¨</h2><blockquote class="kw kx ky"><p id="11a0" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><a class="ae kv" href="https://developer.android.com/about/versions/pie/android-9.0-changes-28#apache-p" rel="noopener ugc nofollow" target="_blank">åœ¨Android 6.0ä¸­ï¼Œæˆ‘ä»¬ç§»é™¤äº†å¯¹Apache HTTPå®¢æˆ·ç«¯çš„æ”¯æŒã€‚ä»Android 9å¼€å§‹ï¼Œè¿™ä¸ªåº“ä»bootclasspathä¸­ç§»é™¤ï¼Œé»˜è®¤æƒ…å†µä¸‹å¯¹åº”ç”¨ç¨‹åºä¸å¯ç”¨ã€‚</a></p></blockquote><p id="7312" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">NY Waterwayä½¿ç”¨çš„æ˜¯Androidç‰ˆæœ¬çš„Apache HTTPå®¢æˆ·ç«¯ï¼Œä½†æ˜¯å¯¹å®ƒçš„ä¿®å¤éå¸¸ç®€å•â€”â€”åªæ˜¯å¯¹<code class="fe mw mx my mz b">AndroidManifest.xml</code>çš„å¦ä¸€ä¸ªæ”¹å˜ã€‚</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="9241" class="ne ma iq mz b be nf ng l nh ni">diff --git a/AndroidManifest.xml b/AndroidManifest.xml<br/>index 1490d73..39ccbf3 100644<br/>--- a/AndroidManifest.xml<br/>+++ b/AndroidManifest.xml<br/>@@ -16,6 +16,7 @@<br/>     &lt;permission android:name="co.bytemark.nywaterway.permission.C2D_MESSAGE" android:protectionLevel="signature"/&gt;<br/>     &lt;uses-permission android:name="co.bytemark.nywaterway.permission.C2D_MESSAGE"/&gt;<br/>     &lt;application android:allowBackup="false" android:icon="@drawable/icon" android:label="@string/app_name" android:name="co.bytemark.nywaterway2.core.NYWWApp" android:theme="@style/AppTheme"&gt;<br/>+        &lt;uses-library android:name="org.apache.http.legacy" android:required="false" /&gt;<br/>         &lt;meta-data android:name="com.google.android.gms.version" android:value="@integer/google_play_services_version"/&gt;<br/>         &lt;receiver android:exported="false" android:label="NetworkConnection" android:name="co.bytemark.android.sdk.BytemarkSDK$ConnectionChangeReceiver"&gt;<br/>             &lt;intent-filter&gt;</span></pre><h2 id="88c8" class="nj ma iq bd mb nk nl dn mf nm nn dp mj lw no np ml lx nq nr mn ly ns nt mp nu bi translated">é»˜è®¤æƒ…å†µä¸‹å¯ç”¨ç½‘ç»œTLS</h2><blockquote class="kw kx ky"><p id="3d9d" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><a class="ae kv" href="https://developer.android.com/about/versions/pie/android-9.0-changes-28#tls-enabled" rel="noopener ugc nofollow" target="_blank">å¦‚æœä½ çš„appç›®æ ‡æ˜¯Android 9æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œ</a> <code class="fe mw mx my mz b"><a class="ae kv" href="https://developer.android.com/about/versions/pie/android-9.0-changes-28#tls-enabled" rel="noopener ugc nofollow" target="_blank">isCleartextTrafficPermitted()</a></code> <a class="ae kv" href="https://developer.android.com/about/versions/pie/android-9.0-changes-28#tls-enabled" rel="noopener ugc nofollow" target="_blank">æ–¹æ³•é»˜è®¤è¿”å›</a> <code class="fe mw mx my mz b"><a class="ae kv" href="https://developer.android.com/about/versions/pie/android-9.0-changes-28#tls-enabled" rel="noopener ugc nofollow" target="_blank">false</a></code> <a class="ae kv" href="https://developer.android.com/about/versions/pie/android-9.0-changes-28#tls-enabled" rel="noopener ugc nofollow" target="_blank">ã€‚å¦‚æœæ‚¨çš„åº”ç”¨éœ€è¦ä¸ºç‰¹å®šçš„åŸŸå¯ç”¨æ˜æ–‡ï¼Œæ‚¨å¿…é¡»åœ¨åº”ç”¨çš„ç½‘ç»œå®‰å…¨é…ç½®ä¸­å°†è¿™äº›åŸŸçš„</a> <code class="fe mw mx my mz b"><a class="ae kv" href="https://developer.android.com/about/versions/pie/android-9.0-changes-28#tls-enabled" rel="noopener ugc nofollow" target="_blank">cleartextTrafficPermitted</a></code> <a class="ae kv" href="https://developer.android.com/about/versions/pie/android-9.0-changes-28#tls-enabled" rel="noopener ugc nofollow" target="_blank">æ˜ç¡®è®¾ç½®ä¸º</a> <code class="fe mw mx my mz b"><a class="ae kv" href="https://developer.android.com/about/versions/pie/android-9.0-changes-28#tls-enabled" rel="noopener ugc nofollow" target="_blank">true</a></code> <a class="ae kv" href="https://developer.android.com/about/versions/pie/android-9.0-changes-28#tls-enabled" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p></blockquote><p id="87ff" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">ç”±äºè¿™é¡¹æ–°çš„å®‰å…¨åŠŸèƒ½ï¼Œç½‘ç»œè¯·æ±‚å¤±è´¥ã€‚ä½¿åº”ç”¨ç¨‹åºå…¼å®¹çš„æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å¯¹<code class="fe mw mx my mz b">AndroidManifest.xml</code>åšå¦ä¸€ä¸ªæ”¹å˜ï¼Œæ·»åŠ <code class="fe mw mx my mz b">android:usesCleartextTraffic="true"</code>å±æ€§ã€‚</p><pre class="kg kh ki kj gt na mz nb bn nc nd bi"><span id="4614" class="ne ma iq mz b be nf ng l nh ni">diff --git a/AndroidManifest.xml b/AndroidManifest.xml<br/>index 39ccbf3..69b4aa7 100644<br/>--- a/AndroidManifest.xml<br/>+++ b/AndroidManifest.xml<br/>@@ -15,7 +15,7 @@<br/>     &lt;uses-permission android:name="com.google.android.c2dm.permission.RECEIVE"/&gt;<br/>     &lt;permission android:name="co.bytemark.nywaterway.permission.C2D_MESSAGE" android:protectionLevel="signature"/&gt;<br/>     &lt;uses-permission android:name="co.bytemark.nywaterway.permission.C2D_MESSAGE"/&gt;<br/>-    &lt;application android:allowBackup="false" android:icon="@drawable/icon" android:label="@string/app_name" android:name="co.bytemark.nywaterway2.core.NYWWApp" android:theme="@style/AppTheme"&gt;<br/>+    &lt;application android:allowBackup="false" android:icon="@drawable/icon" android:label="@string/app_name" android:name="co.bytemark.nywaterway2.core.NYWWApp" android:theme="@style/AppTheme" android:usesCleartextTraffic="true"&gt;<br/>         &lt;uses-library android:name="org.apache.http.legacy" android:required="false" /&gt;<br/>         &lt;meta-data android:name="com.google.android.gms.version" android:value="@integer/google_play_services_version"/&gt;<br/>         &lt;receiver android:exported="false" android:label="NetworkConnection" android:name="co.bytemark.android.sdk.BytemarkSDK$ConnectionChangeReceiver"&gt;</span></pre><h1 id="39ca" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">ç»“è®º</h1><p id="d282" class="pw-post-body-paragraph kz la iq lc b ld mr jr lf lg ms ju li lw mt ll lm lx mu lp lq ly mv lt lu lv ij bi translated">åœ¨åšäº†ä»¥ä¸Šæ‰€æœ‰çš„ä¿®æ”¹åï¼Œåº”ç”¨ç¨‹åºæˆåŠŸè¿è¡Œï¼Œæ²¡æœ‰ä¸€ä¸ªçƒ¦äººçš„å¼¹å‡ºçª—å£è¯´å®ƒæ˜¯ä¸ºæ—§ç‰ˆæœ¬çš„Androidæ„å»ºçš„ï¼</p><p id="ade6" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">æœ‰ç‚¹å‡ºä¹æ„æ–™çš„æ˜¯ï¼Œä½¿å®ƒä¸è¾ƒæ–°çš„ç›®æ ‡SDKç‰ˆæœ¬ä¸€èµ·å·¥ä½œæ¯”å®é™…ä¿®å¤64ä½é—®é¢˜è¦å¤æ‚å¾—å¤šï¼Œä½†æœ€ç»ˆï¼Œä¸€åˆ‡éƒ½åªæ˜¯ä»£ç ï¼Œä»£ç æ²¡æœ‰ä»€ä¹ˆå¯æ€•çš„â€¦</p></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="033f" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><em class="lb">æƒ³è¦è¿æ¥ï¼Ÿåœ¨</em> <a class="ae kv" href="https://twitter.com/joeywatts96" rel="noopener ugc nofollow" target="_blank"> <em class="lb"> Twitter </em> </a> <em class="lb">æˆ–</em><a class="ae kv" href="https://www.linkedin.com/in/jwatts96/" rel="noopener ugc nofollow" target="_blank"><em class="lb">LinkedIn</em></a><em class="lb">ä¸Šç»™æˆ‘å‘æ¶ˆæ¯ï¼</em></p></div></div>    
</body>
</html>