<html>
<head>
<title>Async/Await Errors As Control Flow and Guards in JavaScript: How To Handle Errors in the Next Decade</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScriptä¸­ä½œä¸ºæ§åˆ¶æµå’Œå®ˆå«çš„å¼‚æ­¥/ç­‰å¾…é”™è¯¯:æœªæ¥åå¹´å¦‚ä½•å¤„ç†é”™è¯¯</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://betterprogramming.pub/async-await-errors-as-control-flow-guards-in-javascript-for-the-next-decade-46290deb42c?source=collection_archive---------15-----------------------#2019-10-28">https://betterprogramming.pub/async-await-errors-as-control-flow-guards-in-javascript-for-the-next-decade-46290deb42c?source=collection_archive---------15-----------------------#2019-10-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="00b3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">å¦‚ä½•ä»¥ä¸€ç§æ¼‚äº®çš„æ–¹å¼ç¼–å†™å¹²å‡€çš„ã€å¸¦é”™è¯¯å¤„ç†çš„å¼‚æ­¥ä»£ç </h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0b5f11abeada99186144f8fd85fd9ebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k2syRTds2xkTIKevWYmMNg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae ky" href="https://unsplash.com/@yakimadesign?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">ä¹”ä¸¹Â·ç½—å…°</a>åœ¨<a class="ae ky" href="https://unsplash.com/s/photos/stadium?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</p></figure><p id="90f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘ä»¬å¯èƒ½ä»ç„¶è®¤ä¸ºJavaScriptæ˜¯90å¹´ä»£é—ç•™ä¸‹æ¥çš„è¯­è¨€ï¼Œä½†å®ƒæ˜¯è¿™ä¸ªè¡—åŒºæœ€é…·çš„å­©å­ã€‚</p><p id="3da4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸€æ–¹é¢ï¼Œå¤„ç†é”™è¯¯æ˜¯å¾ˆé‡è¦çš„ï¼Œå¦åˆ™ç”¨æˆ·ä¼šç¢°å£ï¼Œä»–ä»¬ä¸èƒ½ä¿®æ”¹ä»–ä»¬è¾“å…¥çš„æ•°æ®ï¼Œä¹Ÿä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå› ä¸ºé”™è¯¯æ¶ˆæ¯éå¸¸æ¨¡ç³Šã€‚</p><p id="4188" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¦ä¸€æ–¹é¢ï¼Œå¯¹äºå¼€å‘å›¢é˜Ÿæ¥è¯´ï¼Œæ‹¥æœ‰ä¸€ä¸ªåƒé‡ç”ŸåŠ¨ç‰©ä¸€æ ·åˆ°å¤„éƒ½æ˜¯æ¡ä»¶å’Œé”™è¯¯å¯¹è±¡çš„å·¨å¤§ä»£ç åº“æ˜¯ä¸å¯å–çš„ã€‚</p><p id="0c35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä½†æ˜¯è¯´å®è¯ï¼Œå¤„ç†æ¯ä¸€ä¸ªå¯èƒ½çš„é”™è¯¯éƒ½å¾ˆéš¾ã€‚</p><p id="25c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å› æ­¤ï¼Œåœ¨è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºä¸€äº›åœ¨JavaScriptä¸­æœ‰æ•ˆå¤„ç†å¼‚æ­¥é”™è¯¯çš„æ–¹æ³•ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/8b3b4ca162b75097a13deaa30bb2f843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/1*NpRHDi7sUiLo8Z7v0SspZA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">æœªçŸ¥é”™è¯¯lol</p></figure><p id="03e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»ç°ä»£ç¼–ç¨‹è¯­è¨€ä¸­è·å¾—çµæ„Ÿï¼Œå¦‚<a class="ae ky" href="https://golang.org/" rel="noopener ugc nofollow" target="_blank"> Go </a>å’Œ<a class="ae ky" href="https://developer.apple.com/swift/" rel="noopener ugc nofollow" target="_blank"> Swift </a>ï¼Œæˆ‘å°†è·³è¿‡å¯¹<code class="fe lw lx ly lz b">async/await</code>ã€<code class="fe lw lx ly lz b">Promise</code>å’Œ<em class="ma">å›è°ƒ</em>çš„è§£é‡Šã€‚</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="0788" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">çµæ„Ÿ</h1><p id="7e39" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">åƒGoè¿™æ ·çš„è¯­è¨€éå¸¸é‡è§†é”™è¯¯å¤„ç†ã€‚æ€»æœ‰ä¸€ä¸ªåä¸º<code class="fe lw lx ly lz b">err</code>çš„å˜é‡éœ€è¦æ£€æŸ¥ã€‚è¿™é‡Œæœ‰ä¸€ä¸ª<a class="ae ky" href="https://blog.golang.org/error-handling-and-go" rel="noopener ugc nofollow" target="_blank">çš„ä¾‹å­</a>:</p><pre class="kj kk kl km gt nf lz ng nh aw ni bi"><span id="aced" class="nj mj it lz b gy nk nl l nm nn">if data, err := datastore.Get(c, key, record); err != nil {<br/>    http.Error(w, err.Error(), 500)<br/>    return<br/>}</span></pre><p id="8736" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™é‡Œæ˜¯Swiftä¸­çš„ä¸€ä¸ª<a class="ae ky" href="https://stackoverflow.com/a/39263210/3416691" rel="noopener ugc nofollow" target="_blank">ç¤ºä¾‹</a>:</p><pre class="kj kk kl km gt nf lz ng nh aw ni bi"><span id="f44a" class="nj mj it lz b gy nk nl l nm nn">func icon() -&gt; UIImage {<br/>    guard let image = UIImage(named: "Photo") else {<br/>        return UIImage(named: "Default")!<br/>    }<br/>    return image<br/>}</span></pre><p id="61f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘çš„ç›®æ ‡æ˜¯ç”¨JavaScriptå†™å‡ºåƒå‰é¢è¿™äº›ä¾‹å­ä¸€æ ·æ¼‚äº®ã€ç®€æ´å’Œæ¸…æ™°çš„ä¸œè¥¿ã€‚</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="6487" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">å¼‚æ­¥æ–¹æ³•</h1><p id="a1b2" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">ä¸‹é¢æ˜¯ä¸€äº›<code class="fe lw lx ly lz b">async</code>æ–¹æ³•:</p><pre class="kj kk kl km gt nf lz ng nh aw ni bi"><span id="c85e" class="nj mj it lz b gy nk nl l nm nn">async function fetchData() {<br/>  return fetch("...");<br/>}</span><span id="7619" class="nj mj it lz b gy no nl l nm nn">async function sendData(data) {<br/>  return fetch("...", {<br/>    method: "post",<br/>    body: JSON.stringify(data),<br/>  });<br/>}</span><span id="fd9f" class="nj mj it lz b gy no nl l nm nn">async function signData(data) {<br/> // Do something cool with cryptography ;)<br/>}</span></pre><p id="46cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­ä½¿ç”¨è¿™äº›æ–¹æ³•ã€‚</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="b154" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">å®Œå…¨æ²¡æœ‰å¤„ç†</h1><p id="0718" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">å¿«é€Ÿè€Œè‚®è„çš„è§£å†³æ–¹æ³•æ˜¯è·³è¿‡ä»»ä½•<code class="fe lw lx ly lz b">try/catch</code>,å¹¶å¸Œæœ›æœ€å¥½çš„ã€‚å¦‚æœæ‚¨å¯¹å…¨çƒäº’è”ç½‘ç½‘ç»œã€æ‚¨çš„æœåŠ¡å™¨å’Œç”¨æˆ·(ä¸–ç•Œä¸Šæœ€å®¹æ˜“è¢«è¯¯è§£çš„ç”Ÿç‰©)éå¸¸æœ‰ä¿¡å¿ƒï¼Œæ‚¨å¯ä»¥ç¼–å†™å¦‚ä¸‹ä»£ç :</p><pre class="kj kk kl km gt nf lz ng nh aw ni bi"><span id="6dd6" class="nj mj it lz b gy nk nl l nm nn">async function handleClick() {<br/>  const data = await fetchData();<br/>  const signed = await signData(data);<br/>  const saved = await sendData(signed);</span><span id="72f1" class="nj mj it lz b gy no nl l nm nn"><strong class="lz iu">  setState({ status: "ok âœ…" });</strong><br/>}</span></pre></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="33f4" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">æ•´ä½“æ•è·</h1><p id="4679" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">ä½ åº”è¯¥å†™çš„æœ€å°‘çš„é™„åŠ å†…å®¹æ˜¯è‡³å°‘æ˜¾ç¤ºä¸€ä¸ªè­¦å‘Šï¼Œä¹Ÿè®¸ç”¨ä¸€ä¸ªå¤§åŒ…è£…<code class="fe lw lx ly lz b">try/catch</code>æ¥æŠ¥å‘Šé”™è¯¯ã€‚</p><pre class="kj kk kl km gt nf lz ng nh aw ni bi"><span id="7afe" class="nj mj it lz b gy nk nl l nm nn">async function handleClick() {<br/>  <strong class="lz iu">try {</strong><br/>    const data = await fetchData();<br/>    const signed = await signData(data);<br/>    const saved = await sendData(signed);<br/>    setState({ status: "ok <strong class="lz iu">âœ…</strong>" });<br/><strong class="lz iu">  } catch (err) {</strong><br/>    <strong class="lz iu">setState({ status: "Something bad happened ğŸ¤·â€â™‚ï¸" });</strong><br/>  <strong class="lz iu">}</strong><br/>}</span></pre><p id="a5cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œæ‚¨è®©ç”¨æˆ·æˆ–ç³»ç»Ÿé‡è¯•æ“ä½œï¼Œä½†æ˜¯ä»–ä»¬æ°¸è¿œä¸ä¼šçŸ¥é“é”™è¯¯çš„åŸå› ã€‚è¿™çœŸçš„å¾ˆä»¤äººæ²®ä¸§ã€‚</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="76d0" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">ä¸€æ­¥ä¸€æ­¥è®©/è¯•/æŠ“</h1><p id="0ee4" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">è¿™æ˜¯ä¸€ä¸ªæ›´å¥½æ§åˆ¶çš„æµç¨‹ï¼Œæ‚¨å¯ä»¥å®é™…åˆ¤æ–­é”™è¯¯æ˜¯åœ¨å“ªé‡Œè§¦å‘çš„ã€‚</p><pre class="kj kk kl km gt nf lz ng nh aw ni bi"><span id="fee3" class="nj mj it lz b gy nk nl l nm nn">async function handleClick() {<br/><strong class="lz iu">  let data = null;<br/>  try {<br/>    data = await fetchData();<br/>  } catch (err) {<br/>    return setState({ status: "Network error ğŸ”Œ" });<br/>  }</strong></span><span id="e469" class="nj mj it lz b gy no nl l nm nn"><strong class="lz iu">  let signed = null;<br/>  try {<br/>    signed = await signData(data);<br/>  } catch (err) {<br/>    return setState({ status: "Signature error ğŸ”‘" });<br/>  }</strong></span><span id="fb41" class="nj mj it lz b gy no nl l nm nn"><strong class="lz iu">  try {<br/>    const saved = await sendData(signed);<br/>    setState({ status: "ok âœ…" });<br/>  } catch (err) {<br/>    return setState({ status: "Could not save data ğŸ’¾" });<br/>  }</strong><br/>}</span></pre><p id="6261" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸ªäººæ¥è¯´:â€œæˆ‘ä¸æ˜¯<code class="fe lw lx ly lz b">let</code>çš„è¶…çº§ç²‰ä¸ï¼Œæ›´ä¸æ˜¯<code class="fe lw lx ly lz b">var</code>çš„ç²‰ä¸ã€‚â€é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼äºGoæˆ–Swiftçš„è¯­æ³•å®ç°åŒæ ·çš„ç»“æœå—ï¼Ÿ</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="117f" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">æˆ‘çš„å»ºè®®æ˜¯:ä½œä¸ºåå«æ¥çƒ</h1><p id="59f5" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">å¦‚æœæˆ‘ä»¬æ•æ‰åˆ°é”™è¯¯ï¼Œç”¨ä»»ä½•éœ€è¦çš„å‰¯ä½œç”¨å¤„ç†å®ƒï¼Œç„¶åæŠ›å‡ºä¸€ä¸ªç”¨æˆ·å‹å¥½çš„é”™è¯¯ï¼Œæˆ‘ä»¬å¯ä»¥ç¨åå‘ç”¨æˆ·æ˜¾ç¤ºï¼Œé‚£ä¹ˆåœ¨JavaScriptä¸­å¯èƒ½æœ‰ç±»ä¼¼äº<em class="ma"> guardå­å¥</em>çš„è¯­æ³•ã€‚</p><pre class="kj kk kl km gt nf lz ng nh aw ni bi"><span id="9b8e" class="nj mj it lz b gy nk nl l nm nn">async function handleClick() {<br/>  try {<br/>    const data = await fetchData()<strong class="lz iu">.catch(err =&gt; {<br/>      throw new Error("Network error ğŸ”Œ");<br/>    });</strong><br/>    const signed = await signData(data)<strong class="lz iu">.catch(err =&gt; {<br/>      throw new Error("Signature error ğŸ”‘");<br/>    });</strong><br/>    const saved = await sendData(signed)<strong class="lz iu">.catch(err =&gt; {<br/>  </strong>    // Report error or any side effect.<strong class="lz iu"><br/>      throw new Error("Could not save data ğŸ’¾");<br/>    });</strong><br/>    setState({ status: "ok <strong class="lz iu">âœ…</strong>" });<br/>  } catch (err) {<br/>    setState({ status: err.message });<br/>  }<br/>}</span></pre><p id="fda5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è·³è¿‡åŒ…è£…<code class="fe lw lx ly lz b">try/catch</code>ä¹Ÿæ˜¯å¯èƒ½çš„ï¼Œä½†æ˜¯è¿™å°†ä½¿è¿™ä¸ªæ‰¿è¯ºæ— æ³•å¤„ç†ã€‚</p><p id="7ad1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™å¯èƒ½ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºä»£ç æ˜¯å¼‚æ­¥çš„ã€‚æ­¤å¤–ï¼Œè¿™ä¸ä¼šä¸­æ–­ä»»ä½•React.jsåº”ç”¨ç¨‹åºçš„å‘ˆç°ï¼Œä¹Ÿä¸ä¼šä»¥é”™è¯¯ä»£ç é€€å‡ºä»»ä½•<a class="ae ky" href="https://nodejs.org/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>è„šæœ¬ã€‚</p><p id="1ada" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™é‡Œæœ‰ä¸€ä¸ªä½¿ç”¨<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comma_Operator" rel="noopener ugc nofollow" target="_blank">é€—å·æ“ä½œç¬¦</a>çš„ä¾‹å­(å®ƒæ›´ç®€å•ï¼Œä½†æ˜¯çŸ¥é“å®ƒçš„äººä¸å¤š):</p><pre class="kj kk kl km gt nf lz ng nh aw ni bi"><span id="677f" class="nj mj it lz b gy nk nl l nm nn">async function handleClick() {<br/>  const data = await fetchData().catch(err =&gt; {<br/><strong class="lz iu">    throw (setState({ status: "Network error ğŸ”Œ" }), err);</strong><br/>  });<br/>  const signed = await signData(data).catch(err =&gt; {<br/><strong class="lz iu">    throw (setState({ status: "Signature error ğŸ”‘" }), err);</strong><br/>  });<br/>  const saved = await sendData(signed).catch(err =&gt; {<br/>    // Report error or any side effect.<br/><strong class="lz iu">    throw (setState({ status: "Could not save data ğŸ’¾" }), err);</strong><br/>  });<br/>  setState({ status: "ok <strong class="lz iu">âœ…</strong>" });<br/>}</span></pre><p id="2bdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‚¨å¯èƒ½éœ€è¦ç¦ç”¨ESLintè§„åˆ™,ä»¥ä¾¿åœ¨æ²¡æœ‰è­¦å‘Šçš„æƒ…å†µä¸‹ä½¿ç”¨é€—å·è¿ç®—ç¬¦ã€‚</p><p id="2ccf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">äº‹å®ä¸Šï¼Œä½ å¯ä»¥åœ¨JavaScriptä¸­æŠ›å‡ºä»»ä½•å€¼ã€å¯¹è±¡ï¼Œç”šè‡³<code class="fe lw lx ly lz b">undefined</code>(è§<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/throw" rel="noopener ugc nofollow" target="_blank"> MDN </a>)ã€‚ç†è®ºä¸Šä½ ç”šè‡³å¯ä»¥æŠ›å‡º<code class="fe lw lx ly lz b">setState</code>çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯<code class="fe lw lx ly lz b">void</code>:</p><pre class="kj kk kl km gt nf lz ng nh aw ni bi"><span id="4ba4" class="nj mj it lz b gy nk nl l nm nn">async function handleClick() {<br/>  const data = await fetchData().catch(err =&gt; {<br/>    throw setState({ status: "Network error <strong class="lz iu">ğŸ”Œ</strong>" }); // <strong class="lz iu">throw void;</strong><br/>  });<br/>  // ...<br/>  setState({ status: "ok <strong class="lz iu">âœ…</strong>" });<br/>}</span></pre><p id="fe67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨æˆ‘çœ‹æ¥ï¼Œå°±å…¼å®¹æ€§å’Œæ ‡å‡†åŒ–è€Œè¨€ï¼Œæœ€å¥½åšæŒä½¿ç”¨åŸç”Ÿçš„<code class="fe lw lx ly lz b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error" rel="noopener ugc nofollow" target="_blank">Error</a></code> <a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error" rel="noopener ugc nofollow" target="_blank">å¯¹è±¡</a>ã€‚</p><p id="9c7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸åº”è¯¥æŠ›å‡ºç©ºå€¼çš„å¦ä¸€ä¸ªåŸå› æ˜¯ï¼Œæ‚¨ä¼šä¸¢å¤±å…³äºé”™è¯¯çš„ä¿¡æ¯ï¼Œå› æ­¤è°ƒè¯•å˜å¾—æ›´åŠ å›°éš¾ã€‚</p><p id="8e39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿæƒ³è¿‡åƒ<code class="fe lw lx ly lz b">setState</code>ä¸€æ ·è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè®©å®ƒçœ‹èµ·æ¥æ›´åƒGoã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:</p><pre class="kj kk kl km gt nf lz ng nh aw ni bi"><span id="19d4" class="nj mj it lz b gy nk nl l nm nn"><strong class="lz iu">async function p(promise) {<br/>  return promise<br/>    .then(result =&gt; [result, null])<br/>    .catch(err =&gt; [null, err]);<br/>}</strong></span><span id="9168" class="nj mj it lz b gy no nl l nm nn">async function handleClick() {<br/>  <strong class="lz iu">const [data, err0] = await p(fetchData());</strong><br/>  <strong class="lz iu">if (err0) {</strong><br/>    return setState({ status: "Network error <strong class="lz iu">ğŸ”Œ</strong>" });<br/>  <strong class="lz iu">}</strong></span><span id="2d6d" class="nj mj it lz b gy no nl l nm nn"><strong class="lz iu">  const [signed, err1] = await p(signData());</strong><br/><strong class="lz iu">  if (err1) {</strong><br/>    return setState({ status: "Signature error <strong class="lz iu">ğŸ”‘</strong>" });<br/>  <strong class="lz iu">}</strong></span><span id="8d85" class="nj mj it lz b gy no nl l nm nn">  // ...</span><span id="bc9b" class="nj mj it lz b gy no nl l nm nn">  setState({ status: "ok <strong class="lz iu">âœ…</strong>" });<br/>}</span></pre><p id="f1db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æœ€ç»ˆï¼Œæœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å®ç°ç›¸åŒçš„ç»“æœ:ä¸€ä¸ªä¸ºç”¨æˆ·å’Œå·¥ç¨‹å›¢é˜Ÿä»¥å¹²å‡€ã€ç›´è§‚çš„æ–¹å¼å¤„ç†é”™è¯¯çš„ç¼–ç¨‹æµç¨‹ã€‚</p><p id="6c00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›é€‰é¡¹ä¸­çš„æ¯ä¸€ä¸ªå¹¶å°†å®ƒä»¬æ··åˆèµ·æ¥ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥å¾—åˆ°é€‚åˆæ‚¨çš„ä»£ç åº“çš„ä¸œè¥¿ã€‚è¿™ä¹Ÿé€‚ç”¨äºæœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºï¼Œå¦‚<a class="ae ky" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express.js </a>æˆ–<a class="ae ky" href="https://koajs.com/" rel="noopener ugc nofollow" target="_blank"> Koa.js </a>ã€‚</p><p id="51bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸æ­¤åŒæ—¶ï¼Œæˆ‘å°†åšæŒç”¨<em class="ma">æ¥çƒå½“åå«</em>çš„æ–¹æ³•ã€‚</p></div></div>    
</body>
</html>