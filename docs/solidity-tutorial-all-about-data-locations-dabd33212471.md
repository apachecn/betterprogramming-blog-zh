# åšå®žåº¦æ•™ç¨‹:å…³äºŽæ•°æ®ä½ç½®çš„æ‰€æœ‰å†…å®¹

> åŽŸæ–‡ï¼š<https://betterprogramming.pub/solidity-tutorial-all-about-data-locations-dabd33212471>

## æ·±å…¥äº†è§£å­˜å‚¨ã€å†…å­˜å’Œå‘¼å«æ•°æ®

![](img/4fae876bf99621b58effb146ba6145ed.png)

Ant Rozetski åœ¨ Unsplash ä¸Šæ‹æ‘„çš„ç…§ç‰‡

> è¿™æ˜¯ä¸€ç¯‡å†—é•¿ã€è¯¦ç»†ã€æ·±å…¥çš„é˜…è¯»ã€‚ä½†æ˜¯ä¸è¦å®³æ€•ã€‚åä¸‹æ¥å–æ¯å’–å•¡æˆ–ä½ æœ€å–œæ¬¢çš„é¥®æ–™ã€‚ä¸€åˆ‡éƒ½ä¼šå¥½çš„ã€‚
> 
> è¯·å‚è§ä¸‹é¢çš„â€œç›®å½•â€éƒ¨åˆ†ï¼Œè·³è½¬åˆ°æ‚¨æ„Ÿå…´è¶£çš„éƒ¨åˆ†ã€‚

ä»Šå¤©ï¼Œæˆ‘ä»¬æŽ¢ç´¢ä¸€ä¸ªæ–°çš„å’ŒåŸºæœ¬çš„éƒ¨åˆ†:æ•°æ®ä½ç½®ã€‚å…·æœ‰æŒ‘æˆ˜æ€§çš„è¯é¢˜ã€‚éžå¸¸ä½Žçº§ï¼Œå› ä¸ºå®ƒæ¶‰åŠä»¥å¤ªåŠè™šæ‹Ÿæœº(EVM)çš„æž¶æž„ã€‚

ä½†æ˜¯é€šè¿‡ç±»æ¯”ï¼Œæˆ‘ä»¬æ€»èƒ½æ›´å¥½åœ°ç†è§£å¤æ‚çš„ç¼–ç¨‹æ¦‚å¿µã€æž¶æž„ã€æ™ºèƒ½åˆçº¦å’Œä¸€èˆ¬çš„åŒºå—é“¾ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œå¦‚æžœ EVM æ˜¯ä¸€ä¸ªâ€œå·¨å¤§çš„å·¥ä¸šå·¥åŽ‚â€ï¼Œæˆ‘ä»¬å°†é€šè¿‡æŸ¥çœ‹å®ƒæ¥äº†è§£æ¯ä¸ªæ•°æ®ä½ç½®(ä¸è¦æ‹…å¿ƒï¼Œæ‚¨å°†åœ¨ä¸‹é¢çœ‹åˆ°ï¼Œæˆ‘å¸Œæœ›æˆ‘èƒ½å¸®åŠ©æ‚¨ç†è§£)ã€‚

ç„¶åŽï¼Œæˆ‘ä»¬å°†è¿›å…¥ Solidity ä»£ç ï¼Œå­¦ä¹ å¼•ç”¨ç±»åž‹çš„æ¯ä¸ªæ•°æ®ä½ç½®çš„è§„åˆ™å’Œè¡Œä¸ºã€‚æ‰€æœ‰è¿™äº›éƒ½ç”±æ‚¨å¯èƒ½çŸ¥é“çš„æµè¡Œé¡¹ç›®çš„ç»˜å›¾ã€æž¶æž„å›¾ã€ä»£ç ç‰‡æ®µå’Œæºä»£ç ç¤ºä¾‹æ¥æ”¯æŒã€‚

> è¯¥å­æ–‡ç« ç³»åˆ—åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†:
> 
> [-ç¬¬ä¸€éƒ¨åˆ†:æ‰€æœ‰å…³äºŽå­˜å‚¨](https://jeancvllr.medium.com/all-about-solidity-data-locations-part-i-storage-e50604bfc1ad)
> [-ç¬¬äºŒéƒ¨åˆ†:æ‰€æœ‰å…³äºŽå†…å­˜](https://jeancvllr.medium.com/solidity-tutorial-all-about-memory-1e1696d71ee4)
> [-ç¬¬ä¸‰éƒ¨åˆ†:æ‰€æœ‰å…³äºŽ Calldata](/solidity-tutorial-all-about-calldata-aebbe998a5fc)
> [-ç¬¬å››éƒ¨åˆ†:æ‰€æœ‰å…³äºŽå †æ ˆ](/solidity-tutorial-all-about-stack-c1ec6070fe60)
> [-ç¬¬äº”éƒ¨åˆ†:æ‰€æœ‰å…³äºŽä»£ç ](https://jeancvllr.medium.com/solidity-tutorial-all-about-code-10889b88632f)

# ç›®å½•

*   ä»‹ç»
*   ä¸ºä»€ä¹ˆè¦äº†è§£ Solidity ä¸­çš„ EVM æ•°æ®ä½ç½®ï¼Ÿ
*   æ•°æ®ä½ç½®â†’æ¦‚è¿°
*   æ•°æ®ä½ç½®â†’è§„åˆ™
*   å‡½æ•°å‚æ•°çš„è§„åˆ™
*   å‡½æ•°ä½“çš„è§„åˆ™
*   æ•°æ®ä½ç½®â†’è¡Œä¸º
*   æ˜ å°„çš„(è¾¹ç¼˜)æƒ…å½¢
*   ç»“è®º
*   å‚è€ƒ

# ä»‹ç»

ä½œä¸ºä¸€ä¸ªå¯¹äº‹ä¸šå……æ»¡çƒ­æƒ…çš„äººï¼Œä¸€ä¸ªå·¥ä¸šç‚‰çš„å»ºé€ è€…å’Œæ”¹é©è€…ï¼Œæˆ‘çš„çˆ¶äº²å†³å®šé€æˆ‘åŽ»å·¥åŽ‚å·¥ä½œã€‚

éžå¸¸å¤§çš„ï¼ç†”åŒ–å’Œåˆ¶é€ é’¢é“å’Œé“çš„å·¥åŽ‚(Arcelor Mittal å’Œ Constellium)ã€‚

ä½ éœ€è¦ä¸€è¾†è½¦å¾€è¿”äºŽå·¥åŽ‚çš„ä¸åŒåŒºåŸŸï¼Œæ¯”å¦‚é’¢é“åŽ‚å’Œè½§é’¢åŽ‚ã€‚

![](img/60a53b468dfb6556e7312722e90be3b6.png)

[è¿™æ˜¯å–è‡ª StackExchange](https://ethereum.stackexchange.com/questions/268/ethereum-block-architecture) çš„ä»¥å¤ªåŠå’Œ EVM å»ºç­‘çš„ä»£è¡¨å›¾

![](img/ab9402ed6780719791c4436328e1252f.png)

å°±åƒ EVM å»ºç­‘çš„ç¤ºæ„å›¾ä¸€æ ·ï¼Œå®‰èµ›ä¹ç±³å¡”å°”å·¥åŽ‚çš„é“è·¯å¹³é¢å›¾ä¸€å¼€å§‹æ˜¯å¾ˆéš¾ç†è§£çš„ï¼

æˆ‘è¿˜è®°å¾—çš„æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è¿›å…¥åŒ…å«è½§æœºçš„[æœºåº“æ—¶çš„ååº”(çœ‹è§†é¢‘é“¾æŽ¥ï¼).](https://www.youtube.com/watch?v=kiyIaKynqsU)å·¥ä¸šç‚‰å·¨å¤§æ— æ¯”ï¼Œä»Žä¸€å¤´èµ°åˆ°å¦ä¸€å¤´éœ€è¦å‡ åˆ†é’Ÿï¼

æœºåº“é‡ŒæŒ¤æ»¡äº†å…¶ä»–å»ºç­‘å·¥äººã€ç“¦å·¥ã€ç”µå·¥ã€å››å¤„ç§»åŠ¨å’Œè¡Œé©¶çš„å‰è½¦ï¼Œä»¥åŠç”¨å·¨å¤§çš„æœºæ¢°è‡‚æŽ§åˆ¶æœºå™¨å°†ä¸œè¥¿æ¬è¿›æ¬å‡ºç†”ç‚‰çš„äººã€‚

åƒæˆ‘çˆ¶äº²ä¸€æ ·ï¼Œæˆ‘æ˜¯ä¸€ä¸ªä¸åŒç±»åž‹çš„å»ºè®¾è€…ï¼Œäººä»¬åœ¨ web3 ä¸­ç§°ä¹‹ä¸ºâ€œå»ºè®¾è€…â€ã€‚ä½†æ˜¯å½“æˆ‘å›žå¤´çœ‹è¿™åº§å·¥åŽ‚æ—¶ï¼Œæˆ‘å‘çŽ°å®ƒçš„å†…éƒ¨å’Œ EVM çš„å†…éƒ¨æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ã€‚

ææ–™è¢«å‚¨å­˜åœ¨è®¸å¤šä¸åŒçš„åœ°æ–¹ï¼Œä»Žæž¶å­ä¸Šæ‹¿ä¸‹æ¥ï¼Œæ”¾è¿›ç‚‰å­å’Œå…¶ä»–éšæœºçš„æœºå™¨é‡Œã€‚å®ƒä»¬ä¼šè¢«èžåŒ–ã€åŠ å·¥æˆ–å¤„ç†ã€‚

## EVM æ˜¯ä¸€ä¸ªå·¥ä¸šå·¥åŽ‚

![](img/732ac18f1dc30168f4e49e90c8f4c0c5.png)

ç”±[å¸•ç‰¹é‡Œå…‹Â·äº¨åˆ©](https://unsplash.com/@worldsbetweenlines)åœ¨ Unsplash ä¸Šæ‹æ‘„çš„ç…§ç‰‡

åœ¨æˆ‘ä¹‹å‰çš„æ–‡ç« [â€œå…³äºŽ ABI çš„ä¸€åˆ‡â€](https://coinsbench.com/solidity-tutorial-all-about-abi-46da8b517e7)ä¸­ï¼Œæˆ‘æåˆ°:â€œèªæ˜Žçš„åˆåŒæ˜¯éžå¸¸æ”¾æ¾çš„å°ç”Ÿå‘½ã€‚â€

ä½†æ˜¯ä¸€æ—¦æ™ºèƒ½åˆçº¦è¢«è°ƒç”¨ï¼Œå®ƒä»¬å°±ä¼šå˜å¾—éžå¸¸æ´»è·ƒï¼å®ƒä»¬çš„åº•å±‚é€»è¾‘ä½œä¸ºå­—èŠ‚ç è¿è¡Œå¹¶è¢«æ‰§è¡Œã€‚å¤šäºäº† EVMã€‚

EVM ä»Žä¸æ”¾æ¾ã€‚å®ƒåœ¨æ¯å°è¿è¡Œè½¯ä»¶å®¢æˆ·ç«¯çš„æœºå™¨ä¸Šä¸æ–­é‡å¤è¿è¡Œã€‚è¿™æ˜¯ä¸ºäº†æ›´æ–°åŒºå—é“¾çš„çŠ¶æ€å¹¶ä½¿æ¯ä¸ªäººä¿æŒåŒæ­¥ã€‚

å¤§çš„å·¥ä¸šå·¥åŽ‚ä¹Ÿæ˜¯ä¸€æ ·ã€‚å®ƒä¸€å‘¨ 7 å¤©ï¼Œä¸€å¤© 24 å°æ—¶ä¸åœåœ°è¿è½¬ã€‚é—¨å£æ€»æ˜¯æœ‰äººï¼Œå¤œç­å·¥äººåœ¨æœºåº“é‡Œæ•´ç†ä¸œè¥¿ï¼Œå¡è½¦è¿›è¿›å‡ºå‡ºï¼Œæœºå™¨å’Œç†”ç‚‰åœ¨ç†”åŒ–ã€ç‡ƒçƒ§å’ŒåŠ å·¥æ›´å¤šçš„ææ–™ï¼Œ

å½“æ‚¨è°ƒç”¨æ™ºèƒ½åˆçº¦æ—¶ï¼ŒEVM è¿è¡Œå¹¶æ‰§è¡Œå­—èŠ‚ç ä¸­çš„æŒ‡ä»¤é›†(=æ“ä½œç )ã€‚è¿™äº›æ“ä½œç ä¸­çš„ä¸€äº›æŒ‡ä»¤ EVM ä»Ž/å‘ä¸åŒçš„ä½ç½®è¯»å–å’Œå†™å…¥æ•°æ®ã€‚EVM éœ€è¦è¿™äº›å¤šä¸ªæ•°æ®ä½ç½®æ¥æ­£ç¡®å®Œæˆå·¥ä½œã€‚

åœ¨å·¥åŽ‚ä¸­ï¼Œå·¥åºå’Œææ–™å¯ä»¥åœ¨å¤šä¸ªåœ°æ–¹æ‰¾åˆ°ã€‚

*   å‰è½¦ä»Žä½äºŽå·¥åŽ‚ä¸“ç”¨å­˜å‚¨åŒºçš„é«˜å¤§è´§æž¶ä¸ŠæŠ“å–ææ–™è°ƒè‰²æ¿ã€‚(åˆå**å­˜å‚¨**)
*   æ“ä½œå‘˜ä»ŽæŽ§åˆ¶å®¤æŽ§åˆ¶æœºå™¨å’Œæœºå™¨äººï¼Œå°†æ— æ³•é€šè¿‡ç‚‰é—¨çš„å¤§å—é’¢/é“ç ´ç¢Žæˆå°å—ã€‚(åˆå**å†…å­˜**)
*   å¾…åŠ å·¥çš„ææ–™é€šè¿‡è¿è¾“å·¥å…·(å¡è½¦æˆ–èˆ¹åª)è¿é€ï¼Œè£…åœ¨å¯†å°çš„å®¹å™¨ä¸­ï¼Œåœ¨å®¹å™¨ä¸­ä½ åªèƒ½çŸ¥é“/çœ‹åˆ°å†…å®¹ï¼Œä½†ä¸èƒ½è§¦æ‘¸ã€‚(åˆå**å‘¼å«æ•°æ®**)
*   å¤šäºäº†ä¼ é€å¸¦ï¼Œæ›´å¤šçš„ææ–™åœ¨å·¥åŽ‚é‡Œè¢«åŠ å·¥å’Œè¿è¾“ã€‚(åˆå**æ ˆ**)
*   æœ€åŽï¼Œå·¥åŽ‚æœ‰è‡ªå·±çš„é“è·¯äº¤é€šè§„åˆ™ã€‚é‡Œé¢å…¨æ˜¯è·¯æ ‡ï¼(åˆå**ä»£ç **)

ä½ æ˜Žç™½äº†ï¼Œå°±åƒä¸€ä¸ªå·¥åŽ‚ï¼ŒEVM ä½¿ç”¨è®¸å¤šä¸åŒçš„åŒºåŸŸæ¥è®¡ç®—å’Œå¤„ç†å·¥ä½œã€‚

> EVM å°±åƒä¸€ä¸ªå·¥ä¸šå·¥åŽ‚ã€‚

# ä¸ºä»€ä¹ˆè¦ç†è§£ Solidity ä¸­çš„ Evm æ•°æ®ä½ç½®ï¼Ÿ

å­¦ä¹ æ¯ä¸ªæ•°æ®ä½ç½®å¦‚ä½•å·¥ä½œæ¶‰åŠåˆ°å­¦ä¹ å¤šç§ä¸œè¥¿ï¼Œæ¯”å¦‚`storage`ã€`memory`å’Œ`calldata`çš„ç»“æž„å’Œå¸ƒå±€ï¼Œæˆ–è€…â€œä»€ä¹ˆå¯ä»¥å­˜å‚¨åœ¨å“ªé‡Œâ€

ä½†æœ€é‡è¦çš„æ˜¯ï¼Œå®ƒæ•™ä¼šäº†ä½ ä¸Žå®ƒä»¬ç›¸å…³çš„(æ°”ä½“)æˆæœ¬ï¼Œä»¥åŠæˆ‘æ‰€è¯´çš„å¯å˜æ€§/å®‰å…¨æ€§æƒè¡¡ã€‚

ä½œä¸ºä¸€å Solidity å¼€å‘äººå‘˜ï¼Œå¯¹ EVM ä¸­çš„æ•°æ®ä½ç½®ä»¥åŠå¦‚ä½•å……åˆ†åˆ©ç”¨å®ƒä»¬çš„è‰¯å¥½ç†è§£å°†ä½¿æ‚¨èƒ½å¤Ÿ:

1.  æé«˜æ™ºèƒ½åˆåŒçš„æ€§èƒ½ã€‚
2.  æœ€å°åŒ–å…¶æ‰§è¡Œæˆæœ¬(è°ƒç”¨å…¶å…¬å…±æˆ–å†…éƒ¨å‡½æ•°æ—¶ä½¿ç”¨çš„ gas)ã€‚
3.  åŠ å¼ºå®‰å…¨æ€§å¹¶é˜²æ­¢æ½œåœ¨çš„é”™è¯¯ã€‚

# æ•°æ®ä½ç½®â†’æ¦‚è¿°

æœ¬æ–‡æ—¨åœ¨å¯¹è¿™äº›ä¸åŒçš„æ•°æ®ä½ç½®ç»™å‡ºä¸€ä¸ªå¾ˆå¥½çš„æ¦‚è¿°ï¼Œåœ¨è¿™äº›ä½ç½®å¯ä»¥å†™å…¥å’Œè¯»å–æ•°æ®ã€‚æˆ‘ä»¬å°†çœ‹åˆ°ä¸€äº›ä½ç½®æ˜¯åªè¯»çš„ï¼Œä¸èƒ½è¢«å†™å…¥ï¼Œè€Œå¦ä¸€äº›ä½ç½®æ˜¯å¯å˜çš„ï¼Œå­˜å‚¨åœ¨å…¶ä¸­çš„å€¼å¯ä»¥è¢«ç¼–è¾‘ã€‚

EVM å¤„ç†äº”ä¸ªä¸»è¦æ•°æ®ä½ç½®:

*   å‚¨å­˜ï¼›å‚¨å¤‡
*   è®°å¿†
*   å‘¼å«æ•°æ®
*   å †
*   å¯†ç 

![](img/0570a4fa34f71ba1cb660d7ba30837ca.png)

EVM å¯ç”¨æ•°æ®ä½ç½®æ¦‚è¿°(æ¥æº:[Andreas Antonopoulos å’Œ Gavin Wood](https://github.com/ethereumbook/ethereumbook/blob/develop/13evm.asciidoc) çš„ã€ŠæŽŒæ¡ä»¥å¤ªåŠã€‹)ã€‚

ä¸»è¦ EVM æ•°æ®ä½ç½®çš„åŸºç¡€çŸ¥è¯†ä¹Ÿåœ¨[ä»¥å¤ªåŠé»„çš®ä¹¦çš„â€œ9)æ‰§è¡Œæ¨¡åž‹>åŸºç¡€çŸ¥è¯†â€ä¸€èŠ‚ä¸­æœ‰è¯¦ç»†è¯´æ˜Ž](https://ethereum.github.io/yellowpaper/paper.pdf)

![](img/81ca194cf0d6918db78bbc7771b22301.png)

## å‚¨å­˜ï¼›å‚¨å¤‡

![](img/db44c856140034f508f57df20236eb03.png)

æ™ºèƒ½åˆåŒä»“åº“ç›¸å½“äºŽå·¥ä¸šæœºåº“ä¸Šçš„è´§æž¶å•å…ƒ(æ¥æº:Unsplash ä¸Šçš„[æµ·ç‡•](https://unsplash.com/@petrebels)

åœ¨ä»¥å¤ªåŠä¸­ï¼Œç‰¹å®šåœ°å€çš„æ¯ä¸ªæ™ºèƒ½å¥‘çº¦éƒ½æœ‰è‡ªå·±çš„`storage`ï¼Œç”±ä¸€ä¸ªé”®å€¼å­˜å‚¨ç»„æˆï¼Œå°† 256 ä½å­—æ˜ å°„åˆ° 256 ä½å­—ã€‚å­˜å‚¨ä¸­çš„æ•°æ®åœ¨å‡½æ•°è°ƒç”¨å’Œäº‹åŠ¡ä¹‹é—´ä¿æŒä¸å˜ã€‚

å­˜å‚¨æ˜¯æ‰€æœ‰å¥‘çº¦çŠ¶æ€å˜é‡é©»ç•™çš„åœ°æ–¹ã€‚æ¯ä¸ªåˆåŒéƒ½æœ‰è‡ªå·±çš„å­˜å‚¨ç©ºé—´ã€‚å­˜å‚¨åœ¨å­˜å‚¨å™¨ä¸­çš„å˜é‡åœ¨å‡½æ•°è°ƒç”¨ä¹‹é—´ä¿æŒä¸å˜ã€‚ç„¶è€Œï¼Œè¿™ç§å­˜å‚¨ä½¿ç”¨èµ·æ¥ç›¸å½“æ˜‚è´µã€‚

å› ä¸ºå­˜å‚¨æŒ‡çš„æ˜¯çº¦å®šå­˜å‚¨ï¼Œæ‰€ä»¥å®ƒæŒ‡çš„æ˜¯æ°¸ä¹…å­˜å‚¨åœ¨åŒºå—é“¾ä¸Šçš„æ•°æ®ã€‚

æ‚¨å¯ä»¥å¯¹çº¦å®šå­˜å‚¨è¿›è¡Œè¯»å†™ã€‚åœ¨ä½Žçº§ï¼Œç”¨äºŽè¿™æ ·åšçš„ EVM æ“ä½œç æ˜¯`SSTORE`å’Œ`SLOAD`ã€‚

## è®°å¿†

![](img/abf27d668cdf04a15bb3d63abaf38eb1.png)

(æ¥æº:[è¥¿è’™Â·å¡æœæ‹‰](http://Simon Kadula)åœ¨ Unsplash ä¸Š)

EVM `memory`ç”¨äºŽä¿å­˜ä¸´æ—¶å€¼ï¼Œåœ¨å¤–éƒ¨å‡½æ•°è°ƒç”¨ä¹‹é—´è¢«æ“¦é™¤ã€‚ä¸è¿‡ï¼Œç”¨èµ·æ¥æ¯”è¾ƒä¾¿å®œã€‚

åœ¨ EVM ä¸­ï¼Œè®°å¿†æ˜¯æ˜“å˜çš„ï¼Œå¹¶ä¸”ç‰¹å®šäºŽç‰¹å®šåˆåŒçš„ä¸Šä¸‹æ–‡(çŽ¯å¢ƒ)ã€‚è¿™æ„å‘³ç€å½“æ‰§è¡Œä¸Šä¸‹æ–‡ä»Žä¸€ä¸ªåˆåŒå˜ä¸ºå¦ä¸€ä¸ªåˆåŒæ—¶ï¼Œç™½æ¿/ä¾¿ç¬ºç°¿è¢«æ¸…é™¤ã€‚æ¯æ¬¡è°ƒç”¨æ–°æ¶ˆæ¯æ—¶ï¼Œéƒ½ä¼šèŽ·å¾—ä¸€ä¸ªæ–°æ¸…é™¤çš„å†…å­˜å®žä¾‹ã€‚

å› æ­¤ï¼Œå†…å­˜å˜é‡æ˜¯ä¸´æ—¶çš„ã€‚å®ƒä»¬åœ¨å¯¹å…¶ä»–å¥‘çº¦çš„å¤–éƒ¨å‡½æ•°è°ƒç”¨ä¹‹é—´è¢«æ“¦é™¤ã€‚

ä½ å¯ä»¥è¯»å†™ EVM å­˜å‚¨å™¨ã€‚åœ¨ä½Žçº§ï¼Œå¯ç”¨äºŽä»Ž/å‘å­˜å‚¨å™¨è¯»å–å’Œå†™å…¥çš„ EVM æ“ä½œç æ˜¯`MLOAD`ã€`MSTORE`å’Œ`MSTORE8`ã€‚

æŸäº› EVM æ“ä½œç ï¼Œå¦‚`CALL`ã€`DELEGATECALL`æˆ–`STATICCALL`ï¼Œä»Ž EVM å­˜å‚¨å™¨ä¸­æ¶ˆè€—å®ƒä»¬çš„å‚æ•°ã€‚

## å‘¼å«æ•°æ®

![](img/4070ba5906a9e44c19e49c0c1ee21c63.png)

calldata ç›¸å½“äºŽä»Žèˆ¹æˆ–å¡è½¦ä¸­å–å‡ºçš„å®¹å™¨ã€‚è¿™äº›å®¹å™¨è£…æœ‰é€åˆ°å·¥åŽ‚è¿›è¡ŒåŠ å·¥çš„ææ–™ã€‚Calldata æ˜¯åªè¯»çš„ã€‚

`calldata`æ˜¯å­˜æ”¾äº‹åŠ¡æ•°æ®æˆ–å¤–éƒ¨å‡½æ•°è°ƒç”¨å‚æ•°çš„åœ°æ–¹ã€‚è¿™æ˜¯ä¸€ä¸ªåªè¯»æ•°æ®ä½ç½®ã€‚ä½ ä¸èƒ½å†™å®ƒã€‚

calldata çš„è¡Œä¸ºå¾ˆåƒå†…å­˜ï¼Œæ˜¯ä¸€ä¸ªå­—èŠ‚å¯å¯»å€çš„ç©ºé—´ã€‚æ‚¨å¿…é¡»ä¸ºè¦è¯»å–çš„å­—èŠ‚æ•°æŒ‡å®šä¸€ä¸ªç²¾ç¡®çš„å­—èŠ‚åç§»é‡ã€‚

åœ¨ä½Žå±‚ï¼Œå¯ç”¨äºŽè¯»å– calldata çš„ EVM æ“ä½œç æœ‰`CALLDATALOAD`ã€`CALLDATASIZE`å’Œ`CALLDATACOPY`ã€‚

## å †

![](img/42d53514d3ba9604bba1e2f47e914469.png)

(æ¥æº:Unsplash ä¸Šçš„ [Arno Senoner](https://unsplash.com/@arnosenoner)

å †æ ˆç”¨äºŽä¿å­˜å°çš„å±€éƒ¨å˜é‡ã€‚å®ƒå‡ ä¹Žå¯ä»¥å…è´¹ä½¿ç”¨(ä½¿ç”¨éžå¸¸å°‘é‡çš„æ°”ä½“)ï¼Œä½†ä½“ç§¯æœ‰é™ï¼Œåªèƒ½å®¹çº³æœ‰é™æ•°é‡çš„ç‰©å“ã€‚

å †æ ˆæ˜¯å‡½æ•°å†…éƒ¨åˆ›å»ºçš„å¤§éƒ¨åˆ†å±€éƒ¨å˜é‡æ‰€åœ¨çš„åœ°æ–¹ã€‚å®ƒæ˜¯ EVM çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚

åœ¨ä½Žå±‚ï¼Œå¯ç”¨äºŽæ“ä½œå †æ ˆçš„ EVM æ“ä½œç æ˜¯`PUSH`ã€`POP`ã€`SWAP`å’Œ`DUP`æŒ‡ä»¤ã€‚å¤§å¤šæ•°å…¶ä»– EVM æ“ä½œç ä»Žå †æ ˆä¸­ä½¿ç”¨å®ƒ(é€šè¿‡å°†å®ƒä»¬ä»Žå †æ ˆä¸­å–å‡º)å¹¶å°†ç»“æžœæŽ¨å›žåˆ°å †æ ˆä¸­ã€‚

## å¯†ç 

![](img/fcb383445f5fa35916d48aa61d922a22.png)

(æ¥æº:[ç“¦å°”å¾·é©¬å°”Â·å¸ƒå…°ç‰¹](https://unsplash.com/@waldemarbrandt67w)åœ¨ Unsplash ä¸Š)

ä»£ç æŒ‡çš„æ˜¯åˆåŒå­—èŠ‚ç ã€‚ä½ åªèƒ½ä»ŽåˆåŒå­—èŠ‚ç ä¸­è¯»å–ï¼Œä¸èƒ½å†™å…¥ã€‚è¿™é€šå¸¸æ˜¯ä½ å¯ä»¥åœ¨ Solidity ä¸­æ‰¾åˆ°å®šä¹‰ä¸º`constant`çš„å˜é‡çš„åœ°æ–¹ã€‚å¤§å¤šæ•° EVM æ“ä½œç ä»Žå †æ ˆä¸­æ¶ˆè€—å®ƒä»¬çš„å‚æ•°ã€‚

å­—èŠ‚ç åŒ…å«è®¸å¤šå…³äºŽå¥‘çº¦çš„ä¿¡æ¯å’Œé€»è¾‘ï¼ŒåŒ…æ‹¬è°ƒåº¦ç¨‹åºå’Œå¥‘çº¦å…ƒæ•°æ®ã€‚

åœ¨ä½Žå±‚ï¼Œå¯ä»¥ç”¨æ¥ä»Žæ™ºèƒ½åˆçº¦çš„ä»£ç ä¸­è¯»å–çš„ EVM æ“ä½œç æ˜¯`CODESIZE`å’Œ`CODECOPY`ã€‚æ“ä½œç `EXTERNALCODESIZE`å’Œ`EXTERNALCODECOPY`ã€‚

![](img/40c9e34958b565ffc370e35dc3bd7422.png)

æ¥æº:[https://github . com/CJ42/All-About-Solidity/blob/Data-locations/articles/Data-locations . MD](https://github.com/CJ42/All-About-Solidity/blob/data-locations/articles/Data-Locations.md)

# æ•°æ®ä½ç½®â€”è§„åˆ™

## å˜é‡çš„é»˜è®¤ä½ç½®

Solidity è¯­è¨€å®šä¹‰äº†ä¸€äº›ç¼ºçœè§„åˆ™ï¼Œæ ¹æ®å®šä¹‰å˜é‡çš„ä½ç½®ï¼Œç¼ºçœæƒ…å†µä¸‹å˜é‡åº”è¯¥ä½äºŽä»€ä¹ˆä½ç½®ã€‚

*   å˜é‡å®šä¹‰ä¸º`constant` =åˆåŒä»£ç (=å­—èŠ‚ç )ã€‚

è¿™äº›å˜é‡æ˜¯ä¸å¯å˜çš„ï¼Œä¸€æ—¦éƒ¨ç½²äº†å¥‘çº¦ï¼Œå°±ä¸èƒ½æ›´æ”¹ã€‚å®ƒä»¬æ˜¯åªè¯»çš„ï¼Œå¯ä»¥å†…è”ã€‚

*   é»˜è®¤æƒ…å†µä¸‹ï¼ŒçŠ¶æ€å˜é‡(åœ¨å‡½æ•°å¤–éƒ¨å£°æ˜Ž)=åœ¨å­˜å‚¨ä¸­ã€‚

è¿™äº›è¢«ç§°ä¸ºçŠ¶æ€å˜é‡ï¼Œå› ä¸ºå®ƒä»¬æ˜¯å¥‘çº¦çŠ¶æ€çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯ä¸–ç•ŒçŠ¶æ€çš„ä¸€éƒ¨åˆ†ã€‚è¿™äº›å˜é‡è¢«æ°¸ä¹…å†™å…¥åŒºå—é“¾ã€‚

*   å †æ ˆä¸­çš„å±€éƒ¨å˜é‡(åœ¨å‡½æ•°ä½“å†…å£°æ˜Ž)ã€‚

å€¼ç±»åž‹çš„å˜é‡(ä¾‹å¦‚ï¼Œ`uint256`ã€`bytes8`ã€`address`)é©»ç•™åœ¨å †æ ˆä¸­ã€‚

å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨ä¸éœ€è¦ä½¿ç”¨æ•°æ®ä½ç½®å…³é”®å­—(storageã€memory æˆ– calldata)ï¼Œå› ä¸º Solidity é€šè¿‡ä¸Šé¢è§£é‡Šçš„é»˜è®¤è§„åˆ™æ¥å¤„ç†ä½ç½®ã€‚

ä½†æ˜¯ï¼Œæœ‰æ—¶æ‚¨ç¡®å®žéœ€è¦ä½¿ç”¨è¿™äº›å…³é”®å­—å¹¶æŒ‡å®šæ•°æ®ä½ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å¤„ç†å¤æ‚ç±»åž‹çš„å˜é‡(å¦‚å‡½æ•°å†…éƒ¨çš„ struct å’Œ arrays)æ—¶ã€‚

## å‚è€ƒç±»åž‹

å¯¹äºŽæ•°ç»„(å›ºå®šæˆ–åŠ¨æ€å¤§å°çš„æ•°ç»„ï¼Œå¦‚`uint256[]`)ã€`bytes`ã€`string`ã€struct å’Œ mappingsï¼Œæ‚¨å¿…é¡»æ˜¾å¼åœ°æä¾›å­˜å‚¨å€¼çš„æ•°æ®åŒºåŸŸã€‚è¿™å¯ä»¥æ˜¯`storage`ã€`memory`æˆ–`calldata`ã€‚

é€šè¿‡ä½¿ç”¨è¿™äº›å…³é”®å­—ä¹‹ä¸€ï¼Œæ‚¨åˆ›å»ºäº†ä¸€ä¸ª`reference`ç±»åž‹çš„å˜é‡ã€‚è¿™ç§ç±»åž‹å¿…é¡»æ¯”å€¼ç±»åž‹æ›´å°å¿ƒå¤„ç†ã€‚

ä¸‹ä¸€ä¸ªè‡ªç„¶ä¼šå‡ºçŽ°çš„é—®é¢˜æ˜¯:

> ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å…³é”®å­—**å­˜å‚¨**ã€**å†…å­˜ã€**å’Œ**è°ƒç”¨æ•°æ®**ï¼Ÿ

> åœ¨ Solidity 0.5.0 ä¹‹å‰ï¼Œå½“å˜é‡ä½œä¸ºå‡½æ•°å‚æ•°ä¼ é€’æ—¶ï¼Œå¯ä»¥ä¸æŒ‡å®šå¤æ‚ç±»åž‹å˜é‡(*å¦‚åŠ¨æ€å¤§å°æ•°ç»„*)çš„æ•°æ®ä½ç½®ã€‚

**æ‚¨å¯ä»¥åœ¨å“ªé‡ŒæŒ‡å®šæ•°æ®ä½ç½®ï¼Ÿ**

åªèƒ½åœ¨å‡½æ•°ä¸­çš„ä¸‰ä¸ªä½ç½®æŒ‡å®šå¼•ç”¨å˜é‡çš„æ•°æ®ä½ç½®:

*   a)å¯¹äºŽå‚æ•°(=å‡½æ•°å®šä¹‰)
*   b)å¯¹äºŽå‡½æ•°(=å‡½æ•°ä½“)å†…éƒ¨çš„å±€éƒ¨å˜é‡
*   c)è¿”å›žå€¼æ€»æ˜¯åœ¨å†…å­˜ä¸­(=å‡½æ•°å®šä¹‰)ã€‚

# å‡½æ•°å‚æ•°çš„è§„åˆ™

![](img/8d66ed0511dea202bcf22e0fd589f31a.png)

æ¥æº:[https://github . com/CJ42/All-About-Solidity/blob/Data-locations/articles/Data-locations . MD # Data-location-rules-for-function-parameters](https://github.com/CJ42/All-About-Solidity/blob/data-locations/articles/Data-Locations.md#data-location-rules-for-function-parameters)

å½“`storage`ç”¨ä½œå‡½æ•°å‚æ•°çš„å¼•ç”¨æ—¶ï¼Œå®ƒæ˜¯æŒ‡å‘å¥‘çº¦å­˜å‚¨çš„æŒ‡é’ˆã€‚

åŒæ ·é€‚ç”¨äºŽ`memory`å’Œ`calldata`ã€‚æ­¤ç±»å…³é”®å­—åˆ›å»ºæŒ‡å‘ EVM å­˜å‚¨å™¨ä¸­æŸä¸ªä½ç½®çš„æŒ‡é’ˆï¼Œæˆ–è€…æ¥è‡ªäº‹åŠ¡çš„è¾“å…¥æ•°æ®å­—æ®µ(= calldata)ã€‚

# å‡½æ•°ä½“çš„è§„åˆ™

åœ¨å‡½æ•°å†…éƒ¨ï¼Œå¯ä»¥æŒ‡å®šæ‰€æœ‰ä¸‰ä¸ªæ•°æ®ä½ç½®ï¼Œè€Œä¸ç®¡å‡½æ•°çš„å¯è§æ€§å¦‚ä½•ã€‚

ä½†æ˜¯ï¼Œå¼•ç”¨ç±»åž‹ä¹‹é—´çš„èµ‹å€¼è¢«ç»‘å®šåˆ°ç‰¹å®šçš„è§„åˆ™ã€‚(è¿™é‡Œæ˜¯å®ƒå˜å¾—å¤æ‚å’Œâ€œè½»å¾®çš„èˆŒå¤´æ‰­æ›²ï¼â€).

*   `storage`å¼•ç”¨:æ€»æ˜¯å¯ä»¥ç›´æŽ¥ä»Žå¥‘çº¦å­˜å‚¨å™¨(=çŠ¶æ€å˜é‡)æˆ–é€šè¿‡å¦ä¸€ä¸ª`storage`å¼•ç”¨åˆ†é…ä¸€äº›å€¼ï¼Œä½†ä¸èƒ½åˆ†é…ç»™å®ƒä»¬`memory`æˆ–`calldata`å¼•ç”¨
*   `memory`å¼•ç”¨:å¯ä»¥èµ‹ä»»ä½•ä¸œè¥¿(ç›´æŽ¥çŠ¶æ€å˜é‡ï¼Œæˆ–è€…`storage`ã€`memory`æˆ–`calldata`å¼•ç”¨)ã€‚è¿™æ€»æ˜¯ä¼šåˆ›å»ºä¸€ä¸ªå‰¯æœ¬ã€‚
*   `calldata`å¼•ç”¨:å¯ç›´æŽ¥(= tx/æ¶ˆæ¯è°ƒç”¨è¾“å…¥)æˆ–é€šè¿‡å¦ä¸€ä¸ª`calldata`å¼•ç”¨ä»Žè°ƒç”¨æ•°æ®ä¸­åˆ†é…ä¸€äº›å€¼ï¼Œä½†ä¸èƒ½åˆ†é…ç»™å®ƒä»¬ä¸€ä¸ª`storage`æˆ–`memory`å¼•ç”¨

æ›´ç®€å•åœ°è¯´:

> For memory =æˆ‘ä»¬æ€»æ˜¯å¯ä»¥å¤åˆ¶å†…å­˜ä¸­çš„ä»»ä½•æ•°æ®(æ— è®ºæ˜¯æ¥è‡ªå¥‘çº¦çš„å­˜å‚¨è¿˜æ˜¯è°ƒç”¨æ•°æ®)ã€‚
> 
> å¯¹äºŽ storage å’Œ calldata =æˆ‘ä»¬åªèƒ½åˆ†é…æ¥è‡ªæŒ‡å®šæ•°æ®ä½ç½®çš„å€¼(ç›´æŽ¥æˆ–é€šè¿‡ç›¸åŒç±»åž‹çš„å¼•ç”¨)ã€‚

è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€äº›çœŸå®žè€Œå®žç”¨çš„å¯é æ€§ç¤ºä¾‹:

![](img/76481c0d98cce4a6e777806507a4fe77.png)![](img/76aff85baaa773bac54ba907e6a38efe.png)![](img/467e9337c7ffc9bdd028ef3e5ab9609d.png)

[ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä¸€ä»½ä½œä¸ºå¯é æ€§åˆåŒçš„æ‘˜è¦ã€‚](https://github.com/CJ42/All-About-Solidity/blob/master/articles/data-locations/DataLocationsReferences.sol)

## **å†…å­˜â†çŠ¶æ€å˜é‡**

å½“æˆ‘ä»¬å°†ä¸€ä¸ªçŠ¶æ€å˜é‡èµ‹ç»™ä¸€ä¸ª`memory`å¼•ç”¨çš„å˜é‡æ—¶ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šæ˜¯å°†æ•°æ®ä»Žå­˜å‚¨å™¨å¤åˆ¶åˆ°å†…å­˜ã€‚

=æˆ‘ä»¬æ­£åœ¨å†™å…¥å†…å­˜=åˆ†é…äº†æ–°çš„å†…å­˜ã€‚

è¿™æ„å‘³ç€å¯¹å˜é‡çš„ä»»ä½•ä¿®æ”¹éƒ½ä¸ä¼šå‘ä¸‹ä¼ æ’­åˆ°åå®šå­˜å‚¨(=åå®šçŠ¶æ€)ã€‚

=ä¸ä¼šè¦†ç›–åˆåŒå­˜å‚¨ã€‚

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œè¿è¡Œå‡½æ•°åŽï¼ŒçŠ¶æ€å˜é‡`someData`æ²¡æœ‰æ”¹å˜ã€‚

## çŠ¶æ€å˜é‡â†å†…å­˜

è¿™æ˜¯ä¸Šä¸€ä¸ªâ€œå†…å­˜â†çŠ¶æ€å˜é‡â€çš„åä¾‹ã€‚è¿™ä¸ªä¾‹å­å¯ä»¥åœ¨ Solidity æ–‡æ¡£éƒ¨åˆ†æ‰¾åˆ°ã€‚

## å­˜å‚¨æŒ‡é’ˆ

å½“ä¸€ä¸ª`storage`å˜é‡åœ¨ä¸€ä¸ªå‡½æ•°ä¸­è¢«åˆ›å»ºæ—¶ï¼Œå®ƒåŸºæœ¬ä¸Šä½œä¸ºä¸€ä¸ªå­˜å‚¨æŒ‡é’ˆã€‚å­˜å‚¨æŒ‡é’ˆåªæ˜¯å¼•ç”¨å­˜å‚¨ä¸­å·²ç»åˆ†é…çš„æ•°æ®ã€‚

æ‚¨å¯ä»¥é‡æ–°åˆ†é…å­˜å‚¨æŒ‡é’ˆï¼Œä½¿å…¶æŒ‡å‘å­˜å‚¨ä¸­çš„å…¶ä»–ä½ç½®ã€‚

=å¼•ç”¨å­˜å‚¨ä¸­çš„ä¸€äº›çŽ°æœ‰å€¼=ä¸åˆ›å»ºæ–°å­˜å‚¨

ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´æŽ¥ç»™æŸ¥æ‰¾å˜é‡åˆ†é…ä¸€ä¸ªæ–°å€¼æ¥è¦†ç›–å¥‘çº¦å­˜å‚¨ã€‚çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­:

å¦‚æžœæ‚¨éšåŽæŸ¥è¯¢ç¬¬ä¸€ä¸ªç´¢å¼•`someData`ï¼Œæ‚¨å°†èŽ·å¾—`1`ã€‚

## **å†…å­˜â†å­˜å‚¨æŒ‡é’ˆ**

å½“æˆ‘ä»¬å°†ä¸€ä¸ª`storage`å¼•ç”¨çš„æ•°æ®èµ‹ç»™ä¸€ä¸ª`memory`å¼•ç”¨çš„å˜é‡æ—¶ï¼Œæˆ‘ä»¬æ˜¯åœ¨ä»Žå­˜å‚¨â†’å†…å­˜å¤åˆ¶æ•°æ®ã€‚

=æˆ‘ä»¬æ­£åœ¨å†™å…¥å†…å­˜=åˆ†é…äº†æ–°çš„å†…å­˜ã€‚

è¿™ç›¸å½“äºŽæˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„ç¬¬ä¸€ç§æƒ…å†µâ€œå†…å­˜â†çŠ¶æ€å˜é‡â€,é€šè¿‡å­˜å‚¨å¼•ç”¨å¢žåŠ äº†â€œä¸­é—´çš„é™„åŠ è·¯å¾„â€ã€‚å­˜å‚¨å¼•ç”¨å°†è§£æžä¸ºçŠ¶æ€å˜é‡ï¼Œç„¶åŽè¢«å¤åˆ¶åˆ°å†…å­˜ä¸­ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå»ºç«‹åœ¨å‰é¢ä»£ç ç‰‡æ®µåŸºç¡€ä¸Šçš„åŸºæœ¬ç¤ºä¾‹ã€‚

è¿™é‡Œçš„`copyFromRef`æ˜¯æ•´ä¸ªæ•°ç»„`someData`çš„å‰¯æœ¬ã€‚é€šè¿‡å­˜å‚¨å¼•ç”¨`storageRef`å°†æ•°ç»„å¤åˆ¶åˆ°å†…å­˜ä¸­ã€‚

åŒæ ·åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºŽæˆ‘ä»¬å·²ç»ä»Žå­˜å‚¨æ‹·è´åˆ°å†…å­˜ï¼Œæ‰€ä»¥æˆ‘ä»¬æ˜¯åœ¨æ“ä½œæ•°æ®çš„æ‹·è´ï¼Œè€Œä¸æ˜¯é©»ç•™åœ¨å­˜å‚¨ä¸­çš„å®žé™…æ•°æ®ã€‚å› æ­¤ï¼Œå¯¹`copyFromRef`çš„ä»»ä½•ä¿®æ”¹éƒ½ä¸ä¼šä¼ æ’­å›žåˆåŒå­˜å‚¨å™¨ï¼Œä¹Ÿä¸ä¼šä¿®æ”¹åˆåŒçŠ¶æ€ã€‚

ä¸ºäº†è¯´æ˜Žè¿™ä¸€ç‚¹ï¼Œè¯·å°†ä»¥ä¸‹åˆåŒå¤åˆ¶æˆ Remix å’Œ:

1.  è¿è¡ŒåŠŸèƒ½`test()`ã€‚
2.  è¯»å–ç´¢å¼•`1`å¤„çš„`someData`æ•°ç»„ã€‚

æ‚¨å°†çœ‹åˆ°åœ¨è¿è¡Œè¯¥å‡½æ•°åŽï¼Œ`someData[1]`å¤„çš„å€¼ä»ç„¶æ˜¯`2`ï¼Œå¹¶ä¸”`12345`æ²¡æœ‰ä¼ æ’­å›žåˆåŒå­˜å‚¨å™¨ã€‚

**è°ƒç”¨æ•°æ®å‚è€ƒ**

calldata å¼•ç”¨çš„è¡Œä¸ºæ–¹å¼ä¸Ž`storage`å¼•ç”¨ç›¸åŒã€‚å®ƒåªèƒ½ä½œä¸ºå¯¹äº‹åŠ¡æ•°æ®çš„å¼•ç”¨ï¼Œæˆ–è€…å¯¹ä½¿ç”¨`calldata`å…³é”®å­—æä¾›çš„å¤æ‚ç±»åž‹çš„å‡½æ•°å‚æ•°çš„å¼•ç”¨ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œcalldata ç±»åž‹çš„å˜é‡æ€»æ˜¯åˆ›å»ºä¸€ä¸ªå¼•ç”¨ã€‚

å”¯ä¸€çš„ä¸»è¦åŒºåˆ«æ˜¯ä¸èƒ½ä¿®æ”¹ä½œä¸º`calldata`å¼•ç”¨çš„å˜é‡ï¼Œå› ä¸º calldata æ˜¯åªè¯»çš„ã€‚

è¿™ä¸Ž`storage`å‚è€ƒç›¸åã€‚å½“æ‚¨ç»™ä¸€ä¸ª`storage`å¼•ç”¨åˆ†é…ä¸€ä¸ªæ–°å€¼æ—¶ï¼Œè¿™ä¸ªå˜åŒ–ä¼šä¼ æ’­å›žå¥‘çº¦çŠ¶æ€ã€‚

# æ•°æ®ä½ç½®â€”è¡Œä¸º

> [æœ¬èŠ‚å–æäºŽ](https://medium.com/coinmonks/ethereum-solidity-memory-vs-storage-which-to-use-in-local-functions-72b593c3703a)[https://docs . solidy lang . org/en/v 0 . 8 . 15/types . html # data-location](https://medium.com/u/5d668b546d10#data-location)
> 
> ç„¶è€Œï¼Œåœ¨æŸäº›åœºæ™¯ä¸­ï¼Œä½¿ç”¨`memory`è€Œä¸æ˜¯`calldata`å¯ä»¥æé«˜å¯ç»„åˆæ€§
> 
> æœ€åŽï¼Œè¯·æ³¨æ„ï¼Œä¸åœ¨å‡½æ•°ä¸­ä½¿ç”¨æ­£ç¡®çš„æ•°æ®ä½ç½®ä¼šå¯¼è‡´æ½œåœ¨çš„é”™è¯¯å’Œæ¼æ´žã€‚çŽ°å®žä¸–ç•Œçš„ä¸€ä¸ªä¾‹å­æ˜¯å¯¹ Cover åè®®çš„æ— é™è–„è·æ”»å‡»ã€‚
> 
> è¯·çœ‹ä¸€ä¸‹æ¥è‡ª Cover protocol çš„`Blacksmith.sol`å¥‘çº¦çš„ä»£ç ç‰‡æ®µã€‚
> 
> ![](img/54e59055da9857823910e26e4d3cae3a.png)
> 
> å¯¹æ± å˜é‡çš„ä»»ä½•æ›´æ”¹éƒ½æ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œçš„ï¼Œä¸ä¼šä¼ æ’­å›žçº¦å®šå­˜å‚¨ã€‚
> 
> > å…³äºŽè¿™ä¸ª bug çš„æ›´å¤šç»†èŠ‚ï¼Œè¯·çœ‹ Mudti Gupta çš„åšæ–‡:[https://mudit . blog/cover-protocol-hack-analysis-tokens-minted-exploit/](https://mudit.blog/cover-protocol-hack-analysis-tokens-minted-exploit/)
> 
> # å‚è€ƒ
> 
>  [## å›ºä½“ä¸­çš„æ•°æ®è¡¨ç¤º
> 
> ### é€‚ç”¨äºŽä»£ç è°ƒè¯•å™¨å’Œå…¶ä»–è°ƒè¯•ç›¸å…³å®žç”¨ç¨‹åºçš„ç¼–å†™äººå‘˜ã€‚ä½œè€…å“ˆé‡ŒÂ·å¥¥ç‰¹æ›¼[@haltman-at]å‘è¡¨â€¦
> 
> ethdebug.github.io](https://ethdebug.github.io/solidity-data-representation/) [](https://medium.com/coinmonks/ethereum-solidity-memory-vs-storage-which-to-use-in-local-functions-72b593c3703a) [## ä»¥å¤ªåŠç¨³å›ºæ€§:å†…å­˜ä¸Žå­˜å‚¨&åœ¨æœ¬åœ°å‡½æ•°ä¸­ä½¿ç”¨å“ªä¸€ä¸ª
> 
> ### â€œå­˜å‚¨â€å’Œâ€œå†…å­˜â€æ•°æ®ä½ç½®å…³é”®å­—ä¹‹é—´çš„åŒºåˆ«ã€‚
> 
> medium.com](https://medium.com/coinmonks/ethereum-solidity-memory-vs-storage-which-to-use-in-local-functions-72b593c3703a) [](https://blog.openzeppelin.com/ethereum-in-depth-part-2-6339cf6bddb9/) [## ä»¥å¤ªåŠæ·±åº¦ï¼Œç¬¬ 2 éƒ¨åˆ†- OpenZeppelin åšå®¢
> 
> ### æ„Ÿè°¢ä½ å¯¹è¿™ç¯‡æ–‡ç« æ„Ÿå…´è¶£ï¼æˆ‘ä»¬æ­£åœ¨è¿›è¡Œå“ç‰Œé‡å¡‘ï¼Œæ‰€ä»¥å¦‚æžœæœ‰äº›åå­—â€¦
> 
> blog.openzeppelin.com](https://blog.openzeppelin.com/ethereum-in-depth-part-2-6339cf6bddb9/)  [## ç±»åž‹-åšå›ºæ€§ 0.8.15 æ–‡ä»¶
> 
> ### Solidity æ˜¯ä¸€ç§é™æ€ç±»åž‹è¯­è¨€ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªå˜é‡(çŠ¶æ€å’Œå±€éƒ¨)çš„ç±»åž‹éƒ½éœ€è¦â€¦
> 
> docs.soliditylang.org](https://docs.soliditylang.org/en/v0.8.15/types.html#data-location) [](https://github.com/CJ42/All-About-Solidity/blob/master/articles/Data-Locations.md) [## ä¸» CJ42 å¤„çš„å…¨å¯é æ€§/æ•°æ®ä½ç½®. MD/å…¨å¯é æ€§
> 
> ### ä½ ä¼šå‘çŽ°è¿™ä¸ªè¯é¢˜å¯èƒ½æ˜¯æœ€å…·æŒ‘æˆ˜æ€§çš„ã€‚ä¸‹è¡¨æ˜¯æ¯ä¸ªæ•°æ®ä½ç½®çš„æ¦‚è¿°â€¦
> 
> github.com](https://github.com/CJ42/All-About-Solidity/blob/master/articles/Data-Locations.md) [](https://www.evm.codes/about) [## EVM ç”µç 
> 
> ### ä»¥å¤ªåŠè™šæ‹Ÿæœº(æˆ– EVM)æ˜¯ä¸€ç§åŸºäºŽå †æ ˆçš„è®¡ç®—æœºã€‚è¿™æ„å‘³ç€æ‰€æœ‰æŒ‡ä»¤éƒ½å¸¦å‚æ•°â€¦
> 
> www.evm.codes](https://www.evm.codes/about) [](https://noxx.substack.com/p/evm-deep-dives-the-path-to-shadowy?s=r) [## EVM æ·±åº¦æŒ–æŽ˜:é€šå‘å½±å­è¶…çº§ç¼–ç å‘˜ðŸ¥·çš„é“è·¯ðŸ’»-ç¬¬ä¸€éƒ¨åˆ†
> 
> ### åŸºæœ¬åŽŸåˆ™æ€ç»´æ˜¯æˆ‘ä»¬ç»å¸¸å¬åˆ°çš„ä¸€ä¸ªæœ¯è¯­ã€‚å®ƒä¾§é‡äºŽæ·±å…¥ç†è§£çš„åŸºæœ¬æ¦‚å¿µï¼Œä¸€ä¸ªâ€¦
> 
> noxx.substack.com](https://noxx.substack.com/p/evm-deep-dives-the-path-to-shadowy?s=r) 
> 
> [https://mudit . blog/cover-protocol-hack-analysis-tokens-minted-exploit/](https://mudit.blog/cover-protocol-hack-analysis-tokens-minted-exploit/)