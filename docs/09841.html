<html>
<head>
<title>How To Make HTTP Requests in Streamlit App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•åœ¨Streamlit Appä¸­è¿›è¡ŒHTTPè¯·æ±‚</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://betterprogramming.pub/how-to-make-http-requests-in-streamlit-app-f22a77fd1ed7?source=collection_archive---------1-----------------------#2021-10-20">https://betterprogramming.pub/how-to-make-http-requests-in-streamlit-app-f22a77fd1ed7?source=collection_archive---------1-----------------------#2021-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b98e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">åˆ©ç”¨è¯·æ±‚æˆ–aiohttpåŒ…</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0b861fb45e474034ee8b782ff3ac24cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FZPK7PcWmrue8OWQ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae ky" href="https://unsplash.com/@alexbemore?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">äºšå†å±±å¤§Â·æ²™æ‰˜å¤«</a>åœ¨<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</p></figure><p id="a307" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è‡ªé—®ä¸–ä»¥æ¥ï¼ŒStreamlitåœ¨ç”¨Pythonæ„å»ºæ•°æ®åº”ç”¨ç¨‹åºçš„å¼€å‘äººå‘˜ä¸­è·å¾—äº†æå¤§çš„æ¬¢è¿ã€‚å®ƒäº2021å¹´10æœˆ5æ—¥å‘å¸ƒäº†æ­£å¼çš„1.0ç‰ˆæœ¬ã€‚ä»…ä¾›å‚è€ƒï¼ŒStreamlitæ˜¯â€”</p><blockquote class="lv lw lx"><p id="e1c9" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">â€œâ€¦ä¸€ä¸ªå¼€æºçš„Pythonåº“ï¼Œä½¿åˆ›å»ºå’Œå…±äº«ç”¨äºæœºå™¨å­¦ä¹ å’Œæ•°æ®ç§‘å­¦çš„æ¼‚äº®çš„è‡ªå®šä¹‰webåº”ç”¨ç¨‹åºå˜å¾—å®¹æ˜“ã€‚â€</p><p id="2e4c" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">â€”ç®€åŒ–æ–‡æ¡£</p></blockquote><p id="0155" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">é€šè¿‡åˆ©ç”¨Streamlitï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°æ„å»ºä¸€ä¸ªç®€å•çš„å‰ç«¯ç•Œé¢æ¥æ¼”ç¤ºæ‚¨çš„é¡¹ç›®çš„åŠŸèƒ½ã€‚è¿™éå¸¸æœ‰å¸®åŠ©ï¼Œå› ä¸ºæ‚¨ä¸éœ€è¦è‡ªå·±å¤„ç†HTMLã€CSSå’ŒJavaScriptã€‚webæ¥å£ç›´æ¥ç”¨Pythonç¼–ç ï¼Œæ›´å®¹æ˜“ä¸ä»»ä½•MLå’ŒAIæ¨¡å‹é›†æˆã€‚</p><p id="cebb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¯è™½å¦‚æ­¤ï¼Œå¯èƒ½ä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µ:æ‚¨çš„åº”ç”¨ç¨‹åºå¿…é¡»å‘å…¶ä»–ç«¯ç‚¹å‘å‡ºå¤–éƒ¨HTTPè¯·æ±‚ã€‚è¿™åŒ…æ‹¬ä»è¿œç¨‹æœåŠ¡å™¨è·å–æ•°æ®ã€é€šè¿‡ä¸­é—´ç«¯ç‚¹å¤„ç†å†…å®¹ç­‰ã€‚</p><p id="7506" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">é€šè¿‡é˜…è¯»æœ¬æ–‡ï¼Œæ‚¨å°†å­¦ä¼šæ ¹æ®æ‚¨çš„ç”¨ä¾‹ï¼Œé€šè¿‡ä»¥ä¸‹PythonåŒ…åœ¨Streamlitåº”ç”¨ç¨‹åºä¸­å‘å‡ºHTTPè¯·æ±‚:</p><ul class=""><li id="5dd0" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated"><code class="fe ml mm mn mo b">requests</code> â€”ç”¨äºæ­£å¸¸åº”ç”¨</li><li id="51d5" class="mc md it lb b lc mp lf mq li mr lm ms lq mt lu mh mi mj mk bi translated"><code class="fe ml mm mn mo b">aiohttp</code> â€”ç”¨äºéœ€è¦å¼‚æ­¥æ‰§è¡Œçš„åº”ç”¨ç¨‹åº</li></ul><p id="db15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸ºäº†ä¿æŒç®€æ´ï¼Œåº”ç”¨ç¨‹åºçš„åŠŸèƒ½å¦‚ä¸‹:</p><ul class=""><li id="2b15" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated">è¡¨ç¤ºå›¾åƒIDçš„æ•°å­—è¾“å…¥å°éƒ¨ä»¶</li><li id="a6f3" class="mc md it lb b lc mp lf mq li mr lm ms lq mt lu mh mi mj mk bi translated">ä¸€ä¸ªsubmit buttonå°éƒ¨ä»¶ï¼Œç”¨äºè°ƒç”¨å¤–éƒ¨å›¾åƒAPIå¹¶å°†è¾“å‡ºè§£æä¸ºJSON</li><li id="44cd" class="mc md it lb b lc mp lf mq li mr lm ms lq mt lu mh mi mj mk bi translated">ä¸€ä¸ªå›¾åƒå°éƒ¨ä»¶ï¼Œæ˜¾ç¤ºè¿”å›çš„å›¾åƒURLå’Œä½œè€…å§“å</li></ul><p id="0c99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¤–éƒ¨å›¾åƒAPIç”±Picsumæä¾›ï¼ŒPicsumæ˜¯<code class="fe ml mm mn mo b">The Lorem Ipsum for photos:</code></p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="5428" class="my mz it mo b gy na nb l nc nd">https://picsum.photos/id/{id}/info</span></pre><p id="db76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">idè¡¨ç¤ºå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œæˆ‘ä»¬å°†è¯¥å€¼é™åˆ¶åœ¨0åˆ°100ä¹‹é—´ã€‚APIè¾“å‡ºå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="a0f3" class="my mz it mo b gy na nb l nc nd">{<br/>        "id": "0",<br/>        "author": "Alejandro Escamilla",<br/>        "width": 5616,<br/>        "height": 3744,<br/>        "url": "https://unsplash.com/...",<br/>        "download_url": "https://picsum.photos/..."<br/>}</span></pre><p id="9ece" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æäº¤åï¼Œç”¨æˆ·ç•Œé¢åº”å¦‚ä¸‹æ‰€ç¤º:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/f25e8accb4e74dfb7a4ff5679a1ebac7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OkfFzrTD5lsoCb89ZOZJ3g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ä½œè€…å›¾ç‰‡</p></figure><h1 id="e98a" class="nf mz it bd ng nh ni nj nk nl nm nn no jz np ka nq kc nr kd ns kf nt kg nu nv bi translated">è®¾ç½®</h1><p id="e1e4" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">å¼ºçƒˆå»ºè®®æ‚¨åœ¨ç»§ç»­å®‰è£…ä¹‹å‰åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¯å¢ƒã€‚</p><h2 id="7808" class="my mz it bd ng ob oc dn nk od oe dp no li of og nq lm oh oi ns lq oj ok nu ol bi translated">ç»†æµ</h2><p id="0d87" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">æ¿€æ´»å®ƒï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…Streamlit:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="638d" class="my mz it mo b gy na nb l nc nd">pip install streamlit</span></pre><h2 id="9931" class="my mz it bd ng ob oc dn nk od oe dp no li of og nq lm oh oi ns lq oj ok nu ol bi translated">è¦æ±‚</h2><p id="8246" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">æ‚¨çš„ç¯å¢ƒä¸­åº”è¯¥å·²ç»å®‰è£…äº†è¯·æ±‚åŒ…ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ–¹å¼å®‰è£…:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="7896" class="my mz it mo b gy na nb l nc nd">pip install requests</span></pre><h2 id="0bb5" class="my mz it bd ng ob oc dn nk od oe dp no li of og nq lm oh oi ns lq oj ok nu ol bi translated">aiohttp</h2><p id="15aa" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">å¯¹äºå¼‚æ­¥è¯·æ±‚ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰ä¾èµ–é¡¹:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="a084" class="my mz it mo b gy na nb l nc nd">pip install aiohttp[speedups]</span></pre><h1 id="8c91" class="nf mz it bd ng nh ni nj nk nl nm nn no jz np ka nq kc nr kd ns kf nt kg nu nv bi translated">å¸¦æœ‰è¯·æ±‚çš„HTTPè¯·æ±‚</h1><p id="a9c5" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">åˆ›å»ºä¸€ä¸ªåä¸º<code class="fe ml mm mn mo b">myapp.py</code>çš„æ–°Pythonæ–‡ä»¶ã€‚</p><h2 id="95fa" class="my mz it bd ng ob oc dn nk od oe dp no li of og nq lm oh oi ns lq oj ok nu ol bi translated">å¯¼å…¥</h2><p id="c432" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">åœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ ä»¥ä¸‹å¯¼å…¥è¯­å¥:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="2ab6" class="my mz it mo b gy na nb l nc nd">import streamlit as st<br/>import requests</span></pre><h2 id="3a44" class="my mz it bd ng ob oc dn nk od oe dp no li of og nq lm oh oi ns lq oj ok nu ol bi translated">è·å–åŠŸèƒ½</h2><p id="bb4c" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">æ¥ä¸‹æ¥ï¼Œå®šä¹‰ä¸€ä¸ªåˆ©ç”¨<code class="fe ml mm mn mo b">requests.session</code>è°ƒç”¨å¤–éƒ¨URLå¹¶ä»¥JSONçš„å½¢å¼è¿”å›å“åº”çš„é€šç”¨å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="e356" class="my mz it mo b gy na nb l nc nd">def fetch(session, url):<br/>    try:<br/>        result = session.get(url)<br/>        return result.json()<br/>    except Exception:<br/>        return {}</span></pre><h2 id="7703" class="my mz it bd ng ob oc dn nk od oe dp no li of og nq lm oh oi ns lq oj ok nu ol bi translated">ä¸»è¦åŠŸèƒ½</h2><p id="dd8c" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">åœ¨ä¸‹é¢åˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ä½œä¸ºä¸»å‡½æ•°ã€‚é€šè¿‡è°ƒç”¨<code class="fe ml mm mn mo b">st.set_page_config</code>å‡½æ•°åˆå§‹åŒ–webç•Œé¢çš„é…ç½®:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="8507" class="my mz it mo b gy na nb l nc nd">st.set_page_config(page_title="Example App", page_icon="ğŸ¤–")</span></pre><p id="2264" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ç„¶åï¼Œè®¾ç½®æ ‡é¢˜å¦‚ä¸‹(æŒ‡ç½‘é¡µç•Œé¢çš„H1æ ‡é¢˜):</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="bd2a" class="my mz it mo b gy na nb l nc nd">st.title("Get Image by Id")</span></pre><p id="d6d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è®©æˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªä¼šè¯æ¥é‡ç”¨åº•å±‚TCPè¿æ¥ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°çš„requestså¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="247c" class="my mz it mo b gy na nb l nc nd">session = requests.Session()</span></pre><p id="14fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å½“è¿›è¡Œå¤–éƒ¨URLè°ƒç”¨æ—¶ï¼Œå»ºè®®å°†å…¶å°è£…åœ¨ä¸€ä¸ª<code class="fe ml mm mn mo b">st.form</code>å°éƒ¨ä»¶ä¸­ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºæ¯æ¬¡ç”¨æˆ·ä¸æ‚¨çš„åº”ç”¨ç¨‹åºäº¤äº’æ—¶ï¼ŒStreamlitéƒ½ä¼šé‡æ–°æ‰§è¡Œè„šæœ¬ï¼Œä»è€Œå¯¼è‡´ä¸å¿…è¦çš„HTTPè¯·æ±‚è°ƒç”¨ã€‚<code class="fe ml mm mn mo b">st.form</code>æœ‰åŠ©äºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒä¼šå°†å…¶ä¸­çš„æ‰€æœ‰å°éƒ¨ä»¶æ‰¹å¤„ç†åœ¨ä¸€èµ·ï¼Œå¹¶ä¸”åœ¨æäº¤æ—¶åªæ‰§è¡Œä¸€æ¬¡ã€‚</p><p id="b18d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åˆ›å»ºä¸€ä¸ªæ–°çš„<code class="fe ml mm mn mo b">st.form</code>å°éƒ¨ä»¶ï¼Œå¹¶ç”¨ä»¥ä¸‹å°éƒ¨ä»¶å¡«å……å®ƒ:</p><ul class=""><li id="aef0" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated">st.number _è¾“å…¥</li><li id="1006" class="mc md it lb b lc mp lf mq li mr lm ms lq mt lu mh mi mj mk bi translated">è¡¨å•æäº¤æŒ‰é’®</li></ul><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="32df" class="my mz it mo b gy na nb l nc nd">with st.form("my_form"):<br/>    index = st.number_input("ID", min_value=0, max_value=100, key="index")</span><span id="88f0" class="my mz it mo b gy om nb l nc nd">    submitted = st.form_submit_button("Submit")</span></pre><p id="7c40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ml mm mn mo b">st.form_submit_button</code>è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨æ˜ç”¨æˆ·æ˜¯å¦æŒ‰ä¸‹äº†æäº¤æŒ‰é’®ã€‚æ·»åŠ ä»¥ä¸‹æ¡ä»¶è¯­å¥ï¼Œè¯¥è¯­å¥è°ƒç”¨<code class="fe ml mm mn mo b">fetch</code>å‡½æ•°ï¼Œå¹¶åœ¨ç”¨æˆ·æäº¤è¡¨å•æ—¶ç”Ÿæˆä¸€ä¸ª<code class="fe ml mm mn mo b">st.image</code>å°éƒ¨ä»¶:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="5883" class="my mz it mo b gy na nb l nc nd">if submitted:<br/>    st.write("Result")<br/>    data = fetch(session, f"https://picsum.photos/id/{index}/info")<br/>    if data:<br/>        st.image(data['download_url'], caption=f"Author: {data['author']}")<br/>    else:<br/>        st.error("Error")</span></pre><p id="0c4b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä½¿ç”¨ä»¥ä¸‹ä»£ç ä¸ºPythonæ–‡ä»¶æ·»åŠ æœ€åçš„æ¶¦è‰²:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="f681" class="my mz it mo b gy na nb l nc nd">if __name__ == '__main__':<br/>    main()</span></pre><p id="eeb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹<a class="ae ky" href="https://gist.github.com/wfng92/9dc26a12ded0359c31887052e11ef8ff" rel="noopener ugc nofollow" target="_blank">è¦ç‚¹</a>ä¸­æ‰¾åˆ°å®Œæ•´çš„ä»£ç :</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><h2 id="4308" class="my mz it bd ng ob oc dn nk od oe dp no li of og nq lm oh oi ns lq oj ok nu ol bi translated">è¿è¡Œç»†æµ</h2><p id="eeba" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">ä¿å­˜æ–‡ä»¶å¹¶åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="fce1" class="my mz it mo b gy na nb l nc nd">streamlit run <!-- -->my<!-- -->app.py</span></pre><p id="f0ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¦‚æœæ‚¨åœ¨æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºçš„è¿œç¨‹æœåŠ¡å™¨ä¸Šè¿è¡Œå®ƒï¼Œæ‚¨å¯ä»¥å°†<code class="fe ml mm mn mo b">server.headless</code>è®¾ç½®ä¸ºtrueä»¥é˜²æ­¢ä»»ä½•è­¦å‘Šæ—¥å¿—:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="3538" class="my mz it mo b gy na nb l nc nd">streamlit run <!-- -->my<!-- -->app.py --server.headless true</span></pre><p id="4950" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå°†åœ¨ç«¯å£8501ä¸Šè¿è¡Œã€‚æ‚¨å¯ä»¥é€šè¿‡<code class="fe ml mm mn mo b">server.port</code>è½»æ¾æ›´æ”¹ç«¯å£ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="ee77" class="my mz it mo b gy na nb l nc nd">streamlit run <!-- -->my<!-- -->app.py --server.port 8501</span></pre><p id="19f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¯·è®¿é—®ä»¥ä¸‹ç½‘å€:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="5c53" class="my mz it mo b gy na nb l nc nd">http://localhost:8501/</span></pre><p id="2a3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä»¥ä¸‹ç”¨æˆ·ç•Œé¢:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/d854e876abeda703d3e003de5ab4af3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bOgoRg3GXQPF96Bh4uZXMQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ä½œè€…å›¾ç‰‡</p></figure><h1 id="ac57" class="nf mz it bd ng nh ni nj nk nl nm nn no jz np ka nq kc nr kd ns kf nt kg nu nv bi translated">ä½¿ç”¨aiohttpçš„HTTPè¯·æ±‚</h1><p id="8666" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">åœ¨æœ¬èŠ‚ä¸­ï¼Œæ‚¨å°†å­¦ä¹ ä½¿ç”¨<code class="fe ml mm mn mo b">aiohttp</code>è€Œä¸æ˜¯<code class="fe ml mm mn mo b">requests</code>æ¥å‘å‡ºHTTPè¯·æ±‚ã€‚é™¤äº†ä¸€äº›å·®å¼‚ï¼Œå®ç°æˆ–å¤šæˆ–å°‘æ˜¯ç›¸åŒçš„ã€‚</p><h2 id="0f97" class="my mz it bd ng ob oc dn nk od oe dp no li of og nq lm oh oi ns lq oj ok nu ol bi translated">å¯¼å…¥</h2><p id="f246" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">ä¿®æ”¹å¯¼å…¥è¯­å¥ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="21b3" class="my mz it mo b gy na nb l nc nd">import streamlit as st<br/>import aiohttp<br/>import asyncio</span></pre><h2 id="c94f" class="my mz it bd ng ob oc dn nk od oe dp no li of og nq lm oh oi ns lq oj ok nu ol bi translated">è·å–åŠŸèƒ½</h2><p id="6550" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">æ¥ä¸‹æ¥ï¼Œå°†<code class="fe ml mm mn mo b">fetch</code>å‡½æ•°æ›´æ”¹ä¸º<code class="fe ml mm mn mo b">async</code>ï¼Œå¹¶åœ¨å‘å‡ºHTTPè¯·æ±‚æ—¶ä½¿ç”¨<code class="fe ml mm mn mo b">aiohttp.ClientSession</code>ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="f62b" class="my mz it mo b gy na nb l nc nd">async def fetch(session, url):<br/>    try:<br/>        async with session.get(url) as response:<br/>            result = await response.json()<br/>            return result<br/>    except Exception:<br/>        return {}</span></pre><p id="e56b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¯·æ³¨æ„ï¼Œè¿™ä¸ªå®ç°å°†å¯¹APIè¿›è¡Œä¸€æ¬¡è°ƒç”¨ï¼Œå¹¶ç­‰å¾…å“åº”ã€‚å› æ­¤ï¼Œä¸ä½¿ç”¨<code class="fe ml mm mn mo b">requests</code>åŒ…ç›¸æ¯”ï¼Œåœ¨æ‰§è¡Œæ—¶é—´æ–¹é¢ä¸ä¼šæœ‰ä»»ä½•å·®åˆ«ã€‚</p><p id="89a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ç„¶è€Œï¼Œå¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºåœ¨æ¯ä¸ªè¢«ç‚¹å‡»çš„æŒ‰é’®ä¸Šè¿›è¡Œå¤šä¸ªAPIè°ƒç”¨ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨<code class="fe ml mm mn mo b">asyncio.gather</code>æ¥åŒæ—¶è·å–æ‰€æœ‰çš„APIã€‚è¯·é˜…è¯»ä¸‹é¢çš„æ–‡ç« äº†è§£æ›´å¤šä¿¡æ¯:</p><ul class=""><li id="853b" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/how-to-make-parallel-async-http-requests-in-python-d0bd74780b8a">å¦‚ä½•ç”¨Pythonå‘å‡ºå¹¶è¡Œå¼‚æ­¥è¯·æ±‚</a></li></ul><h2 id="f00e" class="my mz it bd ng ob oc dn nk od oe dp no li of og nq lm oh oi ns lq oj ok nu ol bi translated">ä¸»è¦åŠŸèƒ½</h2><p id="20f4" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">åŒæ ·ï¼Œå°†ä¸»å‡½æ•°ä¿®æ”¹ä¸º<code class="fe ml mm mn mo b">async</code>ï¼Œå¹¶å°†<code class="fe ml mm mn mo b">st.form</code>ä»£ç åŒ…è£…åœ¨<code class="fe ml mm mn mo b">aiohttp.ClientSession</code>ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä¸­ã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜éœ€è¦ç”¨å…³é”®å­—<code class="fe ml mm mn mo b">await</code>è°ƒç”¨<code class="fe ml mm mn mo b">fetch</code>å‡½æ•°ã€‚ä»£ç å¦‚ä¸‹:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="53a8" class="my mz it mo b gy na nb l nc nd">async def main():<br/>    st.set_page_config(page_title="Example App", page_icon="ğŸ¤–")<br/>    st.title("Get Image by Id")<br/>    async with aiohttp.ClientSession() as session:<br/>        with st.form("my_form"):</span><span id="6bae" class="my mz it mo b gy om nb l nc nd">        ...</span><span id="bf4d" class="my mz it mo b gy om nb l nc nd">        data = await fetch(session, f"https://picsum.photos/id/{index}/info")</span></pre><p id="2eb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢å¯¹mainå‡½æ•°çš„è°ƒç”¨:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="164f" class="my mz it mo b gy na nb l nc nd">if __name__ == '__main__':<br/>    loop = asyncio.new_event_loop()<br/>    loop.run_until_complete(main())</span></pre><p id="4834" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¯¹äºPython 3.7+ï¼Œå¯ä»¥ä½¿ç”¨<code class="fe ml mm mn mo b">asyncio.run</code>å‡½æ•°ä½œä¸ºé¡¶çº§å…¥å£ç‚¹:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="56db" class="my mz it mo b gy na nb l nc nd">if __name__ == '__main__':<br/>    asyncio.run(main())</span></pre><p id="66ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://gist.github.com/wfng92/0cc6673e9ce4e8b880e6a38c134ed0cf" rel="noopener ugc nofollow" target="_blank">å®Œæ•´ä»£ç </a>å¦‚ä¸‹:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><h2 id="aea6" class="my mz it bd ng ob oc dn nk od oe dp no li of og nq lm oh oi ns lq oj ok nu ol bi translated">è¿è¡Œç»†æµ</h2><p id="37e8" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">ä¿å­˜æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ä¹‹å‰è¿è¡Œçš„ç›¸åŒå‘½ä»¤è¿è¡Œå®ƒ:</p><pre class="kj kk kl km gt mu mo mv mw aw mx bi"><span id="ffc4" class="my mz it mo b gy na nb l nc nd">streamlit run <!-- -->my<!-- -->app.py</span></pre><p id="fb8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°å…·æœ‰ç›¸åŒåŠŸèƒ½çš„ç›¸åŒwebç•Œé¢ã€‚</p><h1 id="2b1f" class="nf mz it bd ng nh ni nj nk nl nm nn no jz np ka nq kc nr kd ns kf nt kg nu nv bi translated">ç»“è®º</h1><p id="3880" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ä½ ä»Šå¤©æ‰€å­¦çš„å†…å®¹ã€‚</p><p id="8ae6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™ç¯‡æ–‡ç« ä»å¯¹Streamlitçš„ç®€å•ä»‹ç»å’Œåœ¨Streamlitåº”ç”¨ç¨‹åºä¸­å‘å‡ºHTTPè¯·æ±‚çš„é—®é¢˜é™ˆè¿°å¼€å§‹ã€‚</p><p id="7683" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ç„¶åï¼Œç»§ç»­å®‰è£…<code class="fe ml mm mn mo b">streamlit</code>ã€<code class="fe ml mm mn mo b">aiohttp</code>å’Œ<code class="fe ml mm mn mo b">requests</code> PythonåŒ…ã€‚</p><p id="984b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æœ¬æ•™ç¨‹ç»§ç»­å®ç°ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºåŸºäºIDè·å–å›¾åƒã€‚HTTPè¯·æ±‚é€šè¿‡<code class="fe ml mm mn mo b">requests</code>åŒ…è°ƒç”¨ã€‚</p><p id="8c19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">éšåï¼Œå®ƒä»‹ç»äº†å¦‚ä½•ä½¿ç”¨<code class="fe ml mm mn mo b">aiohttp</code>è€Œä¸æ˜¯<code class="fe ml mm mn mo b">requests</code>æ¥å‘å‡ºHTTPè¯·æ±‚ã€‚</p><p id="3528" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ„Ÿè°¢é˜…è¯»ã€‚ç¥ä½ æœ‰ç¾å¥½çš„ä¸€å¤©ï¼</p><h1 id="6643" class="nf mz it bd ng nh ni nj nk nl nm nn no jz np ka nq kc nr kd ns kf nt kg nu nv bi translated">å‚è€ƒ</h1><ol class=""><li id="9b26" class="mc md it lb b lc nw lf nx li oq lm or lq os lu ot mi mj mk bi translated"><a class="ae ky" href="https://docs.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit â€”æ–‡æ¡£</a></li><li id="0874" class="mc md it lb b lc mp lf mq li mr lm ms lq mt lu ot mi mj mk bi translated">Medium â€” <a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/how-to-make-parallel-async-http-requests-in-python-d0bd74780b8a">å¦‚ä½•ç”¨Pythonå‘å‡ºå¹¶è¡Œå¼‚æ­¥è¯·æ±‚</a></li></ol></div></div>    
</body>
</html>