# è¯†åˆ«å¼‚å¸¸å€¼

> åŸæ–‡ï¼š<https://betterprogramming.pub/identifying-outliers-part-two-4c00b2523362>

## å¦‚ä½•åœ¨ç†ŠçŒ«æ•°æ®é›†ä¸­æŸ¥æ‰¾å¹¶å¯è§†åŒ–å¼‚å¸¸å€¼

![](img/f6dfe1a534f592b8e7b03d18970ae7ec.png)

æˆ´å¤«Â·ç”˜è¿ªçš„ç…§ç‰‡

**è­¦å‘Š** : *è¿™é‡Œæ²¡æœ‰ç¥å¥‡çš„é…æ–¹æˆ–åœ£æ¯ï¼Œå°½ç®¡ä¸€ä¸ªæ–°çš„ä¸–ç•Œå¯èƒ½ä¼šä¸ºä½ æ‰“å¼€å¤§é—¨ã€‚*

## ğŸ“ˆPython For Finance ç³»åˆ—

1.  [è¯†åˆ«å¼‚å¸¸å€¼](https://medium.com/python-in-plain-english/identifying-outliers-part-one-c0a31d9faefa)
2.  [è¯†åˆ«å¼‚å¸¸å€¼â€”ç¬¬äºŒéƒ¨åˆ†](https://medium.com/better-programming/identifying-outliers-part-two-4c00b2523362)
3.  [è¯†åˆ«å¼‚å¸¸å€¼â€”ç¬¬ä¸‰éƒ¨åˆ†](https://medium.com/swlh/identifying-outliers-part-three-257b09f5940b)
4.  [ç¨‹å¼åŒ–çš„äº‹å®](https://towardsdatascience.com/data-whispering-eebb77a422da)
5.  [ç‰¹å¾å·¥ç¨‹&ç‰¹å¾é€‰æ‹©](https://medium.com/@kegui/feature-engineering-feature-selection-8c1d57af18d2)
6.  [æ•°æ®è½¬æ¢](https://towardsdatascience.com/data-transformation-e7b3b4268151)
7.  [å¾®å°å·®å¼‚ç‰¹å¾](https://medium.com/swlh/fractionally-differentiated-features-9c1947ed2b55)
8.  [æ•°æ®æ ‡ç­¾](https://towardsdatascience.com/the-triple-barrier-method-251268419dcd)
9.  [å…ƒæ ‡ç­¾å’Œå †å ](https://towardsdatascience.com/meta-labeling-and-stacking-f17a7f9804ec) [g](https://towardsdatascience.com/the-triple-barrier-method-251268419dcd)

åœ¨ä¹‹å‰çš„ä¸­ï¼Œæˆ‘å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨å‡å€¼å’Œæ ‡å‡†å·®æ¥è¿‡æ»¤æ‰æ•°æ®é›†ä¸­çš„å¼‚å¸¸å€¼ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç§»åŠ¨å¹³å‡çº¿ä½œä¸ºè¾¹ç•Œå†åšä¸€æ¬¡ã€‚

# 1.æ•°æ®å‡†å¤‡

è¿™é‡Œï¼Œæˆ‘ä»¬é‡ç”¨äº†ç¬¬ä¸€éƒ¨åˆ†ä¸­çš„æ•°æ®é›†ã€‚ä»¥ä¸‹ä»£ç ç‰‡æ®µå°†å¸®åŠ©æ‚¨å…¥é—¨:

![](img/111c024d4ab7a16d98f99b3af42bf6ed.png)

# 2.ä½¿ç”¨ç§»åŠ¨å¹³å‡å‡å€¼å’Œæ ‡å‡†åå·®ä½œä¸ºè¾¹ç•Œ

ä¸ç¬¬ä¸€ç§æ–¹æ³•ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆè·å¾—è¾¹ç•Œï¼Œç„¶åå°†è¾¹ç•Œåº”ç”¨äºæ•°æ®é›†ã€‚è¿™ä¸€æ¬¡ï¼Œå°†é‡‡ç”¨ç§»åŠ¨å¹³å‡å€¼å’Œæ ‡å‡†åå·®(std)ã€‚ä¸ºäº†è®¡ç®—å¹³å‡å€¼å’Œæ ‡å‡†å·®ï¼Œé€‰æ‹© 21 å¤©çš„çª—å£ï¼Œå› ä¸ºå®ƒä»£è¡¨ä¸€ä¸ªæœˆä¸­çš„å¹³å‡äº¤æ˜“æ—¥ã€‚ä½ å¯ä»¥é€‰æ‹©ä»»ä½•ä¸€å¤©ï¼Œä½†æ•æ„Ÿåº¦ä¼šæœ‰æ‰€ä¸åŒã€‚

è¦å¾—åˆ°å¹³å‡å€¼å’Œæ ‡å‡†å·®ï¼Œå¾ˆå®¹æ˜“ç”¨ [Pandas](https://pandas.pydata.org/) ä¸­çš„ä¸€è¡Œä»£ç :

```
d1[['mean', 'std']] = d1['simple_rtn'].rolling(window=21) \
                               .agg(['mean', 'std'])
```

![](img/da850c0506ca917b79c70943dc9f3b34.png)

`NaNs`å¤ªå¤šäº†ã€‚ä¸‹ä¸€æ­¥æ˜¯åˆ é™¤å®ƒä»¬:

```
d1.dropna(inplace=True)
```

è®©æˆ‘ä»¬ç”»ä¸€å¼ å›¾ï¼Œæ‰¾å‡ºç•Œé™åœ¨å“ªé‡Œ:

![](img/05f0ea9ba86d4bb6e709689e1f87849f.png)

å¦‚æœæˆ‘ç”¨ä¸‰å€çš„ std ä»£æ›¿ä¼šæ€ä¹ˆæ ·ï¼Ÿ

![](img/8e982d021ab34a786bef8ccfa0a237bf.png)

å—¯â€¦æœ‰ç‚¹è¿‡å¤´äº†ã€‚æˆ‘ä»¬æŠŠå®ƒæ”¹æˆä¸¤å€çš„ std:

![](img/6f6e2a0e287d549e7248176e14e7e779.png)

è¿™æ˜¯æ­£ç¡®çš„ï¼ç°åœ¨æ˜¯æ—¶å€™å»å¯»æ‰¾é‚£äº›ç¦»ç¾¤å€¼äº†:

![](img/fc94266a52b9ebcf475f9c0517496ffe.png)

# å°è´¹ï¼

```
# The above code snippet can be refracted as follow:cond = (d1['simple_rtn'] > d1['mean'] + d1['std'] * 2) | (d1['simple_rtn'] < d1['mean'] - d1['std'] 
d1['outliers'] = np.where(cond, 1, 0)
```

çœ‹ä¸€ä¸‹ç¦»ç¾¤ä¿¡æ¯ã€‚æˆ‘ä»¬çŸ¥é“åœ¨ 2ï¼Œ745 ä¸ªæ•°æ®ç‚¹ä¸­æœ‰ 127 ä¸ªå¼‚å¸¸å€¼(çº¦ 4.6%):

```
outliers.info()
```

![](img/8e2c2b982dd48f4feb9a0f119a0ae63b.png)

å¦‚æœæˆ‘ä»¬å°†ä¸¤å€çš„æ ‡å‡†å·®ä½œä¸ºè¾¹ç•Œï¼Œæˆ‘ä»¬ä¼šå¾—åˆ° 4.6%çš„æ•°æ®ç‚¹è¶…å‡ºèŒƒå›´ã€‚æˆ‘ä»¬å¯ä»¥æŒ‘å‡ºé‚£äº›å¼‚å¸¸å€¼ï¼Œå°†å®ƒä»¬æ”¾å…¥å¦ä¸€ä¸ªæ•°æ®æ¡†æ¶ï¼Œå¹¶åœ¨å›¾è¡¨ä¸­æ˜¾ç¤ºå‡ºæ¥:

![](img/88d8bbaf4de9b1b8cff845d15596e4b1.png)

æ„Ÿè§‰æœ‰ç‚¹è¿‡å¤´äº†ã€‚æˆ‘ä»¬æŠŠå®ƒå¾®è°ƒåˆ°æ ‡å‡†å€¼çš„ 2.5 å€ã€‚è¿™æ¬¡ï¼Œæˆ‘ä»¬å¾—åˆ°äº† 41 ä¸ªå¼‚å¸¸å€¼(~1.5%):

![](img/f20a952a515fca2be473fec9c98320b7.png)

éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå½“é™„è¿‘æœ‰ç›¸å½“å¤šçš„å¤§å›æŠ¥æ—¶ï¼Œç®—æ³•ä¼šå°†ç¬¬ä¸€ä¸ªè¯†åˆ«ä¸ºå¼‚å¸¸å€¼ï¼Œå°†ç¬¬äºŒä¸ªè¯†åˆ«ä¸ºå¸¸è§„è§‚å¯Ÿå€¼(å¦‚åœ†åœˆä¸­æ‰€ç¤º)ã€‚è¿™å¯èƒ½æ˜¯ç”±äºç¬¬ä¸€ä¸ªå¼‚å¸¸å€¼è¿›å…¥æ»šåŠ¨çª—å£å¹¶å½±å“ç§»åŠ¨å¹³å‡å€¼/æ ‡å‡†åå·®ã€‚

çª—å£å¤§å°å’Œæ ‡å‡†å·®éƒ½ä¼šå½±å“æœ€ç»ˆç»“æœã€‚æˆ‘ä»¬å¯ä»¥å¯¹å®ƒä»¬è¿›è¡Œå¾®è°ƒï¼Œä»¥æ›´å¥½åœ°æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚ä¸ä¹‹å‰çš„æ–¹æ³•ç›¸æ¯”ï¼Œç§»åŠ¨å¹³å‡æ³•æ›´åŠ æ•æ„Ÿã€‚æ‚¨å¯ä»¥æŸ¥çœ‹ä¹‹å‰çš„æ–‡ç« ä»¥è·å¾—æ›´å¥½çš„ç†è§£:

[](https://medium.com/@kegui/identifying-outliers-part-one-c0a31d9faefa) [## è¯†åˆ«å¼‚å¸¸å€¼â€”ç¬¬ä¸€éƒ¨åˆ†

### â€” python for finance ç³»åˆ—ä¹‹ä¸€

medium.com](https://medium.com/@kegui/identifying-outliers-part-one-c0a31d9faefa) [](https://medium.com/@kegui/identifying-outliers-part-three-257b09f5940b) [## è¯†åˆ«å¼‚å¸¸å€¼â€”â€”ç¬¬ä¸‰éƒ¨åˆ†

### å¦‚ä½•é€šè¿‡ç†ŠçŒ«æ¥æŸ¥æ‰¾å’Œå¯è§†åŒ–æ•°æ®é›†ä¸­çš„å¼‚å¸¸å€¼

medium.com](https://medium.com/@kegui/identifying-outliers-part-three-257b09f5940b)