<html>
<head>
<title>How To Use Kubernetes Secrets for Storing Sensitive Config Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨Kubernetesçš„ç§˜å¯†æ¥å­˜å‚¨æ•æ„Ÿçš„é…ç½®æ•°æ®</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://betterprogramming.pub/how-to-use-kubernetes-secrets-for-storing-sensitive-config-data-f3c5e7d11c15?source=collection_archive---------2-----------------------#2019-12-19">https://betterprogramming.pub/how-to-use-kubernetes-secrets-for-storing-sensitive-config-data-f3c5e7d11c15?source=collection_archive---------2-----------------------#2019-12-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="eb91" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">å› ä¸ºä½ çš„é’¥åŒ™å’Œç§˜å¯†åº”è¯¥åªæ˜¯ç§˜å¯†</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0ef9dfd012b7aa4fbb333be6363f18e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJ_xufkMdFS7v8vd7bx-9g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">JOSHUA COLEMAN åœ¨<a class="ae kv" href="https://unsplash.com/s/photos/storage?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</p></figure><p id="e0eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½ å¥½ï¼Œæ¬¢è¿ğŸ‘‹ğŸ‘‹ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬ç»§ç»­æˆ‘ä»¬çš„Kubernetesä¹‹æ—…ã€‚åœ¨ä¹‹å‰çš„ä¸€ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨<code class="fe ls lt lu lv b">ConfigMap</code>å¯¹è±¡<a class="ae kv" href="https://itnext.io/learn-how-to-configure-your-kubernetes-apps-using-the-configmap-object-d8f30f99abeb" rel="noopener ugc nofollow" target="_blank">é…ç½®Kubernetesåº”ç”¨</a>ã€‚åœ¨æœ¬å¸–ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨Kubernetes <code class="fe ls lt lu lv b">Secrets</code>ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬æ¥å­˜å‚¨éœ€è¦å®‰å…¨å¤„ç†çš„æ•æ„Ÿé…ç½®æ•°æ®(ä¾‹å¦‚ï¼Œæ•°æ®åº“å‡­è¯ã€APIå¯†é’¥ç­‰)ã€‚).</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/c2b7ce851ff940c12505e1aa99bf6b43.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*G46fIWLhBBQTVPgWEcRGQw.png"/></div></figure><p id="c11d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åƒå¾€å¸¸ä¸€æ ·ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªç¤ºä¾‹é©±åŠ¨çš„è¿‡ç¨‹ï¼Œæ‚¨å°†ä¼šå­¦åˆ°:</p><ul class=""><li id="2d26" class="lx ly iq ky b kz la lc ld lf lz lj ma ln mb lr mc md me mf bi translated">å¦‚ä½•åˆ›å»º<code class="fe ls lt lu lv b">Secrets</code> (CLIï¼Œ<code class="fe ls lt lu lv b">yaml</code>ç­‰ã€‚)å’Œ</li><li id="024d" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated">åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨å®ƒä»¬çš„å„ç§æ–¹å¼(ç¯å¢ƒå˜é‡ã€ä½“ç§¯ç­‰ã€‚)</li></ul><p id="90b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä»£ç (å’Œ<code class="fe ls lt lu lv b">YAML</code>)å¯ä»¥åœ¨GitHub ä¸Š<a class="ae kv" href="https://github.com/abhirockzz/kubernetes-in-a-nutshell/blob/master/secrets" rel="noopener ugc nofollow" target="_blank">è·å¾—ã€‚</a></p><p id="9947" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™ç¯‡æ–‡ç« åˆ†ä¸ºä¸¤ä¸ªé€»è¾‘éƒ¨åˆ†:åˆ›å»º<code class="fe ls lt lu lv b">Secrets</code>çš„æ–¹æ³•å’Œåœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨<code class="fe ls lt lu lv b">Secrets</code>çš„æŠ€æœ¯ã€‚</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="4c90" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">å…ˆå†³æ¡ä»¶</h1><p id="0d2b" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">è¦æµè§ˆæœ¬æ–‡ä¸­çš„ä¾‹å­ï¼Œæ‚¨éœ€è¦çš„åªæ˜¯ä¸€ä¸ªMinikubeé›†ç¾¤å’Œä¸€ä¸ªè®¿é—®è¯¥é›†ç¾¤çš„kubectl CLIå·¥å…·ã€‚</p><p id="a20b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å°†<a class="ae kv" href="https://kubernetes.io/docs/tasks/tools/install-minikube/" rel="noopener ugc nofollow" target="_blank"> Minikube </a>ä½œä¸ºå•èŠ‚ç‚¹Kubernetesé›†ç¾¤å®‰è£…åœ¨æ‚¨è®¡ç®—æœºä¸Šçš„è™šæ‹Ÿæœºä¸­ã€‚åœ¨Macä¸Šï¼Œæ‚¨å¯ä»¥ç®€å•åœ°:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="b1e2" class="nt mt iq lv b gy nu nv l nw nx">curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-darwin-amd64 \<br/>  &amp;&amp; chmod +x minikube</span><span id="3d06" class="nt mt iq lv b gy ny nv l nw nx">sudo mv minikube /usr/local/bin</span></pre><p id="b38d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å®‰è£…<a class="ae kv" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" rel="noopener ugc nofollow" target="_blank"> kubectl </a>ä¸Minikubeé›†ç¾¤äº¤äº’ã€‚åœ¨Macä¸Šï¼Œæ‚¨å¯ä»¥:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="64bf" class="nt mt iq lv b gy nu nv l nw nx">curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s <a class="ae kv" href="https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/darwin/amd64/kubectl" rel="noopener ugc nofollow" target="_blank">https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/darwin/amd64/kubectl</a></span><span id="ba14" class="nt mt iq lv b gy ny nv l nw nx">chmod +x ./kubectl</span><span id="e103" class="nt mt iq lv b gy ny nv l nw nx">sudo mv ./kubectl /usr/local/bin/kubectl</span></pre></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="7b00" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">åˆ›é€ ç§˜å¯†</h1><p id="1e27" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">è®©æˆ‘ä»¬çœ‹çœ‹åˆ›å»º<code class="fe ls lt lu lv b">Secret</code>çš„æŠ€å·§ã€‚</p><h2 id="e923" class="nt mt iq bd mu nz oa dn my ob oc dp nc lf od oe ne lj of og ng ln oh oi ni oj bi translated">ä½¿ç”¨<code class="fe ls lt lu lv b">data</code>éƒ¨åˆ†</h2><p id="6386" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">å¯ä»¥åœ¨å®šä¹‰çš„<code class="fe ls lt lu lv b">data</code>éƒ¨åˆ†åˆ›å»ºä¸€ä¸ª<code class="fe ls lt lu lv b">Secret</code>ä»¥åŠä½œä¸ºé”®å€¼å¯¹å­˜å‚¨çš„é…ç½®æ•°æ®ã€‚</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="bcf6" class="nt mt iq lv b gy nu nv l nw nx">apiVersion: v1<br/>kind: Secret<br/>metadata:<br/>  name: service-apikey<br/>data:<br/>  apikey: Zm9vYmFy</span></pre><p id="84f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">Secret</code>åŒ…å«ä»£è¡¨æ•æ„Ÿä¿¡æ¯çš„é”®å€¼æ•°æ®ï¼Œå…¶ä¸­<code class="fe ls lt lu lv b">apikey</code>æ˜¯é”®ï¼Œå€¼æ˜¯ä¸€ä¸ª<code class="fe ls lt lu lv b">base64</code>ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</p><p id="f09c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¦åœ¨Kubernetesåˆ›å»ºè¿™ä¸ª<code class="fe ls lt lu lv b">Secret</code>:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="fab8" class="nt mt iq lv b gy nu nv l nw nx">kubectl apply -f <a class="ae kv" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/secret-data.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/secret-data.yaml</a></span></pre><p id="4680" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†ç®€å•èµ·è§ï¼ŒYAMLæ–‡ä»¶ç›´æ¥ä»<a class="ae kv" href="https://github.com/abhirockzz/kubernetes-in-a-nutshell" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>ä¸­å¼•ç”¨ï¼Œä½†æ˜¯æ‚¨ä¹Ÿå¯ä»¥å°†è¯¥æ–‡ä»¶ä¸‹è½½åˆ°æ‚¨çš„æœ¬åœ°æœºå™¨ä¸Šï¼Œå¹¶ä»¥åŒæ ·çš„æ–¹å¼ä½¿ç”¨å®ƒã€‚</p><p id="f784" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç¡®è®¤<code class="fe ls lt lu lv b">Secret</code>å·²ç»åˆ›å»º:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="ccea" class="nt mt iq lv b gy nu nv l nw nx">kubectl get secret/service-apikey -o yaml</span></pre><p id="3dfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ‚¨å°†å¾—åˆ°ç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„YAMLå“åº”:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="e5b4" class="nt mt iq lv b gy nu nv l nw nx">apiVersion: v1<br/>data:<br/>  apikey: Zm9vYmFy<br/>kind: Secret<br/>metadata:<br/>  annotations:<br/>    kubectl.kubernetes.io/last-applied-configuration: |<br/>      {"apiVersion":"v1","data":{"apikey":"Zm9vYmFy"},"kind":"Secret","metadata":{"annotations":{},"name":"service-apikey","namespace":"default"}}<br/>  creationTimestamp: "2019-12-17T11:11:27Z"<br/>  name: service-apikey<br/>  namespace: default<br/>  resourceVersion: "113009"<br/>  selfLink: /api/v1/namespaces/default/secrets/service-apikey<br/>  uid: 671b547c-3316-4916-b6dc-be2b551b974e<br/>type: Opaque</span></pre><p id="58e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½¿ç”¨kubectl getè·å–<code class="fe ls lt lu lv b">Secret</code>ç»†èŠ‚ä¸ä¼šæ³„éœ²å…¶å†…å®¹ã€‚</p><p id="1798" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ³¨æ„<code class="fe ls lt lu lv b">apikey: Zm9vYmFy</code>æ˜¯æˆ‘ä»¬åœ¨YAMLæ¸…å•ä¸­æä¾›çš„ã€‚æ‚¨å¯ä»¥é€šè¿‡è§£ç æ¥æ£€æŸ¥çº¯æ–‡æœ¬æ ¼å¼:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="ced6" class="nt mt iq lv b gy nu nv l nw nx">echo 'Zm9vYmFy' | base64 --decode</span><span id="1569" class="nt mt iq lv b gy ny nv l nw nx">//foobar</span></pre><h2 id="f53d" class="nt mt iq bd mu nz oa dn my ob oc dp nc lf od oe ne lj of og ng ln oh oi ni oj bi translated"><strong class="ak">ä½¿ç”¨å­—ç¬¦ä¸²æ•°æ®æ®µ</strong></h2><p id="f81e" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">ä¸Šä¾‹ä¸­ä½¿ç”¨çš„<code class="fe ls lt lu lv b">data</code>å±æ€§ç”¨äºä¿å­˜<code class="fe ls lt lu lv b">base64</code>ç¼–ç ä¿¡æ¯ã€‚å¦‚æœæ‚¨æƒ³å®‰å…¨åœ°å­˜å‚¨çº¯æ–‡æœ¬æ•°æ®ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<code class="fe ls lt lu lv b">stringData</code>éƒ¨åˆ†ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="d135" class="nt mt iq lv b gy nu nv l nw nx">apiVersion: v1<br/>kind: Secret<br/>metadata:<br/>  name: plaintext-secret<br/>stringData:<br/>  foo: bar<br/>  mac: cheese</span></pre><p id="07bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">foo</code>å’Œ<code class="fe ls lt lu lv b">mac</code>çš„å€¼ä½œä¸ºçº¯æ–‡æœ¬ä¼ é€’ã€‚åˆ›å»ºæ­¤<code class="fe ls lt lu lv b">Secret</code>å¹¶ç¡®è®¤:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="fa29" class="nt mt iq lv b gy nu nv l nw nx">kubectl apply -f https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/secret-plaintext.yaml</span><span id="5c6b" class="nt mt iq lv b gy ny nv l nw nx">kubectl get secret/plaintext-secret -o yaml</span></pre><p id="c6b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™æ˜¯YAMLå›åº”çš„<code class="fe ls lt lu lv b">data</code>éƒ¨åˆ†ã€‚å®é™…æ•°æ®ä»¥<code class="fe ls lt lu lv b">base64</code>ç¼–ç æ ¼å¼å­˜å‚¨ã€‚</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="f4c7" class="nt mt iq lv b gy nu nv l nw nx">data:<br/>  foo: YmFy</span></pre><p id="5bb3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœæ‚¨è§£ç æ•°æ®ï¼Œæ‚¨å¯ä»¥ç¡®è®¤å®ƒä¸æˆ‘ä»¬æä¾›çš„åŸå§‹çº¯æ–‡æœ¬è¾“å…¥(<code class="fe ls lt lu lv b">bar</code>)ç›¸åŒ¹é…</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="4197" class="nt mt iq lv b gy nu nv l nw nx">echo 'YmFy' | base64 --decode</span><span id="df2f" class="nt mt iq lv b gy ny nv l nw nx">//bar</span></pre><p id="88ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ³¨æ„<code class="fe ls lt lu lv b">data</code>éƒ¨åˆ†ä¸æ¥å—çº¯æ–‡æœ¬å±æ€§ã€‚è¯•å›¾è¿™æ ·åšå°†å¯¼è‡´ç±»ä¼¼äº<em class="ok"> </em> this: <em class="ok"> </em> <code class="fe ls lt lu lv b"><em class="ok">illegal base64 data at input byte 8</em></code>çš„é”™è¯¯</p><h2 id="fb56" class="nt mt iq bd mu nz oa dn my ob oc dp nc lf od oe ne lj of og ng ln oh oi ni oj bi translated"><strong class="ak">æ–‡ä»¶å†…å®¹</strong></h2><p id="4968" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">æ‚¨ä¹Ÿå¯ä»¥å°†æ•´ä¸ªæ–‡ä»¶çš„å†…å®¹ä½œä¸ºè¾“å…¥æä¾›ç»™<code class="fe ls lt lu lv b">stringData</code>éƒ¨åˆ†ã€‚è¿™å¯èƒ½æ˜¯è¿™æ ·çš„:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="731d" class="nt mt iq lv b gy nu nv l nw nx">apiVersion: v1<br/>kind: Secret<br/>metadata:<br/>  name: secret-in-a-file<br/>stringData:<br/>  app-config.yaml: |-<br/>    hello: world<br/>    john: doe</span></pre><h2 id="fd58" class="nt mt iq bd mu nz oa dn my ob oc dp nc lf od oe ne lj of og ng ln oh oi ni oj bi translated">åˆ›å»ºæ­¤<code class="fe ls lt lu lv b">Secret</code></h2><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="1edd" class="nt mt iq lv b gy nu nv l nw nx">kubectl apply -f <a class="ae kv" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/secret-file.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/secret-file.yaml</a></span></pre><p id="c2cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™ä¸ªç»“æœ<code class="fe ls lt lu lv b">Secret</code>å°†åŒ…å«ä¸€ä¸ªåä¸º<code class="fe ls lt lu lv b">app-config.yaml</code>çš„å¯†é’¥ï¼Œå…¶å†…å®¹(å€¼)å°†æ˜¯æ‰€æä¾›æ•°æ®çš„<code class="fe ls lt lu lv b">base64</code>ç¼–ç ã€‚</p><p id="c30a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åƒå¾€å¸¸ä¸€æ ·ï¼Œæ‚¨åœ¨Kubernetesä¸­ç¡®è®¤è¿™ä¸€ç‚¹ï¼Œå¹¶è§£ç å†…å®¹ã€‚</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="17a7" class="nt mt iq lv b gy nu nv l nw nx">kubectl get secret/secret-in-a-file -o yaml<br/>echo '&lt;"data" content in yaml response&gt; | base64 --decode</span></pre><p id="c239" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ³¨æ„:å½“æ‚¨ä½¿ç”¨è¿™ç§æŠ€æœ¯æ—¶ï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºè´Ÿè´£è§£æå‡ºä»£è¡¨<code class="fe ls lt lu lv b">Secret</code>é…ç½®çš„æ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒç¢°å·§æ˜¯æ¢è¡Œç¬¦åˆ†éš”çš„é”®-å€¼å¯¹ï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="7f1b" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">ä½¿ç”¨<code class="fe ls lt lu lv b">kubectl</code></h1><p id="fac4" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">ä½ å¯ä»¥ä½¿ç”¨<code class="fe ls lt lu lv b">kubectl create secret</code>å‘½ä»¤æ¥åˆ›å»º<code class="fe ls lt lu lv b">Secret</code>å¯¹è±¡</p><h2 id="3799" class="nt mt iq bd mu nz oa dn my ob oc dp nc lf od oe ne lj of og ng ln oh oi ni oj bi translated"><strong class="ak">ä½¿ç”¨</strong> <code class="fe ls lt lu lv b"><strong class="ak">--from-literal</strong></code></h2><p id="7eae" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">æ‚¨å¯ä»¥ä½¿ç”¨CLIä½¿ç”¨çº¯æ–‡æœ¬æ•°æ®åˆ›å»º<code class="fe ls lt lu lv b">Secret</code>(è¿™å°†ä»¥<code class="fe ls lt lu lv b">base64</code>ç¼–ç æ ¼å¼å­˜å‚¨åœ¨Kubernetesä¸­):</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="aba8" class="nt mt iq lv b gy nu nv l nw nx">kubectl create secret generic redis-credentials --from-literal=user=poweruser --from-literal=password='f0ob@r'</span></pre><h2 id="ba01" class="nt mt iq bd mu nz oa dn my ob oc dp nc lf od oe ne lj of og ng ln oh oi ni oj bi translated"><strong class="ak">ä½¿ç”¨</strong> <code class="fe ls lt lu lv b"><strong class="ak">--from-file</strong></code></h2><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="9180" class="nt mt iq lv b gy nu nv l nw nx">kubectl create secret generic topsecret --from-file=api_keys.txt</span></pre><p id="a7a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™å°†åˆ›å»ºä¸€ä¸ªç§˜å¯†(<code class="fe ls lt lu lv b">topsecret</code>)</p><ul class=""><li id="af4d" class="lx ly iq ky b kz la lc ld lf lz lj ma ln mb lr mc md me mf bi translated">ä¸æ–‡ä»¶åŒåçš„å¯†é’¥ï¼Œå³æœ¬ä¾‹ä¸­çš„<code class="fe ls lt lu lv b">api_keys.txt</code></li><li id="758d" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated">å’Œå€¼ä½œä¸ºæ–‡ä»¶çš„å†…å®¹</li></ul><h2 id="e3b7" class="nt mt iq bd mu nz oa dn my ob oc dp nc lf od oe ne lj of og ng ln oh oi ni oj bi translated"><strong class="ak">ä»ä¸€ä¸ªç›®å½•ä¸­çš„æ–‡ä»¶</strong></h2><p id="c62d" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">æ‚¨å¯ä»¥ç®€å•åœ°æŒ‡å‘ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½å°†ç”¨äºåˆ›å»º<code class="fe ls lt lu lv b">Secret</code>ã€‚</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="e356" class="nt mt iq lv b gy nu nv l nw nx">kubectl create secret generic topsecrets --from-file=/home/credentials/</span></pre><p id="6a91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½ æœ€ç»ˆä¼šå¾—åˆ°</p><ul class=""><li id="be5e" class="lx ly iq ky b kz la lc ld lf lz lj ma ln mb lr mc md me mf bi translated">å¤šä¸ªå¯†é’¥å°†ä¸å•ä¸ªæ–‡ä»¶åç›¸åŒ</li><li id="dad6" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated">è¯¥å€¼å°†æ˜¯ç›¸åº”æ–‡ä»¶çš„å†…å®¹</li></ul></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="7508" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">ä½¿ç”¨ç§˜å¯†</h1><p id="972b" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">ä¸ºäº†è®©ç§˜å¯†æœ‰ç”¨ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿å®ƒä»¬å¯¹æˆ‘ä»¬çš„åº”ç”¨ç¨‹åº(ä¾‹å¦‚ï¼Œpod)å¯ç”¨ã€‚è®©æˆ‘ä»¬æ¢ç´¢ä¸€ä¸‹æˆ‘ä»¬èƒ½åšåˆ°è¿™ä¸€ç‚¹çš„æ–¹æ³•</p><h2 id="748f" class="nt mt iq bd mu nz oa dn my ob oc dp nc lf od oe ne lj of og ng ln oh oi ni oj bi translated">ç¯å¢ƒå˜é‡</h2><p id="beea" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">æ‚¨å¯ä»¥å°†<code class="fe ls lt lu lv b">Secret</code>æ•°æ®ä½œä¸ºç¯å¢ƒå˜é‡åœ¨<code class="fe ls lt lu lv b">Pod</code>ä¸­ä½¿ç”¨(å°±åƒ<code class="fe ls lt lu lv b">ConfigMap</code>)ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="e6cd" class="nt mt iq lv b gy nu nv l nw nx">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: pod1<br/>spec:<br/>  containers:<br/>    - name: nginx<br/>      image: nginx<br/>      env:<br/>        - name: API_KEY<br/>          valueFrom:<br/>            secretKeyRef:<br/>              name: service-apikey<br/>              key: apikey</span></pre><p id="8af4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬ä½¿ç”¨<code class="fe ls lt lu lv b">Secret</code> <code class="fe ls lt lu lv b">service-apikey</code>ä¸­çš„é”®<code class="fe ls lt lu lv b">apikey</code>ï¼Œå¹¶ç¡®ä¿å®ƒçš„å€¼ä½œä¸º<code class="fe ls lt lu lv b">Pod</code>ä¸­çš„ç¯å¢ƒå˜é‡<code class="fe ls lt lu lv b">API_KEY</code>å¯ç”¨ã€‚</p><p id="f6e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åˆ›å»º<code class="fe ls lt lu lv b">Pod</code>(å‡è®¾æ‚¨æœ‰æ ¹æ®ä¹‹å‰çš„ç¤ºä¾‹åˆ›å»ºçš„<code class="fe ls lt lu lv b">Secret</code>)å¹¶ç¡®è®¤ã€‚</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="6dae" class="nt mt iq lv b gy nu nv l nw nx">kubectl apply -f <a class="ae kv" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/pod-secret-env.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/pod-secret-env.yaml</a></span><span id="93ad" class="nt mt iq lv b gy ny nv l nw nx">kubectl get pods -w</span></pre><p id="7367" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç­‰å¾…<code class="fe ls lt lu lv b">Pod</code>è½¬æ¢åˆ°<code class="fe ls lt lu lv b">Running</code>çŠ¶æ€ã€‚ç„¶åï¼Œç¡®è®¤ç¯å¢ƒå˜é‡å·²ç»è¢«æ³¨å…¥åˆ°<code class="fe ls lt lu lv b">Pod</code>ä¸­ã€‚</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="0086" class="nt mt iq lv b gy nu nv l nw nx">kubectl exec pod1 -- env | grep API_KEY</span></pre><p id="bc66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½ åº”è¯¥ä¼šå¾—åˆ°è¿™æ ·çš„å›åº”â€”â€”<code class="fe ls lt lu lv b">API_KEY=foobar</code>ã€‚</p><p id="4597" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ‚¨å¯ä»¥ä½¿ç”¨<code class="fe ls lt lu lv b">envFrom</code>æ¥æ–¹ä¾¿åœ°ä½¿ç”¨æ‰€æœ‰æ¡ç›®ä½œä¸º<code class="fe ls lt lu lv b">Pod</code>ä¸­çš„ç¯å¢ƒå˜é‡ï¼Œè€Œä¸æ˜¯å¼•ç”¨<code class="fe ls lt lu lv b">Secret</code>ä¸­çš„å•ä¸ªæ¡ç›®ã€‚ä½ å¯ä»¥è¿™æ ·ä½¿ç”¨å®ƒ:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="9328" class="nt mt iq lv b gy nu nv l nw nx">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: pod2<br/>spec:<br/>  containers:<br/>    - name: nginx<br/>      image: nginx<br/>      envFrom:<br/>        - secretRef:<br/>            name: plaintext-secret</span></pre><p id="226c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬ç”¨<code class="fe ls lt lu lv b">envFrom.secretRef</code>æ¥æŒ‡ä»£<code class="fe ls lt lu lv b">plaintext-secret</code> <code class="fe ls lt lu lv b">Secret</code>ã€‚è¦åˆ›å»ºè¿™ä¸ª<code class="fe ls lt lu lv b">Pod</code>:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="4514" class="nt mt iq lv b gy nu nv l nw nx">kubectl apply -f <a class="ae kv" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/pod-secret-envFrom.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/pod-secret-envFrom.yaml</a></span><span id="7ee8" class="nt mt iq lv b gy ny nv l nw nx">kubectl get pods -w</span></pre><p id="4ad3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç­‰å¾…<code class="fe ls lt lu lv b">Pod</code>è½¬æ¢åˆ°<code class="fe ls lt lu lv b">Running</code>çŠ¶æ€ï¼Œç„¶åç¡®è®¤ç¯å¢ƒå˜é‡çš„å­˜åœ¨ã€‚</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="3856" class="nt mt iq lv b gy nu nv l nw nx">kubectl exec pod2 -- env | grep foo<br/>//foo=bar</span><span id="389d" class="nt mt iq lv b gy ny nv l nw nx">kubectl exec pod2 -- env | grep mac<br/>//mac=cheese</span></pre><p id="6aa0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™è¯å®äº†<code class="fe ls lt lu lv b">foo</code>å’Œ<code class="fe ls lt lu lv b">mac</code>éƒ½ä½œä¸ºç¯å¢ƒå˜é‡ä¸å®ƒä»¬çš„è§£ç å€¼(å³<code class="fe ls lt lu lv b">bar</code>å’Œ<code class="fe ls lt lu lv b">cheese</code>)ä¸€èµ·è¢«æ·»åŠ åˆ°<code class="fe ls lt lu lv b">the</code> Podä¸­</p><h2 id="b17a" class="nt mt iq bd mu nz oa dn my ob oc dp nc lf od oe ne lj of og ng ln oh oi ni oj bi translated"><strong class="ak">å·</strong></h2><p id="90fe" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">æ‚¨å¯ä»¥å°†<code class="fe ls lt lu lv b">Secrets</code>ä½œä¸º<code class="fe ls lt lu lv b">Volume</code>å®‰è£…åœ¨<code class="fe ls lt lu lv b">Pod</code>å†…ã€‚ä¾‹å¦‚:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="0fae" class="nt mt iq lv b gy nu nv l nw nx">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: pod3<br/>spec:<br/>  containers:<br/>    - name: nginx<br/>      image: nginx<br/>      volumeMounts:<br/>        - name: apikey-config-volume<br/>          mountPath: /secret<br/>          readOnly: true<br/>  volumes:<br/>    - name: apikey-config-volume<br/>      secret:<br/>        secretName: service-apikey</span></pre><p id="0d78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">apikey-config-volume</code>å·æ˜¯æŒ‡<code class="fe ls lt lu lv b">service-apikey</code> <code class="fe ls lt lu lv b">Secret</code>ã€‚è¦åˆ›å»ºè¿™ä¸ª<code class="fe ls lt lu lv b">Pod</code>:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="f2e2" class="nt mt iq lv b gy nu nv l nw nx">kubectl apply -f <a class="ae kv" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/pod-secret-volume.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/pod-secret-volume.yaml</a></span><span id="7efa" class="nt mt iq lv b gy ny nv l nw nx">kubectl get pods -w</span></pre><p id="0dd1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç­‰å¾…<code class="fe ls lt lu lv b">Pod</code>è½¬æ¢åˆ°<code class="fe ls lt lu lv b">Running</code>çŠ¶æ€ã€‚ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="951e" class="nt mt iq lv b gy nu nv l nw nx">kubectl exec pod3 -- cat /secret/apikey<br/>//foobar</span></pre><p id="8b70" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™ç¡®è®¤äº†å¯†é’¥<code class="fe ls lt lu lv b">service-apikey</code>ä¸­çš„å¯†é’¥<code class="fe ls lt lu lv b">apikey</code>ä½œä¸ºä¸€ä¸ªæ–‡ä»¶(åä¸º<code class="fe ls lt lu lv b">apikey</code>)è¢«å®‰è£…åœ¨<code class="fe ls lt lu lv b">/secret</code>ç›®å½•ä¸­(å…·ä½“è§Pod)ã€‚è¯¥æ–‡ä»¶çš„å†…å®¹åªæ˜¯ç§˜å¯†å€¼ï¼Œå³æœ¬ä¾‹ä¸­çš„<code class="fe ls lt lu lv b">foobar</code>ã€‚</p><h2 id="0570" class="nt mt iq bd mu nz oa dn my ob oc dp nc lf od oe ne lj of og ng ln oh oi ni oj bi translated"><strong class="ak">ä½¿ç”¨</strong> <code class="fe ls lt lu lv b"><strong class="ak">imagePullSecrets</strong></code></h2><p id="7856" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥ä½¿ç”¨<code class="fe ls lt lu lv b">Secrets</code>,è¿™æ ·æ‚¨çš„åº”ç”¨ç¨‹åºPodå°±å¯ä»¥ä½¿ç”¨å®ƒæ¥è®¤è¯å¹¶ä»ç§æœ‰Dockeræ³¨å†Œä¸­å¿ƒè·å–Dockerå›¾åƒã€‚</p><p id="53ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">Secrets</code>å…¶å®æœ‰ä¸‰ç§ç±»å‹:</p><ul class=""><li id="a2ff" class="lx ly iq ky b kz la lc ld lf lz lj ma ln mb lr mc md me mf bi translated"><code class="fe ls lt lu lv b">generic</code>â€”â€”ç”¨äºå­˜å‚¨é”®å€¼å¯¹ï¼Œå°±åƒæˆ‘ä»¬åœ¨å‰é¢çš„ä¾‹å­ä¸­çœ‹åˆ°çš„é‚£æ ·</li><li id="be71" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated"><code class="fe ls lt lu lv b">tls</code> -å°†å…¬é’¥/ç§é’¥å¯¹ä¿¡æ¯å­˜å‚¨ä¸º<code class="fe ls lt lu lv b">Secrets</code></li><li id="f496" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated"><code class="fe ls lt lu lv b">docker-registry</code> -ç”¨äºå‘Dockeræ³¨å†Œè¡¨è®¤è¯çš„å‡­è¯ã€‚</li></ul><p id="7d6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™é¡¹æŠ€æœ¯çš„ä½¿ç”¨æ–¹æ³•éå¸¸ç®€å•:</p><ul class=""><li id="0cae" class="lx ly iq ky b kz la lc ld lf lz lj ma ln mb lr mc md me mf bi translated">ä½¿ç”¨<code class="fe ls lt lu lv b">docker-registry</code> <code class="fe ls lt lu lv b">Secret</code>ç±»å‹åœ¨Kubernetesä¸­å­˜å‚¨ç§æœ‰Dockeræ³¨å†Œè¡¨å‡­è¯ã€‚</li><li id="0fd4" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated">ç„¶åä½¿ç”¨<code class="fe ls lt lu lv b">imagePullSecrets</code>(åœ¨Podä¸­)æ¥å¼•ç”¨åŒ…å«Dockeræ³¨å†Œå‡­è¯çš„<code class="fe ls lt lu lv b">Secret</code>ã€‚</li></ul><p id="5138" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸€ä¸ªä¾‹å­æ€»æ˜¯æœ‰å¸®åŠ©çš„:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="0152" class="nt mt iq lv b gy nu nv l nw nx">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: pod4<br/>spec:<br/>  containers:<br/>    - name: privateapp<br/>      image: abhirockzz/test-private-repo:latest<br/>      command: ["/bin/sh"]<br/>      args: ["-c", "while true; do date; sleep 5;done"]<br/>  imagePullSecrets:<br/>    - name: docker-repo-secret</span></pre><p id="0cca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">çœ‹çœ‹<code class="fe ls lt lu lv b">imagePullSecrets.name</code>æ€ä¹ˆæŒ‡ä»£ä¸€ä¸ªå«<code class="fe ls lt lu lv b">docker-repo-secret</code>çš„<code class="fe ls lt lu lv b">Secret</code>ã€‚è®©æˆ‘ä»¬åˆ›é€ å®ƒã€‚</p><p id="1a10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½†åœ¨æ­¤ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨æœ‰ä¸€ä¸ªç§äººDockeræ³¨å†Œè¡¨ã€‚æˆ‘ç”¨çš„æ˜¯<code class="fe ls lt lu lv b"><a class="ae kv" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank">DockerHub</a></code>ï¼Œå…¶ä»–çš„ä½ ä¹Ÿå¯ä»¥é€‰ã€‚</p><p id="181d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">é¦–å…ˆä½¿ç”¨<code class="fe ls lt lu lv b">kubectl create secret docker-registry</code>å‘½ä»¤åˆ›å»ºä¸€ä¸ªåŒ…å«æ‚¨çš„Dockerå‡­è¯çš„<code class="fe ls lt lu lv b">Secret</code>(åä¸º<code class="fe ls lt lu lv b">docker-repo-secret</code>)ã€‚</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="e6c3" class="nt mt iq lv b gy nu nv l nw nx">kubectl create secret docker-registry docker-repo-secret --docker-server=DOCKER_REG_SERVER --docker-username=DOCKER_REG_USERNAME --docker-password=DOCKER_REG_PASSWORD --docker-email=DOCKER_REG_EMAIL</span></pre><p id="6284" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¯¹äºDocker Hub:</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="3233" class="nt mt iq lv b gy nu nv l nw nx">kubectl create secret docker-registry docker-repo-secret --docker-server=https://index.docker.io/v1/ --docker-username=foobarbaz --docker-password=t0ps3cr3t --docker-email=foobarbaz@gmail.com</span><span id="d8ff" class="nt mt iq lv b gy ny nv l nw nx">kubectl get secret/docker-repo-secret -o yaml</span></pre><p id="8ff1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">https://index.docker.io/v1/</code>æ˜¯Docker Hubæ³¨å†ŒæœåŠ¡å™¨</p><p id="83a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºäº†è¿›è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<code class="fe ls lt lu lv b"><a class="ae kv" href="https://hub.docker.com/_/busybox" rel="noopener ugc nofollow" target="_blank">busybox</a></code>å›¾åƒå’Œ<code class="fe ls lt lu lv b">tag</code>å›¾åƒ</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="6a29" class="nt mt iq lv b gy nu nv l nw nx">docker pull busybox<br/>docker tag busybox [DOCKER_REG]/[DOCKER_PRIVATE_REPO]:[IMAGE_TAG]</span><span id="26bb" class="nt mt iq lv b gy ny nv l nw nx">e.g. <br/>docker tag busybox abhirockzz/test-private-repo:latest</span></pre><p id="cdf8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">â€¦å’Œ<code class="fe ls lt lu lv b">push</code> it</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="4a9d" class="nt mt iq lv b gy nu nv l nw nx">docker push [DOCKER_REG]/[DOCKER_PRIVATE_REPO]:[IMAGE_TAG]</span><span id="e7da" class="nt mt iq lv b gy ny nv l nw nx">e.g. <br/>docker push abhirockzz/test-private-repo:latest</span></pre><p id="c7a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸€æ—¦ç§æœ‰å›è´­å‡†å¤‡å°±ç»ªï¼Œæ‚¨å°±å¯ä»¥åˆ›å»º<code class="fe ls lt lu lv b">Pod</code>ï¼Œå®ƒå°†ä½¿ç”¨é€šè¿‡<code class="fe ls lt lu lv b">Secret</code>æä¾›ç»™å®ƒçš„æ³¨å†Œè¡¨å‡­è¯ä»ç§æœ‰å›è´­ä¸­æå–æ˜ åƒ</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="00c4" class="nt mt iq lv b gy nu nv l nw nx">kubectl apply -f <a class="ae kv" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/pod-secret-docker.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/secrets/pod-secret-docker.yaml</a></span><span id="111d" class="nt mt iq lv b gy ny nv l nw nx">kubectl get pods -w</span></pre><p id="0b10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç­‰å¾…<code class="fe ls lt lu lv b">Pod</code>ç§»åŠ¨åˆ°<code class="fe ls lt lu lv b">Running</code>çŠ¶æ€ã€‚</p><p id="cccd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœæ‚¨çœ‹åˆ°ä¸€ä¸ª<code class="fe ls lt lu lv b">ErrImagePull</code>é”™è¯¯ï¼Œè¿™è¡¨æ˜å¯èƒ½å­˜åœ¨å‘Dockeræ³¨å†Œä¸­å¿ƒè®¤è¯çš„é—®é¢˜ã€‚è¦è·å–è¯¦ç»†ä¿¡æ¯ï¼Œè¯·ä½¿ç”¨:<code class="fe ls lt lu lv b">kubectl describe pod/pod4</code></p><p id="47ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç¡®è®¤podå·¥ä½œæ­£å¸¸:<code class="fe ls lt lu lv b">kubectl logs -f pod4</code></p><p id="102a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç”±äº<code class="fe ls lt lu lv b">busybox</code>å›¾åƒæœ¬èº«å¹¶ä¸çœŸæ­£åšä»»ä½•äº‹æƒ…ï¼Œæˆ‘ä»¬æ‰§è¡Œ:<code class="fe ls lt lu lv b">while true; do date; sleep 5;done</code>(å¦‚<code class="fe ls lt lu lv b">Pod</code>è§„èŒƒä¸­æ‰€æä¾›çš„)ã€‚å› æ­¤ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°æ—¥å¿—(æ¯5ç§’æ‰“å°ä¸€æ¬¡)ã€‚</p><pre class="kg kh ki kj gt np lv nq nr aw ns bi"><span id="44ec" class="nt mt iq lv b gy nu nv l nw nx">Tue Dec 17 14:17:34 UTC 2019<br/>Tue Dec 17 14:17:39 UTC 2019<br/>Tue Dec 17 14:17:44 UTC 2019<br/>Tue Dec 17 14:18:49 UTC 2019</span></pre><p id="0fb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸€åˆ‡éƒ½å¥½ï¼è¿™æ„å‘³ç€Podèƒ½å¤Ÿä½¿ç”¨Dockerå‡­è¯ä»ç§æœ‰Docker repoä¸­ä¸‹è½½ä½ çš„å›¾åƒï¼ŒDockerå‡­è¯é€šè¿‡<code class="fe ls lt lu lv b">imagePullSecrets</code>æ³¨å…¥åˆ°<code class="fe ls lt lu lv b">Pod</code>ä¸­ï¼Œè€Œ<code class="fe ls lt lu lv b">imagePullSecrets</code>æœ¬èº«å¼•ç”¨äº†<code class="fe ls lt lu lv b">Secret</code></p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="2775" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">å¾ˆé«˜å…´çŸ¥é“</h1><p id="2912" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">ä»¥ä¸‹æ˜¯æ‚¨åœ¨ä½¿ç”¨<code class="fe ls lt lu lv b">Secrets</code>æ—¶åº”è¯¥è°¨è®°çš„äº‹é¡¹åˆ—è¡¨(å¹¶éè¯¦å°½):</p><ul class=""><li id="6cdb" class="lx ly iq ky b kz la lc ld lf lz lj ma ln mb lr mc md me mf bi translated"><code class="fe ls lt lu lv b">Secret</code>å¿…é¡»åœ¨ä»»ä½•æƒ³è¦ä½¿ç”¨å®ƒçš„<code class="fe ls lt lu lv b">Pod</code>ä¹‹å‰è¢«åˆ›å»ºã€‚</li><li id="68ed" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated"><code class="fe ls lt lu lv b">Secrets</code>åœ¨ä¸€ä¸ª<code class="fe ls lt lu lv b">namespace</code>å†…é€‚ç”¨ï¼Œå³å®ƒä»¬åªèƒ½ç”±åŒä¸€ä¸ª<code class="fe ls lt lu lv b">namespace</code>å†…çš„<code class="fe ls lt lu lv b">Pods</code>ä½¿ç”¨</li><li id="fc56" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated">å¦‚æœåœ¨<code class="fe ls lt lu lv b">Secret</code>ä¸­å¼•ç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨çš„é”®(ä½¿ç”¨<code class="fe ls lt lu lv b">secretKeyRef</code>ï¼Œåˆ™<code class="fe ls lt lu lv b">Pod</code>ä¸ä¼šå¯åŠ¨</li><li id="7c5d" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated">1mbæ˜¯ä¸ªäººçš„å¤§å°é™åˆ¶<code class="fe ls lt lu lv b">Secrets</code></li></ul><p id="31ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™å°±æ˜¯æœ¬æœŸã€Šæœå£³ä¸­çš„åº“ä¼¯å†…ç‰¹ã€‹ç³»åˆ—çš„å…¨éƒ¨å†…å®¹ã€‚æ•¬è¯·å…³æ³¨æ›´å¤šå†…å®¹ï¼</p><p id="bcc7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœä½ å¯¹ä½¿ç”¨<a class="ae kv" href="https://azure.microsoft.com/services/kubernetes-service/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure </a>å­¦ä¹ Kuberneteså’ŒContainersæ„Ÿå…´è¶£ï¼Œåªéœ€<a class="ae kv" href="https://azure.microsoft.com/en-us/free/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">åˆ›å»ºä¸€ä¸ªå…è´¹è´¦æˆ·</a>å°±å¯ä»¥å¼€å§‹äº†ã€‚ä¸€ä¸ªå¥½çš„èµ·ç‚¹æ˜¯ä½¿ç”¨æ–‡æ¡£ä¸­çš„<a class="ae kv" href="https://docs.microsoft.com/azure/aks/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">å¿«é€Ÿå…¥é—¨ã€æ•™ç¨‹å’Œä»£ç ç¤ºä¾‹</a>æ¥ç†Ÿæ‚‰è¯¥æœåŠ¡ã€‚æˆ‘ä¹Ÿå¼ºçƒˆæ¨èæŸ¥çœ‹50å¤©çš„Kuberneteså­¦ä¹ è·¯å¾„ã€‚é«˜çº§ç”¨æˆ·å¯èƒ½å¸Œæœ›å‚è€ƒ<a class="ae kv" href="https://docs.microsoft.com/azure/aks/best-practices?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Kubernetesæœ€ä½³å®è·µ</a>æˆ–è§‚çœ‹ä¸€äº›<a class="ae kv" href="https://azure.microsoft.com/resources/videos/index/?services=kubernetes-service&amp;WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">è§†é¢‘</a>ä»¥äº†è§£æ¼”ç¤ºã€ä¸»è¦ç‰¹æ€§å’ŒæŠ€æœ¯ä¼šè®®ã€‚</p><p id="4311" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘çœŸçš„å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œå¹¶ä»ä¸­å­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ã€‚ğŸ™Œ</p></div></div>    
</body>
</html>