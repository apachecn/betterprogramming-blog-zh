# Python ä¸­çš„ 5 ç§å¸¸è§åæ¨¡å¼

> åŸæ–‡ï¼š<https://betterprogramming.pub/5-common-anti-patterns-in-python-a9d6443fabe4>

## å½“è¾“å…¥é‡å¾ˆå¤§æ—¶ï¼Œé¿å…ä½¿ç”¨åˆ—è¡¨ç†è§£

![](img/8d68f83389b2cf99485428f675fbda5a.png)

ç…§ç‰‡ç”±[å¢å¡Â·å¸ƒæ‹‰æ²ƒ](https://unsplash.com/@lucabravo?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

> â€œå…‰æœ‰ä»£ç æ˜¯ä¸å¤Ÿçš„ã€‚â€ç½—ä¼¯ç‰¹Â·é©¬ä¸

Python æ˜¯ 2021 å¹´æœ€å—æ¬¢è¿çš„è¯­è¨€ä¹‹ä¸€ã€‚

ç®€å•çš„è¯­æ³•ä½¿å®ƒæˆä¸ºæ–°æ‰‹ç¨‹åºå‘˜çš„æµè¡Œé€‰æ‹©ã€‚

ç”±äºåŠ¨æ€æ€§å’Œçµæ´»æ€§ï¼ŒPython å¼€å‘äººå‘˜æœ‰æ—¶å¾ˆå®¹æ˜“ç¼–å†™å‡ºé”™è¯¯çš„ã€ä½æ•ˆçš„ä»£ç ã€‚

æœ¬æ–‡å°†å‘è¯»è€…ä»‹ç» Python ä¸­å¸¸è§çš„åæ¨¡å¼ï¼Œå¹¶æå‡ºä¸€äº›ä¿®å¤æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å°†å¸¦æ¥æ›´å¥½çš„å¼€å‘å®è·µã€‚

# 1.å¯¹å¯è¿­ä»£å¯¹è±¡ä½¿ç”¨ map()å’Œ filter()

å†…ç½®çš„`map`å’Œ`filter`é€šè¿‡[å‡½æ•°å¼ç¼–ç¨‹](https://www.geeksforgeeks.org/functional-programming-paradigm)çš„åŸç†å¸®åŠ©æˆ‘ä»¬è½¬æ¢ Python ä¸­çš„å¯è¿­ä»£å¯¹è±¡ã€‚

è¿™ä¸¤ç§æ–¹æ³•éƒ½æ¥å—å‡½æ•°å’Œ iterable ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ç›¸åº”çš„å¯¹è±¡ã€‚

é€šè¿‡å°†è¿™ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™ Python ä¸­å†…ç½®çš„`list`æ„é€ å‡½æ•°ï¼Œå¯ä»¥å°†å®ƒè½¬æ¢æˆä¸€ä¸ªåˆ—è¡¨ã€‚

æˆ‘ä»¬ç»å¸¸ä½¿ç”¨`lambda`å‡½æ•°ä½œä¸º`map`ã€`filter`å‡½æ•°çš„å‚æ•°:

ä»£ç çœ‹èµ·æ¥ç›¸å½“ç¬¨æ‹™å’Œä¸æ¸…æ¥šã€‚è·å¾—ç›¸åŒç»“æœçš„æ›´å¥½æ–¹æ³•æ˜¯ä½¿ç”¨ [**åˆ—è¡¨ç†è§£**](https://www.w3schools.com/python/python_lists_comprehension.asp) :

lambda å‡½æ•°çš„ç¼ºä¹ä½¿å¾—åˆ—è¡¨çš„ç†è§£æ›´åŠ æ˜“è¯»å’Œç®€æ´ã€‚

# 2.å¤§é‡è¾“å…¥æ—¶ä½¿ç”¨åˆ—è¡¨ç†è§£

åˆ—è¡¨ç†è§£å¯¹äºç¼–å†™æ¸…æ™°ã€ç®€æ´çš„ä»£ç æ¥è¯´æ˜¯éå¸¸æ£’çš„ã€‚

ç„¶è€Œï¼Œåˆ—è¡¨ç†è§£æ€»æ˜¯åˆ›å»º iterable ä¸­æ¯ä¸ªå€¼çš„åˆ—è¡¨ã€‚å½“è¾“å…¥éå¸¸å¤§æ—¶ï¼Œè¿™ä¼šå¯¼è‡´å†…å­˜é—®é¢˜ï¼›å®ƒä¼šå¯¼è‡´ä½ çš„æœºå™¨å´©æºƒã€‚

**G**

è¦åˆ›å»ºå®ƒä»¬ï¼Œä½ æ‰€è¦åšçš„å°±æ˜¯ç”¨`()`æ‹¬å·æ›¿æ¢åˆ—è¡¨ç†è§£ä¸­çš„`[]`æ‹¬å·ã€‚

![](img/a553532727ec8e34f3eaaeef4466b591.png)

ç”Ÿæˆå™¨è¡¨è¾¾å¼ä¸æ˜¯åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„åˆ—è¡¨ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ã€‚

è¿™ä¸ª**é™ä½äº†åˆ›å»º**çš„é€Ÿåº¦ï¼Œè€Œ**ä¼˜åŒ–äº†å†…å­˜åˆ†é…**ã€‚æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨`next`å‡½æ•°æˆ–å¾ªç¯è®¿é—®ç”Ÿæˆå™¨è¡¨è¾¾å¼çš„æ¯ä¸ªåç»­å…ƒç´ ã€‚

**æ³¨æ„:**
ç”Ÿæˆå™¨è¡¨è¾¾å¼æ˜¯æœ‰çŠ¶æ€çš„ï¼Œæ‰€ä»¥åœ¨è¯•å›¾é‡ç”¨å®ƒä»¬æ—¶è¦å°å¿ƒã€‚å¦‚æœæ‰“ç®—å¤šæ¬¡ä½¿ç”¨è¿­ä»£å™¨ï¼Œå¯èƒ½éœ€è¦é‡æ–°åˆ›å»ºå®ƒã€‚

é˜…è¯» Brett Slatkin çš„â€œ[æœ‰æ•ˆçš„ Python: 90 ç§ç¼–å†™æ›´å¥½çš„ Python(ç¬¬äºŒç‰ˆ)](http://effectivepython.com)çš„å…·ä½“æ–¹æ³•â€ä¸­çš„ç¬¬ 31 é¡¹ï¼Œä»¥ä¾¿å¾ˆå¥½åœ°äº†è§£å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚

# 3.ä¸ä½¿ç”¨ range()çš„æƒ…å†µ

`range`å‡½æ•°å¯¹äºæ•´æ•°çš„è¿­ä»£å¾ˆæœ‰ç”¨ã€‚

å½“è¿­ä»£åˆ—è¡¨ç­‰å¯è¿­ä»£çš„æ•°æ®ç»“æ„æ—¶ï¼Œæ‚¨å¯ä»¥å®Œå…¨ä¾èµ– for å¾ªç¯è¯­æ³•æ¥è®¿é—®æ¯ä¸€é¡¹ã€‚ä»£ç å¦‚ä¸‹:

ç„¶è€Œï¼Œå½“æƒ³è¦è®¿é—®ç´¢å¼•å’Œå…ƒç´ æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ—è¡¨é•¿åº¦ä¸Šä½¿ç”¨`range`æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤º:

ä»£ç çœ‹èµ·æ¥ä¸å¯è¯»ï¼Œå› ä¸ºæ‚¨å¿…é¡»è°ƒç”¨åˆ—è¡¨ä¸Šçš„`len`ï¼Œç„¶åä½¿ç”¨`range`åŒ…è£…è¾“å‡ºã€‚ä¸ºäº†ä½¿å®ƒæ›´åŠ  Pythonic åŒ–ï¼Œæˆ‘ä»¬å¿…é¡»æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚

æ›´å¥½çš„æ–¹æ³•æ˜¯è°ƒç”¨ list å¯¹è±¡ä¸Šçš„`enumerate`å‡½æ•°ã€‚è¿™å°†åˆ›å»ºä¸€ä¸ªç”Ÿæˆå™¨ï¼Œç”Ÿæˆåˆ—è¡¨é¡¹çš„ç´¢å¼•å’Œå€¼ã€‚

è¿™ä¸ªçœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¹²å‡€å¤šäº†ï¼Ÿ

# 4.ç¼ºå°‘å­—å…¸é”®çš„é—®é¢˜æ˜¯

å­—å…¸å…·æœ‰å¿«é€Ÿè®¿é—®ã€èµ‹å€¼ã€æ’å…¥å’Œåˆ é™¤çš„èƒ½åŠ›ï¼Œè¿™ä½¿å¾—å®ƒæˆä¸ºä¸€ç§éå¸¸æµè¡Œçš„æ•°æ®ç»“æ„ã€‚

å½“**è¯•å›¾è®¿é—®å­—å…¸**ä¸­ä¸å­˜åœ¨çš„é”®æ—¶ï¼Œæ–°æ‰‹å¼€å‘è€…ç»å¸¸ä¼šé‡åˆ°é—®é¢˜ã€‚

![](img/cb153bcda2b5febbac48b096185bcc3f.png)

å¤„ç†è¿™ç§æƒ…å†µçš„ä¸€ç§æ–¹æ³•æ˜¯æ£€æŸ¥å­—å…¸ä¸­æ˜¯å¦å­˜åœ¨è¯¥é”®ï¼Œä¸‹é¢çš„ä»£ç å¯ä»¥å¸®åŠ©æ‚¨:

å¦ä¸€ç§å®ç°æ–¹æ³•æ˜¯ä½¿ç”¨ try/except å—ï¼Œå¦‚ä¸‹æ‰€ç¤º:

ä¸Šé¢çš„ä»£ç ç¡®å®å®ç°äº†æˆ‘ä»¬çš„ç›®æ ‡ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨å­—å…¸æ–¹æ³•`get`æ¥è¿›ä¸€æ­¥æ”¹è¿›å®ƒã€‚

æ‚¨å¯ä»¥ä½¿ç”¨`get`æ–¹æ³•æ¥è·å–ç›¸åº”é”®çš„å€¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ–¹æ‹¬å·`[]`æ¥è®¿é—®å­—å…¸çš„é”®ã€‚

å¦å¤–ï¼Œå¦‚æœé”®ä¸å­˜åœ¨ï¼Œ`get`æ–¹æ³•è¿”å›`None`ï¼Œè¿™æ˜¯æœ‰åˆ©çš„ï¼Œè€Œä¸æ˜¯æŠ›å‡ºä¸€ä¸ª`KeyError`ã€‚å¦‚æœæ²¡æœ‰é”®è€Œæ²¡æœ‰`None`ï¼Œæ‚¨ä¹Ÿå¯ä»¥å‘`get`æ–¹æ³•ä¼ é€’ä¸€ä¸ªå‚æ•°æ¥è·å¾—ä¸€ä¸ªé»˜è®¤å€¼ã€‚

# 5.æƒ°æ€§å…³é”®å­—å’Œä½ç½®å‚æ•°è®¾è®¡

Python å‡½æ•°èƒ½å¤Ÿæ¥å—**ä½ç½®**å’Œ**å…³é”®å­—**å‚æ•°ã€‚

> ä½ç½®å‚æ•°æ˜¯åé¢æ²¡æœ‰ç­‰å·(=)å’Œé»˜è®¤å€¼çš„åç§°ã€‚
> 
> å…³é”®å­—å‚æ•°åè·Ÿä¸€ä¸ªç­‰å·å’Œä¸€ä¸ªç»™å‡ºå…¶é»˜è®¤å€¼çš„è¡¨è¾¾å¼ã€‚

ç”±äºè¿™ç§è®¾è®¡ï¼Œpython å‡½æ•°çš„åˆ›å»ºå’Œé‡ç”¨éå¸¸çµæ´»ã€‚

ç„¶è€Œï¼Œå®šä¹‰å‡½æ•°æ—¶ç³Ÿç³•çš„è®¾è®¡é€‰æ‹©ä¼šå¯¼è‡´ä»£ç ä¸­éš¾ä»¥ä¿®å¤çš„é”™è¯¯ã€‚

è®©æˆ‘ä»¬ä»¥è®¡ç®—[å¤åˆ©](https://www.investopedia.com/terms/c/compoundinterest.asp)çš„å‡½æ•°ä¸ºä¾‹:

è°ƒç”¨å‡½æ•°æ—¶å‡ºç°çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæœ«å°¾çš„ä¸¤ä¸ªå¸ƒå°”å‚æ•°`compounded_monthly`å’Œ`to_string`å¾ˆå®¹æ˜“æ··æ·†ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´éš¾ä»¥è·Ÿè¸ªçš„é—®é¢˜ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼æ›´æ”¹å‡½æ•°å®šä¹‰æ¥æé«˜å¯è¯»æ€§:

é€šè¿‡å°†ä¸¤ä¸ªå¸ƒå°”å‚æ•°æŒ‡å®šä¸ºå…³é”®å­—å‚æ•°ï¼Œå‡½æ•°è°ƒç”¨æ–¹å¯ä»¥æ˜¾å¼æŒ‡å®šä»–ä»¬æƒ³è¦è®¾ç½®çš„å¸ƒå°”å€¼ï¼Œè¿™äº›å€¼å°†è¦†ç›–é»˜è®¤å€¼ã€‚

ç„¶è€Œï¼Œè¿™ä»ç„¶ä¼šå¯¼è‡´é—®é¢˜çš„ä¸»è¦åŸå› æ˜¯å…³é”®å­—å‚æ•°æ˜¯å¯é€‰çš„ï¼Œå› æ­¤ï¼Œæ²¡æœ‰ä»€ä¹ˆä¼šå¼ºåˆ¶è°ƒç”¨è€…ä½¿ç”¨å®ƒä»¬ä½œä¸ºå…³é”®å­—å‚æ•°ã€‚

å› æ­¤ï¼Œä»ç„¶å¯ä»¥ä½¿ç”¨æ—§æ–¹æ³•è°ƒç”¨è¯¥å‡½æ•°:

`calculate_compound_interest(100, 5, 2, False, False)`

è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³•æ˜¯ä»…åœ¨å®šä¹‰å‡½æ•°æ—¶å°†å¸ƒå°”å‚æ•°å¼ºåˆ¶ä¸ºå…³é”®å­—:

æˆ‘ä»¬çœ‹åˆ°,`*`ç¬¦å·è¡¨ç¤ºä½ç½®å‚æ•°çš„ç»“æŸå’Œåªæœ‰å…³é”®å­—çš„å‚æ•°çš„å¼€å§‹ã€‚

ç°åœ¨è¿™æ ·ç§°å‘¼å®ƒ:

`calculate_compound_interest(100, 5, 2, False, False)`

å°†å¯¼è‡´ä¸€ä¸ªé”™è¯¯:

```
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-32-faf75d2ad121> in <module>
----> 1 print(calculate_compound_interest(1000, 5, 2, False, False))TypeError: calculate_compound_interest() takes 3 positional arguments but 5 were given
```

ä½†æ˜¯ï¼Œå…³é”®å­—å‚æ•°åŠå…¶é»˜è®¤è¡Œä¸ºä»å°†ä¿æŒä¸å˜ï¼Œå¦‚ä¸‹æ‰€ç¤º:

ç„¶è€Œï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ã€‚

å‡è®¾è°ƒç”¨è€…å†³å®šå¯¹å‰ä¸‰ä¸ªå¿…éœ€çš„å‚æ•°(`principal`ã€ `rate`ã€ `time_in_years`)æ··åˆä½¿ç”¨ä½ç½®å’Œå…³é”®å­—ã€‚

å¦‚æœè¿™ä¸‰ä¸ªå‚æ•°çš„å‡½æ•°å‚æ•°åç§°è¢«æ›´æ”¹ï¼Œæˆ‘ä»¬å°†çœ‹åˆ° Python è§£é‡Šå™¨æŠ¥é”™ã€‚å®ƒä¼šæ˜¾ç¤ºå¦‚ä¸‹å†…å®¹:

```
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-36-42e7ec842cd5> in <module>
----> 1 calculate_compound_interest(principal=1000, rate=5, time_in_years=2)TypeError: calculate_compound_interest() got an unexpected keyword argument 'principal'---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-37-1bc57c40980f> in <module>
----> 1 calculate_compound_interest(1000, 5, time_in_years=2)TypeError: calculate_compound_interest() got an unexpected keyword argument 'time_in_years'
```

å› ä¸ºæˆ‘ä»¬æ²¡æœ‰è€ƒè™‘è°ƒç”¨è€…æ˜¾å¼ä½¿ç”¨ä½ç½®å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ä»£ç ä¼šä¸­æ–­ã€‚

Python 3.8 ä¸­å¼•å…¥äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`/`å‚æ•°é‡æ–°å®šä¹‰å‡½æ•°ï¼Œè¯¥å‚æ•°æŒ‡ç¤ºäº†ä½ç½®å”¯ä¸€å‚æ•°çš„ç»“æŸä½ç½®ã€‚ä»£ç å¦‚ä¸‹:

ç°åœ¨åƒè¿™æ ·è°ƒç”¨å‡½æ•°ä¼šäº§ç”Ÿæ­£ç¡®çš„ç»“æœ:

ä½†æ˜¯ï¼Œå¦‚æœè¿™æ ·å«:

```
calculate_compound_interest(p=1000, r=5, t_in_y=2)
```

ç„¶åæ˜¾ç¤ºç›¸åº”çš„é”™è¯¯:

```
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-21-883e876a7e8b> in <module>
----> 1 calculate_compound_interest(p=1000, r=5, t_in_y=2)
      2TypeError: calculate_compound_interest() got some positional-only arguments passed as keyword arguments: 'p, r, t_in_y'
```

æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ ä»¬æé«˜ç”¨ Python å¼€å‘çš„å·¥ç¨‹æŠ€èƒ½ï¼ğŸ˜ƒ

æˆ‘å°†åœ¨ä¸‹é¢åˆ—å‡ºä¸€äº›èµ„æºï¼Œæ‚¨å¯ä»¥åœ¨è¿™äº›èµ„æºä¸­æ‰¾åˆ°æ›´å¤šè¿™æ ·çš„åæ¨¡å¼ç¤ºä¾‹ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚

ä¸‹æ¬¡è§ï¼âœ‹

# èµ„æº:

[](https://effectivepython.com/) [## æœ‰æ•ˆçš„ Python ä¹¦ç±:ç¬¬äºŒç‰ˆ

### ã€Šæœ‰æ•ˆçš„ Python:ç¬¬äºŒç‰ˆã€‹ä¸­çš„æ¯ä¸€ç« éƒ½åŒ…å«äº†ä¸€ç³»åˆ—å¹¿æ³›ä½†ç›¸å…³çš„å†…å®¹ã€‚éšæ„åœ¨â€¦ä¹‹é—´è·³æ¥è·³å»

effectivepython.com](https://effectivepython.com/) [](https://www.oreilly.com/library/view/fluent-python/9781491946237/) [## æµç•…çš„ Python

### Python çš„ç®€å•æ€§è®©æ‚¨å¾ˆå¿«å˜å¾—é«˜æ•ˆï¼Œä½†è¿™é€šå¸¸æ„å‘³ç€æ‚¨æ²¡æœ‰ä½¿ç”¨å®ƒå¿…é¡»çš„ä¸€åˆ‡â€¦

www.oreilly.com](https://www.oreilly.com/library/view/fluent-python/9781491946237/) [](https://realpython.com/products/python-tricks-book/) [## Python æŠ€å·§:ä¹¦-çœŸæ­£çš„ Python

### æˆ‘çŸ¥é“æœ‰ä¸€ä¸ªå¾ˆæœ‰æ‰åçš„ Python web å¼€å‘äººå‘˜â€”â€”æˆ‘ç§°ä»–ä¸ºâ€œMarkâ€ã€‚é©¬å…‹æ˜¯ä¸€ä¸ªè‡ªå­¦æˆæ‰çš„ç¨‹åºå‘˜ï¼Œåˆå‡ºèŒ…åºâ€¦

realpython.com](https://realpython.com/products/python-tricks-book/)