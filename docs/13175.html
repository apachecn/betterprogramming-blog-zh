<html>
<head>
<title>Handling File Uploads With NestJS and MySQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨NestJSå’ŒMySQLå¤„ç†æ–‡ä»¶ä¸Šä¼ </h1>
<blockquote>åŸæ–‡ï¼š<a href="https://betterprogramming.pub/handling-file-uploads-with-nestjs-and-mysql-10c83c80ff96?source=collection_archive---------18-----------------------#2022-08-03">https://betterprogramming.pub/handling-file-uploads-with-nestjs-and-mysql-10c83c80ff96?source=collection_archive---------18-----------------------#2022-08-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2d8e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">ä½¿ç”¨TypeORMè¿æ¥åˆ°MySQLæ•°æ®åº“ï¼Œåˆ›å»ºä¸€ä¸ªå®ä½“ï¼Œå¹¶å°†å›¾åƒä¸Šä¼ åˆ°Nestjsåº”ç”¨ç¨‹åºã€‚</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6d22fbebafc64e5e38458b7f8b5d6891.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*z8Dp-YJpG-HYOwuK.png"/></div></div></figure><h1 id="dfa1" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">ä»‹ç»</h1><p id="1a5c" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">è®¸å¤šå¼€å‘äººå‘˜é„™è§†å¤„ç†æ–‡ä»¶ä¸Šä¼ ã€‚è¿™å¯èƒ½æ˜¯ç”±äºç¼ºä¹å…³äºæœ€ä½³æ–¹æ³•çš„çŸ¥è¯†ï¼Œæˆ–è€…éš¾ä»¥ç¡®å®šå¦‚ä½•é…ç½®Nest.jsåº”ç”¨ç¨‹åºæ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ ã€‚è®¸å¤šäººå¯èƒ½å¸Œæœ›å°†ä»–ä»¬çš„æ–‡ä»¶ç›´æ¥ä¿å­˜åˆ°MySQLæ•°æ®åº“ï¼Œæˆ–è€…ä¿å­˜å›¾åƒåç§°å¹¶å°†å›¾åƒä¿å­˜åœ¨ç£ç›˜å­˜å‚¨ä¸Š:è¿™å®Œå…¨å–å†³äºä»–ä»¬çš„åå¥½å’Œä»–ä»¬æƒ³è¦å®ç°çš„ç›®æ ‡ã€‚æœ¬æ•™ç¨‹å°†æ•™ä½ å¦‚ä½•ä½¿ç”¨Nestjså’ŒMySQLå»ºç«‹ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ã€‚</p><h1 id="89d6" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">å…ˆå†³æ¡ä»¶</h1><p id="e029" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">åœ¨å¼€å§‹å­¦ä¹ æœ¬æ•™ç¨‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„ç³»ç»Ÿæ»¡è¶³ä»¥ä¸‹è¦æ±‚:</p><ul class=""><li id="d9ae" class="mi mj it lo b lp mk ls ml lv mm lz mn md mo mh mp mq mr ms bi translated">æ‚¨çš„ç³»ç»Ÿæ­£åœ¨è¿è¡Œç‰ˆæœ¬14æˆ–æ›´é«˜ç‰ˆæœ¬çš„<a class="ae mt" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>ã€‚</li><li id="05c3" class="mi mj it lo b lp mu ls mv lv mw lz mx md my mh mp mq mr ms bi translated">æ‚¨çš„ç³»ç»Ÿå®‰è£…äº†ä¸€ä¸ª<a class="ae mt" href="https://www.mysql.com/downloads/" rel="noopener ugc nofollow" target="_blank"> MySQLæ•°æ®åº“</a>ã€‚</li><li id="5134" class="mi mj it lo b lp mu ls mv lv mw lz mx md my mh mp mq mr ms bi translated">æ‚¨å·²ç»å®‰è£…äº†<a class="ae mt" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank">é‚®é€’å‘˜</a>ã€‚</li></ul><h1 id="6aa9" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">è®¾ç½®NestJS</h1><p id="c8d3" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">æ»¡è¶³ä¸Šè¿°è¦æ±‚åï¼Œç»§ç»­å®‰è£…Nestjs CLIï¼Œå¹¶é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="46a5" class="ne kv it na b gy nf ng l nh ni">$ npm i -g @nestjs/cli<br/>$ nest new file-upload</span></pre><p id="008c" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">è¿™äº›å‘½ä»¤å°†å®‰è£…Nestjs CLIï¼Œå¹¶ä½¿ç”¨ä¸‹é¢çš„æ–‡ä»¶å¤¹ç»“æ„åˆ›å»ºä¸€ä¸ªæ–°çš„Nestjsé¡¹ç›®ã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="9185" class="ne kv it na b gy nf ng l nh ni">ğŸ“¦file-upload<br/>â”£ ğŸ“‚src<br/>â”ƒ â”£ ğŸ“œapp.controller.spec.ts<br/>â”ƒ â”£ ğŸ“œapp.controller.ts<br/>â”ƒ â”£ ğŸ“œapp.module.ts<br/>â”ƒ â”£ ğŸ“œapp.service.ts<br/>â”ƒ â”£ ğŸ“œimage.entity.ts<br/>â”ƒ â”— ğŸ“œmain.ts<br/>â”£ ğŸ“‚test<br/>â”ƒ â”£ ğŸ“œapp.e2e-spec.ts<br/>â”ƒ â”— ğŸ“œjest-e2e.json<br/>â”£ ğŸ“œ.eslintrc.js<br/>â”£ ğŸ“œ.gitignore<br/>â”£ ğŸ“œ.prettierrc<br/>â”£ ğŸ“œREADME.md<br/>â”£ ğŸ“œnest-cli.json<br/>â”£ ğŸ“œpackage-lock.json<br/>â”£ ğŸ“œpackage.json<br/>â”£ ğŸ“œtsconfig.build.json<br/>â”— ğŸ“œtsconfig.json</span></pre><p id="8ee5" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">åˆ›å»ºNestjsé¡¹ç›®åï¼Œç»§ç»­ä¸‹ä¸€æ­¥â€”â€”é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…åº”ç”¨ç¨‹åºæ‰€éœ€çš„ä¾èµ–é¡¹:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="de5d" class="ne kv it na b gy nf ng l nh ni">npm install --save @nestjs/typeorm typeorm mysql2</span></pre><p id="26e9" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">åœ¨ä¸Šé¢çš„å‘½ä»¤ä¸­ï¼Œæ‚¨å·²ç»å®‰è£…äº†<a class="ae mt" href="https://typeorm.io/" rel="noopener ugc nofollow" target="_blank"> TypeORM </a>å’Œ<a class="ae mt" href="https://github.com/brianmario/mysql2" rel="noopener ugc nofollow" target="_blank"> mysql2 </a>æ¨¡å—:å®ƒä»¬å°†ä½¿æ‚¨èƒ½å¤Ÿå°†åº”ç”¨ç¨‹åºè¿æ¥åˆ°mysqlæ•°æ®åº“å¹¶å¯¹å…¶æ‰§è¡Œæ“ä½œã€‚</p><h1 id="d16a" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">è®¾ç½®MySQLæ•°æ®åº“</h1><p id="9205" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">å®‰è£…äº†ä¸Šè¿°ä¾èµ–é¡¹åï¼Œç»§ç»­è®¾ç½®å¹¶è¿æ¥åˆ°MySQLæ•°æ®åº“ã€‚é¦–å…ˆï¼Œç”¨ä¸‹é¢çš„ä»£ç ç‰‡æ®µå°†ä»£ç æ·»åŠ åˆ°<code class="fe nm nn no na b">app.module.ts</code>æ–‡ä»¶ä¸­ã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="a57e" class="ne kv it na b gy nf ng l nh ni">...<br/>import { TypeOrmModule } from '@nestjs/typeorm';<br/>import { Image } from './image.entity';<br/><br/>@Module({<br/>  imports: [TypeOrmModule.forRoot({<br/>    type: 'mysql',<br/>    host: 'localhost',<br/>    port: 3306,<br/>    username: 'root',<br/>    password: '1234',<br/>    database: 'blog',<br/>    entities: [Image],<br/>    synchronize: true,<br/>  }),<br/>  TypeOrmModule.forFeature([Image])<br/>  ],<br/>  ...<br/>})<br/>...</span></pre><p id="3b11" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬ä»ä¹‹å‰å®‰è£…çš„typeormæ¨¡å—ä¸­å¯¼å…¥äº†<code class="fe nm nn no na b">TypeOrmModule</code>ã€‚æˆ‘ä»¬ä½¿ç”¨<code class="fe nm nn no na b">forRoot</code>æ–¹æ³•å°†åº”ç”¨ç¨‹åºè¿æ¥åˆ°MySQLæ•°æ®åº“ï¼Œå¹¶ä¼ é€’æ•°æ®åº“å‡­è¯ã€‚è¿™é‡Œè¦æŒ‡å‡ºçš„å¦ä¸€ä»¶äº‹æ˜¯<code class="fe nm nn no na b">entities</code>å±æ€§ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨æ¨¡å—ä¸­æŒ‡å®šå®ä½“ï¼Œå¹¶è®©æˆ‘ä»¬è®¿é—®æ‚¨å°†å¾ˆå¿«åˆ›å»ºçš„<code class="fe nm nn no na b">Image</code>å®ä½“:æˆ‘ä»¬è¿˜å°†<code class="fe nm nn no na b">synchronize</code>å±æ€§è®¾ç½®ä¸º<code class="fe nm nn no na b">true</code>æ¥è‡ªåŠ¨è¿ç§»æ•°æ®åº“ã€‚</p><h1 id="5472" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">åˆ›å»ºå›¾åƒå®ä½“</h1><p id="1ed0" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬å‰é¢æåˆ°çš„å›¾åƒå®ä½“ã€‚é¦–å…ˆï¼Œåœ¨srcç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªimage.entity.tsæ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä¸‹é¢çš„ä»£ç ç‰‡æ®µã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="3666" class="ne kv it na b gy nf ng l nh ni">import { Entity, Column, PrimaryGeneratedColumn, CreateDateColumn, UpdateDateColumn } from 'typeorm';<br/><br/>@Entity()<br/>export class Image {<br/>    @PrimaryGeneratedColumn()<br/>    id: number;<br/><br/>    @Column()<br/>    name: string;<br/><br/>    @CreateDateColumn()<br/>    dateCreated: Date;<br/><br/>    @UpdateDateColumn()<br/>    dateUpdated: Date;<br/>}</span></pre><p id="051d" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬å¯¼å…¥äº†åˆ›å»ºå®ä½“æ‰€éœ€çš„è£…é¥°å™¨ã€‚ä½¿ç”¨è¿™äº›è£…é¥°å™¨ï¼Œæˆ‘ä»¬å®šä¹‰äº†å®ä½“çš„å±æ€§ã€‚æˆ‘ä»¬æœ‰ä½¿ç”¨<code class="fe nm nn no na b">@PrimaryGeneratedColumn()</code>è£…é¥°å™¨ä¸ºæ•°æ®åº“ä¸­çš„æ¯æ¡è®°å½•ç”Ÿæˆéšæœºidçš„<code class="fe nm nn no na b">id</code>å­—æ®µï¼Œå­˜å‚¨å°†ä½¿ç”¨<code class="fe nm nn no na b">@Column</code>è£…é¥°å™¨ä¸Šä¼ çš„å›¾åƒåç§°çš„<code class="fe nm nn no na b">name</code>å­—æ®µï¼Œä¿å­˜ä½¿ç”¨<code class="fe nm nn no na b">@CreateDateColumn()</code>å’Œ<code class="fe nm nn no na b">@UpdateDateColumn()</code>åˆ›å»ºå’Œæ›´æ–°è®°å½•çš„æ—¥æœŸçš„dateCreatedå’ŒdateUpdateå­—æ®µã€‚</p><h1 id="6130" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">åˆ›å»ºä¸Šä¼ æœåŠ¡</h1><p id="3a37" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">åˆ›å»ºå›¾åƒå®ä½“åï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæœåŠ¡æ¥æ‰§è¡ŒCRUDæ“ä½œï¼Œä»¥å¤„ç†æ–‡ä»¶ä¸Šä¼ ã€‚åœ¨<code class="fe nm nn no na b">app.service.ts</code>æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä¸‹é¢çš„ä»£ç ç‰‡æ®µã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="2ccf" class="ne kv it na b gy nf ng l nh ni">import { Injectable } from '@nestjs/common';<br/>import { InjectRepository } from '@nestjs/typeorm';<br/>import { Repository } from 'typeorm';<br/>import { Image } from './image.entity';<br/><br/>@Injectable()<br/>export class AppService {<br/>  constructor(<br/>    @InjectRepository(Image)<br/>    private readonly imageRepository: Repository&lt;Image&gt;,<br/>  ) {}<br/><br/>  async getImages(): Promise&lt;Image[]&gt; {<br/>    return this.imageRepository.find();<br/>  }<br/><br/>  async createImage(image: Image): Promise&lt;Image&gt; {<br/>    return this.imageRepository.save(image);<br/>  }<br/><br/>  async getImage(id: number): Promise&lt;Image&gt; {<br/>    return this.imageRepository.findOneBy({ id });<br/>  }<br/><br/>  async deleteImage(id: number): Promise&lt;void&gt; {<br/>    await this.imageRepository.delete(id);<br/>  }<br/>}</span></pre><p id="9263" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬å¯¼å…¥äº†<code class="fe nm nn no na b">injectRepository</code>è£…é¥°å™¨ï¼Œå°†<code class="fe nm nn no na b">imageRepository</code>æ³¨å…¥åˆ°<code class="fe nm nn no na b">AppService</code>å’Œ<code class="fe nm nn no na b">Repository</code>ä¸­ï¼Œè¿™ä¸ºæ‚¨æä¾›äº†åœ¨æ•°æ®åº“ä¸Šæ‰§è¡ŒæŸäº›æ“ä½œæ‰€éœ€çš„æ–¹æ³•ã€‚å› æ­¤ï¼Œå¯¹äº<code class="fe nm nn no na b">createImage</code>å›¾åƒæœåŠ¡ï¼Œæˆ‘ä»¬ä¿å­˜ä¸Šä¼ çš„å›¾åƒåç§°ï¼Œè¯¥åç§°å°†é€šè¿‡æ§åˆ¶å™¨ä¼ é€’ã€‚</p><h1 id="b7f6" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">åˆ›å»ºä¸Šä¼ æ§åˆ¶å™¨</h1><p id="6b9b" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºæ§åˆ¶å™¨æ¥ä½¿ç”¨æœåŠ¡ã€‚å¹¶æ·»åŠ ä¸‹é¢çš„ä»£ç ç‰‡æ®µã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="0ff6" class="ne kv it na b gy nf ng l nh ni">import { Injectable } from '@nestjs/common';<br/>import { InjectRepository } from '@nestjs/typeorm';<br/>import { Repository } from 'typeorm';<br/>import { Image } from './image.entity';<br/><br/>@Injectable()<br/>export class AppService {<br/>  constructor(<br/>    @InjectRepository(Image)<br/>    private readonly imageRepository: Repository&lt;Image&gt;,<br/>  ) {}<br/><br/>  async getImages(): Promise&lt;Image[]&gt; {<br/>    return this.imageRepository.find();<br/>  }<br/><br/>  async createImage(image: Image): Promise&lt;Image&gt; {<br/>    return this.imageRepository.save(image);<br/>  }<br/><br/>  async getImage(id: number): Promise&lt;Image&gt; {<br/>    return this.imageRepository.findOneBy({ id });<br/>  }<br/><br/>  async deleteImage(id: number): Promise&lt;void&gt; {<br/>    await this.imageRepository.delete(id);<br/>  }<br/>}</span></pre><p id="0856" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬å¯¼å…¥äº†å‡ ä¸ªè£…é¥°å™¨ï¼Œå¦‚<code class="fe nm nn no na b">FileInterceptor</code>ã€<code class="fe nm nn no na b">UploadedFile</code>å’Œ<code class="fe nm nn no na b">UseInterceptors</code>ã€‚è·¯ç”±å¤„ç†å™¨çš„<code class="fe nm nn no na b">FileInterceptor()</code>æ‹¦æˆªå™¨ä½¿ç”¨<code class="fe nm nn no na b">@UploadedFile()</code>è£…é¥°å™¨ä»è¯·æ±‚ä¸­æå–æ–‡ä»¶ã€‚<code class="fe nm nn no na b">FileInterceptor()</code>è£…é¥°å™¨ä»<code class="fe nm nn no na b">@nestjs/platform-express</code>åŒ…ä¸­å¯¼å‡ºã€‚<code class="fe nm nn no na b">@UploadedFile()</code>è£…é¥°å™¨æ˜¯ä»<code class="fe nm nn no na b">@nestjs/common</code>å¯¼å‡ºçš„ã€‚<code class="fe nm nn no na b">FileInterceptor()</code> decoratoræœ‰ä¸¤ä¸ªå‚æ•°ï¼Œ<code class="fe nm nn no na b">fieldName</code>æ˜¯æä¾›ä¿å­˜æ–‡ä»¶çš„HTMLè¡¨å•ä¸­çš„å­—æ®µåç§°çš„å­—ç¬¦ä¸²ï¼Œ<code class="fe nm nn no na b">options</code>æ˜¯MulterOptionsç±»å‹çš„å¯é€‰å¯¹è±¡ã€‚è¿™æ˜¯multeræ„é€ å‡½æ•°ä½¿ç”¨çš„åŒä¸€ä¸ªå¯¹è±¡ã€‚</p><p id="99fc" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">å…³äº<code class="fe nm nn no na b">createImage</code>å‡½æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨å‰é¢æåˆ°çš„decoratorsæ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ ï¼Œä½¿ç”¨<code class="fe nm nn no na b">FileInterceptor()</code>ä¼ é€’å›¾åƒçš„å­—æ®µåï¼Œå¹¶ä¸”æˆ‘ä»¬ä¿®æ”¹äº†<code class="fe nm nn no na b">FileInterceptor()</code>å‡½æ•°ï¼Œé€šè¿‡ä½¿ç”¨<code class="fe nm nn no na b">multer</code>ä¸­å¯ç”¨çš„<code class="fe nm nn no na b">diskStorage</code>å‡½æ•°æŒ‡å®š<code class="fe nm nn no na b">storage</code>å±æ€§æ¥å°†å›¾åƒä¸Šä¼ åˆ°ç£ç›˜ã€‚ç„¶åï¼Œæˆ‘ä»¬æŒ‡å®šå›¾åƒçš„ä½ç½®ï¼Œå¹¶ä¸ºå›¾åƒç”Ÿæˆéšæœºåç§°ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ª<code class="fe nm nn no na b">filter</code>å±æ€§æ¥é™åˆ¶æŸäº›å›¾åƒæ ¼å¼çš„ä¸Šä¼ ã€‚ç°åœ¨æˆ‘ä»¬ä½¿ç”¨<code class="fe nm nn no na b">@UploadedFile()</code> decoratoræå–æ–‡ä»¶ï¼Œè·å–æ–‡ä»¶åå¹¶ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¯ä¸ªå›¾åƒçš„åç§°ä»å­˜å‚¨ä½ç½®è·å–å›¾åƒã€‚</p><p id="b79b" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">è¦ä½¿ä¸Šè¿°ä»£ç è¿è¡Œï¼Œæ‚¨éœ€è¦åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…multer:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="f264" class="ne kv it na b gy nf ng l nh ni">npm i -D @types/multer</span></pre><p id="4d87" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">ç„¶åï¼Œæ‚¨éœ€è¦åœ¨<code class="fe nm nn no na b">app.module.ts</code>æ–‡ä»¶çš„å¯¼å…¥æ•°ç»„ä¸­æ³¨å†Œmulteræ¨¡å—:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="b332" class="ne kv it na b gy nf ng l nh ni">...<br/>import { MulterModule } from '@nestjs/platform-express';<br/><br/><br/>@Module({<br/>  ...<br/>  MulterModule.register({<br/>    dest: './files',<br/>  }),],<br/>  ...</span></pre><p id="6aee" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">ä¸Šé¢çš„é…ç½®å‘Šè¯‰multerå¤„ç†æ–‡ä»¶ä¸Šä¼ å’Œæ–‡ä»¶ä¸Šä¼ åˆ°çš„ä½ç½®ã€‚æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨<code class="fe nm nn no na b">src</code>ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª<code class="fe nm nn no na b">files</code>æ–‡ä»¶å¤¹æ¥å®é™…å­˜å‚¨æ–‡ä»¶ã€‚</p><h1 id="1563" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">æä¾›æ–‡ä»¶</h1><p id="bbe7" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">è¦å°†ä¸Šä¼ åˆ°æ‚¨åº”ç”¨ç¨‹åºä¸Šçš„å›¾åƒå®é™…æä¾›ç»™ç”¨æˆ·ï¼Œæ‚¨éœ€è¦é€šè¿‡è¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å®‰è£…<code class="fe nm nn no na b">serve-static</code>æ¨¡å—ã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="a4f5" class="ne kv it na b gy nf ng l nh ni">npm install --save @nestjs/serve-static</span></pre><p id="6c0e" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">ç„¶åï¼Œç”¨ä¸‹é¢çš„ä»£ç ç‰‡æ®µå°†<code class="fe nm nn no na b">ServeStaticModule</code>æ³¨å†Œåˆ°<code class="fe nm nn no na b">app.module.ts</code>æ–‡ä»¶çš„å¯¼å…¥æ•°ç»„ä¸­ã€‚</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="ad17" class="ne kv it na b gy nf ng l nh ni">...<br/>import { ServeStaticModule } from '@nestjs/serve-static';<br/>import { join } from 'path';<br/><br/>@Module({<br/>  ...<br/>  ServeStaticModule.forRoot({<br/>    rootPath: join(__dirname, '..', 'files')<br/>  }),],<br/>  ...</span></pre><p id="e28b" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæ‚¨å·²ç»æŒ‡å®šäº†æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®ï¼Œå¹¶ä¸”å¯ä»¥ä»è¯¥ä½ç½®æä¾›æœåŠ¡ã€‚</p><h1 id="6eed" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">æµ‹è¯•API</h1><p id="84ac" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">ç°åœ¨æ‰“å¼€Postmanï¼Œé€šè¿‡å‘ç«¯ç‚¹<code class="fe nm nn no na b">localhost:4000/images</code>å‘é€POSTè¯·æ±‚æ¥æµ‹è¯•åº”ç”¨ç¨‹åºï¼Œå¹¶å°†è¯·æ±‚ä½“ä¸­çš„æœ‰æ•ˆè´Ÿè½½ä½œä¸ºè¡¨å•æ•°æ®ä¼ å…¥ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/49a8f2c1d722ae5e5ccc7b086c021d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1tqceREo1M_ZrtTt.png"/></div></div></figure><p id="ebb6" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">å¦‚æœæ‚¨ç°åœ¨æŸ¥çœ‹filesæ–‡ä»¶å¤¹ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°æ‚¨ä¸Šä¼ çš„æ–‡ä»¶ã€‚è¯·éšæ„ç»§ç»­:æµ‹è¯•å¹¶å°è¯•å…¶ä»–è·¯çº¿ã€‚</p><h1 id="c16e" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">ç»“è®º</h1><p id="f635" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">é€šè¿‡æœ¬æ•™ç¨‹ï¼Œæ‚¨å·²ç»å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨NestJSå’ŒMySQLå¤„ç†æ–‡ä»¶ä¸Šä¼ ã€‚æ‚¨å·²ç»å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨TypeORMè¿æ¥åˆ°MySQLæ•°æ®åº“ï¼Œè¿˜åˆ›å»ºäº†ä¸€ä¸ªå®ä½“å¹¶å°†å›¾åƒä¸Šä¼ åˆ°Nestjsåº”ç”¨ç¨‹åºã€‚</p><p id="0ea2" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">ä½ å·²ç»æˆåŠŸåœ°ç”¨NestJSå’ŒMySQLæ„å»ºäº†ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç‰¹æ€§:ä½†æ˜¯ï¼Œå¯¹äºä½ çš„æ•°æ®åº“å’Œåº”ç”¨ç¨‹åºçš„æœªæ¥ï¼Œè¯·è®°ä½ï¼ŒæŒç»­å…³æ³¨ä½ çš„åº”ç”¨ç¨‹åºå’Œæ•°æ®åº“ä¸ä»…ä»…æ˜¯ä¸ºå®ƒä»¬æ„å»ºç‰¹æ€§:<a class="ae mt" href="https://arctype.com" rel="noopener ugc nofollow" target="_blank">åƒArctype </a>è¿™æ ·çš„SQLå®¢æˆ·ç«¯å°†å…è®¸ä½ ç¼–å†™SQLæŸ¥è¯¢å¹¶ä¼˜åŒ–å®ƒä»¬ï¼Œä»¥åŠå¯è§†åŒ–æ•°æ®åº“ä¸­å½“å‰å­˜åœ¨çš„æ•°æ®ï¼Œ å¹¶ä¸”<a class="ae mt" href="https://arctype.com/blog" rel="noopener ugc nofollow" target="_blank">Arctypeåšå®¢ä¸Šçš„å†…å®¹</a>å°†è®©æ‚¨è½»æ¾åœ°å­¦ä¹ å¦‚ä½•<a class="ae mt" href="https://arctype.com/blog/mysql-storage-engine-big-data/" rel="noopener ugc nofollow" target="_blank">ä¼˜åŒ–æ‰€æœ‰MySQLå®ä¾‹çš„å®‰å…¨æ€§ã€å¯ç”¨æ€§å’Œæ€§èƒ½</a>ï¼Œå¹¶ä¸ºæ‚¨æä¾›å…³äºæ•´ä¸ªæ•°æ®åº“ä¸–ç•Œçš„è®¸å¤šè§è§£ã€‚</p><p id="8b1f" class="pw-post-body-paragraph lm ln it lo b lp mk ju lr ls ml jx lu lv nj lx ly lz nk mb mc md nl mf mg mh im bi translated">å¦‚éœ€è¿›ä¸€æ­¥é˜…è¯»ï¼Œè¿˜å¯ä»¥åœ¨<a class="ae mt" href="https://docs.nestjs.com/techniques/file-upload" rel="noopener ugc nofollow" target="_blank"> Nestjs </a>ä¸­é˜…è¯»æ›´å¤šå…³äºä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ã€‚å¯¹äºé¢å¤–çš„æŒ‘æˆ˜ï¼Œå°è¯•é€šè¿‡ä¿æŠ¤åˆ é™¤å’Œæ›´æ–°è·¯ç”±æ¥æ‰©å±•åº”ç”¨ç¨‹åºã€‚ä½ ä¸‹ä¸€æ­¥ä¼šå»ºä»€ä¹ˆï¼Ÿ</p></div></div>    
</body>
</html>