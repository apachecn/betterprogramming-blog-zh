# Angular ä¸­ä½•æ—¶ä½¿ç”¨ RxJS Subjectã€BehaviourSubjectã€ReplaySubjectã€AsyncSubject æˆ– Void Subject

> åŸæ–‡ï¼š<https://betterprogramming.pub/when-to-use-rxjs-subject-behavioursubject-replaysubject-asyncsubject-or-void-subject-in-angular-c2e9db61b4a0>

## åŠ›é‡åœ¨äºç»†èŠ‚

![](img/8ca9b7e54bb18006dfb94c335b28083d.png)

ç…§ç‰‡ç”±[èä¼¦Â·éº¦å¡ç´](https://unsplash.com/@sharonmccutcheon?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) æ‹æ‘„

Angular æœ‰è®¸å¤šä½ å¯ä»¥ä½¿ç”¨çš„è§‚å¯Ÿç±»å‹ã€‚ä¹Ÿè®¸ä½ åœ¨è§’å½¢ä¾‹å­ä¸­çœ‹åˆ°è¿‡ä¸»è¯­ã€`BehaviourSubject`ã€`ReplaySubject`æˆ–`AsyncSubject`ï¼Œæƒ³çŸ¥é“å®ƒä»¬æ˜¯ä»€ä¹ˆï¼Œä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨å®ƒä»¬ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æƒ³æ·±å…¥æ¢è®¨è¿™äº›ç±»å‹çš„ä¸»é¢˜æ˜¯ä»€ä¹ˆï¼Œä»¥åŠä½•æ—¶åº”è¯¥ä½¿ç”¨å®ƒä»¬ã€‚æ‰€ä»¥ç³»å¥½å®‰å…¨å¸¦ï¼Œäº«å—æ—…ç¨‹ã€‚

# ä»€ä¹ˆæ˜¯ä¸»é¢˜ï¼Ÿ

RxJS è´Ÿè´£ä»¥è§’åº¦è¡¨ç¤ºçš„ååº”æ€§ã€‚ä¸»é¢˜æ˜¯ RxJS åº“ä¸­ä¸€ç§ç‰¹æ®Šç±»å‹çš„å¯è§‚å¯Ÿå¯¹è±¡ã€‚

å¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯å¯è§‚æµ‹é‡ï¼Œå¯ä»¥æŸ¥çœ‹ LogRocket åšå®¢ä¸Šçš„â€œ[äº†è§£ RxJS å¯è§‚æµ‹é‡ä»¥åŠä½ ä¸ºä»€ä¹ˆéœ€è¦å®ƒä»¬](https://blog.logrocket.com/understanding-rxjs-observables/)â€è¿™ç¯‡æ–‡ç« ã€‚

## å•æ’­

![](img/c23dde29d5d541b2e6cd67031a10a887.png)

å›¾ç‰‡ç”± [DevByRayRay](http://blog.byrayray.dev) æä¾›

å¯è§‚å¯Ÿçš„æ˜¯å•æ’­ã€‚è§‚å¯Ÿè€…å’Œå®ƒçš„è®¢é˜…è€…æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ã€‚æ¯ä¸ªè®¢é˜…çš„è§‚å¯Ÿè€…æ‹¥æœ‰å¯è§‚å¯Ÿå¯¹è±¡çš„ç‹¬ç«‹æ‰§è¡Œã€‚

## å¤šç‚¹ä¼ é€

![](img/88aee64bf3d5971e0dd5668b48e2403d.png)

ä¸å¸¸è§„çš„å¯è§‚å¯Ÿå¯¹è±¡ç›¸æ¯”ï¼Œä¸»é¢˜å…è®¸å°†å€¼å¤šæ’­ç»™è®¸å¤šè§‚å¯Ÿè€…ã€‚ä¸»é¢˜å’Œå®ƒçš„è®¢é˜…è€…æœ‰ä¸€å¯¹å¤šçš„å…³ç³»ã€‚

ä¸»ä½“æ—¢å¯ä»¥æ˜¯è§‚å¯Ÿè€…ï¼Œä¹Ÿå¯ä»¥æ˜¯è¢«è§‚å¯Ÿè€…ã€‚å®ƒä»¬æ‹¥æœ‰å¤šä¸ªå¯è§‚å¯Ÿå¯¹è±¡çš„è®¸å¤šä¾¦å¬å™¨çš„æ³¨å†Œè¡¨ã€‚

# ä»£ç ä¸­çš„å¯è§‚å¯Ÿå¯¹è±¡ä¸ä¸»ä½“

å¯è§‚å¯Ÿå¯¹è±¡å’Œä¸»ä½“å…±äº«å®ƒä»¬çš„ APIã€‚å®ƒä»¬éƒ½æœ‰ç›¸åŒçš„æ–¹æ³•ï¼Œä»¥åŠä½ å¦‚ä½•åˆ›å»ºå®ƒä»¬ã€‚ä½†æ˜¯ä»–ä»¬çš„è¡Œä¸ºå½¼æ­¤éå¸¸ä¸åŒã€‚

## **å¯åœ¨ä»£ç **ä¸­è§‚å¯Ÿåˆ°

åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ•°æ®è¢«å‘é€åˆ°ç¬¬ä¸€ä¸ªè®¢æˆ·ï¼Œå¹¶å°†åœ¨ç»§ç»­å‘é€åˆ°ä¸‹ä¸€ä¸ªè®¢æˆ·ä¹‹å‰å®Œæˆã€‚

åœ¨ [RxJS æ–‡æ¡£](https://rxjs.dev/guide/observable#subscribing-to-observables)ä¸­ï¼Œä»–ä»¬æè¿°äº†â€œå¯¹`observable.subscribe`çš„æ¯ä¸ªè°ƒç”¨éƒ½ä¼šè§¦å‘å…¶é’ˆå¯¹ç»™å®šè®¢æˆ·çš„ç‹¬ç«‹è®¾ç½®ã€‚â€

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ¯ä¸ªç”¨æˆ·éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹è¿è¡Œçš„ã€‚ä½†æ˜¯ RxJS å›¢é˜Ÿæä¾›äº†ä¸€ç§åˆ›å»ºâ€œ[å¤šæ’­å¯è§‚å¯Ÿå¯¹è±¡](https://rxjs.dev/guide/subject#multicasted-observables)â€çš„æ–¹æ³•

## ä»£ç ä¸­çš„ä¸»é¢˜

æœ‰äº†ä¸»è¯­ï¼Œå¯ä»¥çœ‹åˆ°ä¸»è¯­å¸¦å¤´ã€‚å®ƒå‘ä¸¤ä¸ªè®¢æˆ·å‘é€æ¶ˆæ¯ï¼Œè€Œä¸æ˜¯ç­‰å¾…ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™æ¸…æ¥šåœ°è¡¨æ˜äº†ä¸€ä¸ªå¸¸è§„çš„å¯è§‚å¯Ÿå¯¹è±¡å’Œä¸€ä¸ªä¸»ä½“ä¹‹é—´çš„åŒºåˆ«ã€‚

RxJS æ–‡æ¡£å¯¹è®¢é˜…ä¸»é¢˜åšäº†å¦‚ä¸‹è¯´æ˜:

> åœ¨ä¸»é¢˜å†…éƒ¨ï¼Œsubscribe ä¸è°ƒç”¨ä¼ é€’å€¼çš„æ–°æ‰§è¡Œã€‚å®ƒåªæ˜¯åœ¨è§‚å¯Ÿå™¨åˆ—è¡¨ä¸­æ³¨å†Œç»™å®šçš„è§‚å¯Ÿå™¨ï¼Œç±»ä¼¼äº addListener åœ¨å…¶ä»–åº“å’Œè¯­è¨€ä¸­çš„å·¥ä½œæ–¹å¼ã€‚

# ç§‘ç›®

æˆ‘ä»¬çŸ¥é“ä¸€ä¸ª`Subject`æ˜¯ä¸€ä¸ª`Observable`ã€‚ä½†æ˜¯å®ƒä»¬å¯ä»¥åŒæ—¶å‘å¤šä¸ªç”¨æˆ·å‘é€æ•°æ®ï¼Œè€Œä¸æ˜¯å‘ä¸€ä¸ªç”¨æˆ·å‘é€ä¿¡æ¯(å®ƒä»¬æ˜¯ç»„æ’­)ã€‚

ä¸€ä¸ª`Subject`æœ‰ä¸‰ç§æ–¹æ³•ä½ å¯ä»¥ä½¿ç”¨:

*   `subscribe`é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ‚¨å¯ä»¥æ¿€æ´»æ–°ç”¨æˆ·çš„å¥—é¤ã€‚
*   `next`ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥ä¼ é€’æ–°çš„å€¼ã€‚æ‰€æœ‰å½“å‰è®¢æˆ·éƒ½å°†æ”¶åˆ°æ­¤é‚®ä»¶ã€‚
*   `complete`ç”¨è¿™ç§æ–¹æ³•ï¼Œä½ å…³é—­äº†å¯¹è¯¥ä¸»é¢˜çš„æ‰€æœ‰è®¢é˜…ã€‚

ä¸€ä¸ªé‡è¦çš„ç»†èŠ‚æ˜¯ä¸»é¢˜æ²¡æœ‰åˆå§‹å€¼ã€‚ç”¨`next`æ–¹æ³•ä¼ é€’çš„æ¯ä¸ªå€¼éƒ½å°†å‘é€ç»™æ‰€æœ‰è®¢é˜…è€…ã€‚

ä½†æ˜¯ï¼Œå¦‚æœåœ¨è®¢é˜…è€…è®¢é˜…ä¹‹å‰å·²ç»å‘é€äº†è¯¥å€¼ï¼Œå®ƒå°†ä¸ä¼šæ¥æ”¶åˆ°è¯¥æ•°æ®(*å•å‡»â€œè¿è¡Œâ€æŒ‰é’®ä»¥æŸ¥çœ‹å…¶å·¥ä½œæƒ…å†µ*)ã€‚

# è¡Œä¸ºä¸»ä½“

`BehaviourSubject`æ˜¯`Subject`çš„å˜ä½“ã€‚è¿™ä¸ªå˜é‡çŸ¥é“å½“å‰å€¼ï¼Œè€Œæ™®é€šçš„`Subject`ä¸çŸ¥é“ã€‚

å½“å·²ç»æœ‰æ•°æ®å‘é€ç»™å½“å‰è®¢æˆ·æ—¶ï¼Œè¿™ä¸ªä¸»é¢˜å°±å˜å¾—éå¸¸æœ‰ç”¨ã€‚ä½†æ˜¯å¦ä¸€ä¸ªç”¨æˆ·åœ¨ç¨åè¢«ä»‹ç»ã€‚æœ‰æ—¶æ‚¨å¸Œæœ›å°†å½“å‰å€¼ä¼ é€’ç»™è¯¥è®¢æˆ·ã€‚ä½¿ç”¨`BehaviourSubject`æ‚¨å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹(*å•å‡»â€œè¿è¡Œâ€æŒ‰é’®æŸ¥çœ‹å…¶å·¥ä½œæƒ…å†µ*)ã€‚

å› æ­¤ï¼Œä½¿ç”¨`BehaviourSubject`å‘è®¢æˆ·æä¾›`Observable`çš„æœ€æ–°å·²çŸ¥å€¼ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³è¦æ¯”å‰ä¸€ä¸ªå€¼å¤šä¸€ç‚¹å‘¢ï¼Ÿ

# é‡æ’­ä¸»é¢˜

`ReplaySubject`æŒ‰å®ƒè¯´çš„åšã€‚å®ƒå¯ä»¥å‘æ–°è®¢æˆ·é‡æ”¾å›ºå®šæ•°é‡çš„å€¼ã€‚

æƒ³è±¡ä¸€ä¸ª DJ æ­£åœ¨æ’­æ”¾çš„åœ¨çº¿æ’­æ”¾åˆ—è¡¨ã€‚ä½†æ˜¯ä½ æƒ³å›åˆ°é‚£æ¡å°æºªé‡Œã€‚`ReplaySubject`å¯ä»¥ç¡®ä¿æ‚¨å¯ä»¥è¿˜åŸä¸‰é¦–æ›²ç›®ï¼Œå¹¶ä»é‚£é‡Œå¼€å§‹æ”¶å¬(*å•å‡»â€œè¿è¡Œâ€æŒ‰é’®ä»¥æŸ¥çœ‹å®ƒçš„å·¥ä½œæƒ…å†µ*)ã€‚

æ­£å¦‚æ‚¨åœ¨åˆ›å»º`ReplaySubject(2)`æ—¶çœ‹åˆ°çš„ï¼Œæˆ‘ä¼ é€’äº†æ•°å­— 2ï¼Œå®ƒå‘Šè¯‰`Subject`å®ƒéœ€è¦å°†æœ€åä¸¤ä¸ªå€¼å‘é€ç»™æ¯ä¸ªæ–°è®¢æˆ·ã€‚

å½“æ–°è®¢æˆ·æ¥æ”¶åˆ°ä¼ é€’çš„å€¼æ—¶ï¼Œå®ƒå°†ä¸å¦ä¸€ä¸ªè®¢æˆ·ä¿æŒåŒæ­¥ï¼Œè¿™éå¸¸å¥½ã€‚

ä½†æ˜¯ä¸ºäº†ç¡®ä¿`ReplaySubject(10000)`ä¸ä¼šå°†å¸¸é‡å€¼ä¼ é€’ç»™æ¯ä¸ªæ–°è®¢æˆ·ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å®ƒä¸€ä¸ªæ—¶é—´é™åˆ¶ã€‚ä¸‹é¢çš„ç¤ºä¾‹å®šä¹‰äº†å®ƒå¯ä»¥åœ¨å†…å­˜ä¸­ä¿å­˜ 100 ä¸ªå€¼ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™æ–°è®¢æˆ·ï¼Œä½†æ˜¯è¿™äº›å€¼çš„æœ‰æ•ˆæœŸä¸º 500 æ¯«ç§’ã€‚

```
const subject = new ReplaySubject(100, 500);
```

è¿™ä¸ªç‰¹æ€§æä¾›äº†å¾ˆå¤šå¯èƒ½æ€§ï¼Œæ‰€ä»¥è¦èªæ˜åœ°ä½¿ç”¨å®ƒã€‚

# async ä¸»è¯­

å½“æˆ‘çœ‹åˆ°`AsyncSubject`å¹¶çœ‹åˆ°å®ƒåªåœ¨å®Œæˆæ—¶å‘è®¢æˆ·å‘é€æœ€æ–°çš„å€¼æ—¶ï¼Œæˆ‘æƒ³ï¼Œâ€œä¸ºä»€ä¹ˆæˆ‘è¦ä½¿ç”¨å®ƒï¼Ÿâ€ã€‚ç›´åˆ°æˆ‘åœ¨ Medium ä¸Šçœ‹åˆ°[è¿™ä¸ªå¸–å­ã€‚](https://satyapriyamishra111.medium.com/all-you-need-to-know-about-async-subject-2cd72ea646ea)

æ‰€ä»¥è¿™ç»™äº†æˆ‘ä¸€ä¸ªæƒ³æ³•ï¼ŒT4 æ˜¯ Ajax è¯·æ±‚çš„ä¸€ä¸ªå¾ˆå¥½çš„å€™é€‰ã€‚å› ä¸ºå¯¹äºå¤§å¤šæ•° GET è¯·æ±‚ï¼Œä½ åªéœ€è¦ç­‰å¾…ä¸€ä¸ªå“åº”ã€‚

å½“æ‚¨å•å‡»ä¸Šé¢çš„â€œrunâ€æŒ‰é’®æ—¶ï¼Œæ‚¨ä¼šçœ‹åˆ°`AsyncSubject`å°†ä¼ é€’å¤šä¸ªå€¼ï¼Œä½†æ˜¯åªæœ‰åœ¨è°ƒç”¨`complete()`æ–¹æ³•ä¹‹å‰çš„æœ€åä¸€ä¸ªå€¼ä¼šæä¾›ç»™è®¢æˆ·ã€‚

# æ— æ•ˆä¸»é¢˜

åœ¨å¤§å¤šæ•°å¯¹è®¢é˜…è€…ä½¿ç”¨`Subject`çš„åœºæ™¯ä¸­ï¼Œè®¿é—®å·²ç»ä¼ é€’çš„å€¼æ˜¯å¾ˆé‡è¦çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä¸éœ€è¦å®é™…å€¼ï¼Œè€Œåªæƒ³æŒ‚é’©åˆ°äº‹ä»¶ä¸­ï¼Œå¹¶ä¸”ä¸éœ€è¦å€¼ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿé‚£å°±æ˜¯ä½ ä½¿ç”¨ç©ºä¸»è¯­çš„æ—¶å€™ã€‚

`Subject`çš„é»˜è®¤è¡Œä¸ºå°±æ˜¯è¿™æ ·(*ç‚¹å‡»â€œè¿è¡Œâ€æŒ‰é’®ï¼ŒæŸ¥çœ‹å®ƒçš„å·¥ä½œæƒ…å†µ*)ã€‚

# ç»“è®º

è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ï¼Œå½“ä½ éœ€è¦ä¸€ä¸ªæ™®é€šçš„`Observable`æˆ–è€…ä¸€ä¸ª`Subject`ç±»å‹çš„æ—¶å€™ã€‚

## å½“â€¦æ—¶ä½¿ç”¨å¯è§‚å¯Ÿå€¼

å½“æ‚¨åªéœ€è¦ä¸€ä¸ªè®¢æˆ·æ—¶ï¼Œåº”è¯¥ä½¿ç”¨å¸¸è§„çš„`Observable`ã€‚æˆ–è€…æ‚¨ä¸å…³å¿ƒé¦–å…ˆåˆ°è¾¾çš„è®¢æˆ·å°†é¦–å…ˆå®Œæˆï¼Œç›´åˆ°ç¬¬äºŒä¸ªè®¢æˆ·è·å¾—å…¶å€¼ã€‚

## å½“â€¦æ—¶ä½¿ç”¨ä¸»è¯­

å½“æ‚¨éœ€è¦å¤šä¸ªè®¢é˜…è€…å¹¶å…³å¿ƒæ‰€æœ‰è®¢é˜…è€…åŒæ—¶è·å¾—å®ƒä»¬çš„æ–°å€¼æ—¶ï¼Œæ‚¨éœ€è¦ä¸€ä¸ª`Subject`ã€‚

*   å½“éœ€è¦æœ€åä¸€ä¸ªç»™å®šå€¼æ—¶ï¼Œä½¿ç”¨`BehaviourSubject`ã€‚
*   å½“ä½ éœ€è¦è¶…è¿‡ä¸Šä¸€ä¸ªç»™å®šå€¼æ—¶ï¼Œä½¿ç”¨`ReplaySubject`(ä¾‹å¦‚ï¼Œå‰äº”ä¸ªå€¼)ã€‚æˆ–è€…æ‚¨å¸Œæœ›è®¾ç½®ä¸€ä¸ªæ—¶é—´çª—å£ï¼Œä»¥ä¾¿å°†å€¼æœ‰æ•ˆåœ°å‘é€ç»™è®¢é˜…è€…ã€‚
*   å½“æ‚¨åªæƒ³å°†æœ€åä¸€ä¸ªå€¼ä¼ é€’ç»™è®¢é˜…è€…æ—¶ï¼Œè¯·ä½¿ç”¨`AsyncSubject`ã€‚
*   å¦‚æœæ‚¨ä¸æƒ³ä¼ é€’ä»»ä½•å€¼ï¼Œè€Œåªæƒ³æŒ‚é’©åˆ°äº‹ä»¶ä¸­ï¼Œè¯·ä½¿ç”¨ Void `Subject`ã€‚

å¸Œæœ›è¿™èƒ½å¸®åŠ©ä½ åšå‡ºæ­£ç¡®çš„é€‰æ‹©ï¼

> å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºå†·çƒ­å¯è§‚æµ‹é‡çš„ä¿¡æ¯ï¼Œæˆ‘æ¨èä½ é˜…è¯»è¿™ç¯‡ç”± [Ben Lesh](https://medium.com/u/da6839d28258?source=post_page-----c2e9db61b4a0--------------------------------) å†™çš„æ–‡ç« [å†·çƒ­å¯è§‚æµ‹é‡](https://benlesh.medium.com/hot-vs-cold-observables-f8094ed53339)ã€‚

# è°¢è°¢ï¼

![](img/788dd57432ef08bda37f970c71ad90b8.png)

è¯»å®Œè¿™ä¸ªæ•…äº‹åï¼Œæˆ‘å¸Œæœ›ä½ å­¦åˆ°äº†ä¸€äº›æ–°çš„ä¸œè¥¿ï¼Œæˆ–è€…å—åˆ°å¯å‘å»åˆ›é€ ä¸€äº›æ–°çš„ä¸œè¥¿ï¼ğŸ¤—

å¦‚æœæˆ‘ç»™ä½ ç•™ä¸‹äº†é—®é¢˜æˆ–ä¸€äº›è¦è¯´çš„è¯ä½œä¸ºå›åº”ï¼Œå‘ä¸‹æ»šåŠ¨å¹¶ç»™æˆ‘é”®å…¥ä¸€æ¡æ¶ˆæ¯ã€‚å¦‚æœä½ æƒ³ä¿å¯†ï¼Œè¯·åœ¨ Twitter @DevByRayRay ä¸Šç»™æˆ‘å‘ä¸€æ¡ [DMã€‚æˆ‘çš„ DM æ°¸è¿œæ˜¯å¼€æ”¾çš„ğŸ˜](https://twitter.com/@devbyrayray)

## [é€šè¿‡ç”µå­é‚®ä»¶è·å–æˆ‘çš„æ–‡ç« ç‚¹å‡»æ­¤å¤„](https://byrayray.medium.com/subscribe) | [è´­ä¹° 5 ç¾å…ƒçš„ä¸­çº§ä¼šå‘˜èµ„æ ¼](https://byrayray.medium.com/subscribe)

# é˜…è¯»æ›´å¤š

![RayRay](img/992af170033696163d6cc0269218aedd.png)

[é›·é›·](https://byrayray.medium.com/?source=post_page-----c2e9db61b4a0--------------------------------)

## è’è¯çš„æ•…äº‹

[View list](https://byrayray.medium.com/list/angular-stories-24674407532a?source=post_page-----c2e9db61b4a0--------------------------------)6 stories![](img/b94f2b7d2929c90566cd2dd6f657a751.png)![](img/02b73423a62d73b113af9fdf9629c79f.png)![Stacked books](img/b02a2f57c0093e04ab1d11d3a55f35ea.png)![RayRay](img/992af170033696163d6cc0269218aedd.png)

[é›·é›·](https://byrayray.medium.com/?source=post_page-----c2e9db61b4a0--------------------------------)

## æœ€æ–°çš„ JavaScript å’Œ TypeScript æ•…äº‹

[View list](https://byrayray.medium.com/list/latest-javascript-typescript-stories-0358ad941491?source=post_page-----c2e9db61b4a0--------------------------------)14 stories![](img/c93ca03b33796c40dcc47873de2697c2.png)![](img/86f37efa11855f6f0f0f62984c37f696.png)![](img/ddbaa6d0bea676316247e82043d60b63.png)