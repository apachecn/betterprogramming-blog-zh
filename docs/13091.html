<html>
<head>
<title>Triggering Repeatable Animations From the Server in LiveView and Elixir</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨LiveViewå’ŒElixirä¸­ä»æœåŠ¡å™¨è§¦å‘å¯é‡å¤çš„åŠ¨ç”»</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://betterprogramming.pub/triggering-repeatable-animations-from-the-server-in-liveview-and-elixir-970961085f12?source=collection_archive---------8-----------------------#2022-07-27">https://betterprogramming.pub/triggering-repeatable-animations-from-the-server-in-liveview-and-elixir-970961085f12?source=collection_archive---------8-----------------------#2022-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d09c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">çµè¯å¼€å‘è€…æŒ‡å—(ä»¥åŠä½ ä¸ºä»€ä¹ˆæƒ³è¿™ä¹ˆåš)</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/deeccc9366c8e1953355dcbb0651d030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5yzIxuRv3Cvk6EvQ"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ç”±<a class="ae kv" href="https://unsplash.com/@janjakubnanista?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">è©¹Â·é›…å„å¸ƒÂ·çº³å°¼æ–¯å¡”</a>åœ¨<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</p></figure><h1 id="efb6" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">å‡¤å‡°åŸå®æ—¶æ™¯è§‚</h1><p id="b239" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">Phoenix LiveViewæ˜¯æˆ‘ç›®å‰æœ€å–œæ¬¢çš„åˆ›å»ºwebåº”ç”¨ç¨‹åºçš„æ–¹å¼â€”â€”èŠ±ç“£å †æ ˆä½¿ç”¨èµ·æ¥éå¸¸æœ‰è¶£ï¼Œå¹¶ä¸”(åœ¨æˆ‘çœ‹æ¥)å¾ˆå¿«å°±ä¼šæˆä¸ºwebå¼€å‘äººå‘˜çš„ä¸»æµå †æ ˆé€‰æ‹©ï¼Œä»–ä»¬å¸Œæœ›åˆ›å»ºå®æ—¶åº”ç”¨ç¨‹åºï¼Œè€Œä¸å¿…æ‹…å¿ƒå½“ä»Šæœ€æµè¡Œçš„å·¥å…·æ‰€å¸¦æ¥çš„å®¢æˆ·ç«¯é—®é¢˜ã€‚</p><p id="3b7a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">Chris McCordåœ¨ä»–çš„å…³äºLiveViewå¦‚ä½•æˆä¸ºçš„<a class="ae kv" href="https://fly.io/blog/liveview-its-alive/" rel="noopener ugc nofollow" target="_blank">fly . ioåšå®¢æ–‡ç« ä¸­é›„è¾©åœ°æè¿°äº†ä½ è·å¾—çš„åŠ›é‡ä»¥åŠèƒ½å¤Ÿå‡ ä¹å¿˜è®°å¤§çº¦90%çš„å®¢æˆ·ç«¯ä»£ç çš„å¤©èµ‹â€”â€”å¼ºçƒˆæ¨èé˜…è¯»ã€‚</a></p><p id="c5e1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">æˆ‘å·²ç»å¼€å‘äº†ä¸€äº›LiveViewåº”ç”¨ç¨‹åº(æˆ‘è®¤ä¸ºè‡ªå·±è¶³å¤Ÿå¹¸è¿ï¼Œèƒ½å¤Ÿåœ¨å·¥ä½œä¸­ä½¿ç”¨å®ƒ)ï¼ŒåŒ…æ‹¬:</p><ul class=""><li id="fc75" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">ä¸€æ¬¾å—wordleå¯å‘çš„ç½‘é¡µæ¸¸æˆ</li><li id="503e" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><a class="ae kv" href="https://niceice.io/" rel="noopener ugc nofollow" target="_blank">nicice . io</a>â€”â€”ä¸€é¡¹SaaSæœåŠ¡ï¼Œç”¨äºå°½å¯èƒ½å®¹æ˜“åœ°è·å–ç”¨æˆ·çš„åé¦ˆ</li></ul><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="4ea8" class="ni kx iq ne b gy nj nk l nl nm">Petal Stack?<br/>Phoenix, Elixir, Tailwind, Alpine &amp; LiveView.</span></pre><h1 id="6425" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">ä¸ºä»€ä¹ˆè¦ä»åç«¯è§¦å‘å‰ç«¯åŠ¨ç”»ï¼Ÿ</h1><p id="ca5f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">LiveViewåœ¨æ„å»ºå®æ—¶åº”ç”¨ç¨‹åºæ–¹é¢éå¸¸å‡ºè‰²â€”â€”å½“æˆ‘è¯´å®æ—¶æ—¶ï¼Œæˆ‘æŒ‡çš„æ˜¯å¯¹å½“å‰æµè§ˆè¯¥ç½‘ç«™çš„æ‰€æœ‰ç”¨æˆ·çš„å³æ—¶ååº”ã€‚</p><p id="7016" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">æˆ‘ç›®å‰æ­£åœ¨å¼€å‘ä¸€ä¸ªå¹³å°ï¼Œå¯ä»¥åœ¨ç½‘ä¸Šåˆ†äº«ç”¨æˆ·åˆ›é€ çš„è™šæ„æ•…äº‹ï¼Œå½“æˆ‘è¯•å›¾ç»™ç”Ÿæ´»å¸¦æ¥ä¸€ä¸ªæ–°çš„åŠŸèƒ½æ—¶ï¼Œæˆ‘å¶ç„¶å‘ç°äº†ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªæ•™ç¨‹çš„åŸºç¡€ã€‚</p><p id="a1bf" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">ä½œä¸ºæˆ‘çš„æ–°å¹³å°çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æˆ·å¯ä»¥æäº¤æ•…äº‹å’Œç« èŠ‚ï¼Œå¹¶åˆ¶ä½œå†…å®¹ä¾›ç”¨æˆ·é˜…è¯»ã€‚æƒ³è¦ç»™æˆ‘çš„åº”ç”¨ç¨‹åºæ·»åŠ æ›´å¤šçš„æ´»åŠ›â€”â€”æˆ‘è§‰å¾—åœ¨æˆ‘çš„ç½‘ç«™é¦–é¡µä¸Šæœ‰ä¸€ä¸ªå®æ—¶çš„å…¨çƒç»Ÿè®¡ç»„ä»¶ä¼šå¾ˆé…·ï¼Œè¿™æ ·ç”¨æˆ·å¯ä»¥å®æ—¶çœ‹åˆ°ç½‘ç«™æœ‰å¤šæ´»è·ƒï¼</p><h1 id="1c0e" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">æ‰€ä»¥æˆ‘åšäº†ä¸€ä¸ªç®€å•çš„LiveViewç»„ä»¶</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/879810757087c8df5be9adfe201c8276.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*e8nIj9bdM13fl7nq.png"/></div></div></figure><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="eaa8" class="ni kx iq ne b gy nj nk l nl nm">def mount(_params, _session, socket) do<br/>    socket =<br/>      socket<br/>      |&gt; assign(:story_count, total_story_count())<br/>      |&gt; assign(:word_count, total_word_count())<br/>      |&gt; assign(:chapter_count, total_chapter_count())</span><span id="e0d9" class="ni kx iq ne b gy no nk l nl nm">    {:ok, socket}<br/>  end<br/>    <br/>  def render(assigns) do<br/>    ~H"""<br/>     &lt;p&gt;&lt;span id="stories-count"&gt;&lt;%= @stories_count %&gt;&lt;/span&gt; stories submitted&lt;/p&gt;<br/>     &lt;p&gt;&lt;span id="chapters-count"&gt;&lt;%= @chapters_count %&gt;&lt;/span&gt; chapters published&lt;/p&gt;<br/>     &lt;p&gt;&lt;span id="word-count"&gt;&lt;%= @word_count %&gt;&lt;/span&gt; words written&lt;/p&gt;<br/>    """<br/>  end</span></pre><p id="7183" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">è¿™å¾ˆé…·â€”â€”æˆ‘æœ‰ä¸€ä¸ªç»„ä»¶ï¼Œæ¯å½“ç”¨æˆ·è®¿é—®é¡µé¢æ—¶ï¼Œå®ƒå°±ä¼šæ›´æ–°ï¼Œä½†è¿™ä¸æ˜¯å¾ˆå®æ—¶ï¼Œä¸æ˜¯å—ï¼Ÿ</p><p id="541a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">ç›®å‰ä¿¡æ¯åªåœ¨<code class="fe np nq nr ne b">mount</code>æ›´æ–°â€”â€”è®©æˆ‘ä»¬ç”¨é»˜è®¤æƒ…å†µä¸‹Phoenixé™„å¸¦çš„<code class="fe np nq nr ne b">Phoenix.PubSub</code>æ¨¡å—çš„é­”åŠ›æ¥æ”¹å˜å®ƒã€‚</p><p id="72c7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæˆ‘ä»¬çš„PubSubåˆ›å»ºä¸€ä¸ªè¦è®¢é˜…çš„ä¸»é¢˜(å¹¶åœ¨æˆ‘çš„åº”ç”¨ä¸»ç®¡æ ‘ä¸­å¯ç”¨PubSub):</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="0a79" class="ni kx iq ne b gy nj nk l nl nm"># MyApplication.Submissions</span><span id="1c85" class="ni kx iq ne b gy no nk l nl nm">  @topic inspect(__MODULE__)</span><span id="6128" class="ni kx iq ne b gy no nk l nl nm">  def subscribe do<br/>    PubSub.subscribe(MyApplication.PubSub, @topic)<br/>  end</span><span id="bf28" class="ni kx iq ne b gy no nk l nl nm">  defp notify_subscribers({:ok, result}, event) do<br/>    PubSub.broadcast(MyApplication.PubSub, @topic, {__MODULE__, event, result})<br/>    {:ok, result}<br/>  end</span></pre><p id="322b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">ç°åœ¨ï¼Œæ¯å½“æˆ‘æƒ³æé†’è®¢é˜…äº†æˆ‘æ„Ÿå…´è¶£çš„æ›´æ–°çš„å†…å®¹æ—¶ï¼Œæˆ‘å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ª<code class="fe np nq nr ne b">notify_subscribers/2</code>åŠŸèƒ½ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="64d3" class="ni kx iq ne b gy nj nk l nl nm">def update_story(%Story{} = story, attrs) do<br/>    story<br/>    |&gt; Story.update_changeset(attrs)<br/>    |&gt; Repo.update() <br/>    |&gt; notify_subscribers([:story, :updated]) # â¬…ï¸ the interesting bit<br/>  end</span></pre><p id="ac4f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">ç„¶åæˆ‘ä»¬éœ€è¦ç¡®ä¿å½“æˆ‘ä»¬çš„<code class="fe np nq nr ne b">live_component</code>æŒ‚è½½å¹¶è¿æ¥åˆ°WebSocketæ—¶ï¼Œå®ƒè®¢é˜…äº†ä¸»é¢˜ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="e52b" class="ni kx iq ne b gy nj nk l nl nm">def mount(_params, _session, socket) do<br/>    if connected?(socket) do<br/>        MyApplication.Submissions.subscribe()<br/>    end<br/>    <br/>    # and add an event listener to ensure our LiveView knows to react when it receives a message from our subscribed topic<br/>    def handle_info({MyApplication.Submissions, [:story, _], _}, socket) do<br/>        socket =<br/>            socket<br/>            |&gt; assign(:story_count, total_story_count())</span><span id="3794" class="ni kx iq ne b gy no nk l nl nm">        {:noreply, socket}<br/>    end<br/>  end</span></pre><p id="315a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">ç°åœ¨ï¼Œå½“æˆ‘ä»¬æ›´æ–°æˆ‘ä»¬çš„æ•…äº‹æ—¶â€”â€”<em class="ns">æ³¨æ„ï¼Œæˆ‘å¿½ç•¥äº†ç¬¬äºŒä¸ªatomï¼Œæ‰€ä»¥æ¯å½“å‘ç”Ÿä»»ä½•æ•…äº‹å˜åŒ–æ—¶ï¼Œæˆ‘éƒ½ä¼šè°ƒç”¨æˆ‘çš„æ–°ä»»åŠ¡</em>â€”â€”æˆ‘ä»¬çš„å‰ç«¯å°†ä¸ºæ‰€æœ‰ç”¨æˆ·æ›´æ–°ï¼</p><p id="6c39" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">ä¸è¿‡ï¼Œæˆ‘ä»¬æœ‰ä¸ªé—®é¢˜ã€‚</p><p id="a6db" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">æ²¡æœ‰åŠ¨ç”»ï¼è¿™å¯¹äºç”¨æˆ·æ¥è¯´å¯èƒ½å¾ˆä¸å’Œè°ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬è¿›å…¥è¿™ç¯‡æ–‡ç« çš„çœŸæ­£è¦ç‚¹ï¼›ä»åç«¯è§¦å‘åŠ¨ç”»æ¥çœŸæ­£å–æ‚¦æˆ‘ä»¬çš„è¯»è€…ã€‚</p><h1 id="0ef9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">åŠ¨ç”»æ—¶é—´</h1><p id="cffe" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">å¯¹äºæˆ‘çš„ä¾‹å­ï¼Œæˆ‘ä½¿ç”¨é¡ºé£(è€¶ï¼ŒèŠ±ç“£ğŸŒ¸stack ),ä½†åªè¦åŠ¨ç”»å’Œå…³é”®å¸§å±æ€§è®¾ç½®æ­£ç¡®ï¼Œè¿™å°†é€‚ç”¨äºä»»ä½•CSSç±»ã€‚</p><p id="5181" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬åœ¨CSSä¸­å®šä¹‰æˆ‘ä»¬çš„åŠ¨ç”»(åœ¨æˆ‘ä»¬çš„<code class="fe np nq nr ne b">tailwind.config.js</code>):</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="0c4f" class="ni kx iq ne b gy nj nk l nl nm">theme: {<br/>    extend: {<br/>      keyframes: {<br/>        wiggle: {<br/>          '0%': { transform: 'translateY(0px) scale(1,1)' },<br/>          '25%': { transform: 'translateY(-4px) scale(1.05,1.05)', background: 'aquamarine' },<br/>          '100%': { transform: 'translateY(0px) scale(1,1)' },<br/>        }<br/>      },<br/>      animation: {<br/>        wiggle: 'wiggle 0.5s linear 1 forwards',<br/>      }<br/>    },<br/>  },</span></pre><p id="a219" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">æˆ‘ä»¬æ‰€åšçš„åªæ˜¯è®©å®ƒè·³ä¸€ç‚¹ç‚¹ã€‚è®©æˆ‘ä»¬ç»§ç»­æ•´åˆè¿™ä¸ªã€‚</p><h1 id="6266" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">ç¬¬ä¸€æ¬¡å°è¯•</h1><p id="e7d7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">èµ·åˆï¼Œæˆ‘è®¤ä¸ºæˆ‘å¯ä»¥ç®€å•åœ°ä½¿ç”¨<code class="fe np nq nr ne b">LiveView.JS</code>åº“ä»åç«¯å‘æœ‰é—®é¢˜çš„å…ƒç´ æ·»åŠ ä¸€ä¸ªç±»ï¼Œå¹¶å°†å…¶ä¼ é€’åˆ°å‰ç«¯ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="1ec4" class="ni kx iq ne b gy nj nk l nl nm">def do_animation do<br/>    JS.add_class("animate-wiggle", to: "#word-count")<br/>  end</span></pre><p id="51ec" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">è®°ä½ï¼Œæˆ‘ä¹Ÿæ˜¯ç”¨ä¸€ä¸ªå¸¦æœ‰ç‚¹å‡»å¤„ç†ç¨‹åº<code class="fe np nq nr ne b">phx-click={do_animation}</code>çš„ç®€å•æŒ‰é’®æ¥æµ‹è¯•çš„ï¼Œè¿™æ ·å°±ä¸ç”¨æ¯æ¬¡éƒ½è§¦å‘åç«¯äº‹ä»¶äº†â€”â€”æ‰€ä»¥æˆ‘ç”¨çš„æ˜¯phx-click...</p><p id="3315" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">è¿™å¢åŠ äº†ç±»ï¼ŒåŠ¨ç”»åšäº†ä¸€ç‚¹è·³è·ƒâ€”â€”å¤ªæ£’äº†ã€‚</p><p id="8244" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">æˆ‘åˆç‚¹äº†ä¸€ä¸‹ï¼Œä»€ä¹ˆä¹Ÿæ²¡å‘ç”Ÿï¼Œä¸å¤ªå¥½ã€‚</p><p id="9d1d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">è¿™æ˜¯å› ä¸ºç±»ä¾èµ–äºå…ƒç´ ï¼Œæ‰€ä»¥å†æ¬¡æ·»åŠ å®ƒæ„å‘³ç€ä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿâ€”â€”æˆ‘çš„åŠ¨ç”»æ˜¯ä¸å¯é‡å¤çš„ã€‚å“å‘¦ã€‚</p><h1 id="ae58" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">ç¬¬äºŒæ¬¡å°è¯•</h1><p id="249e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">æ·»åŠ å®Œç±»åï¼Œè®©æˆ‘ä»¬åˆ é™¤è¯¥ç±»ã€‚</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="4847" class="ni kx iq ne b gy nj nk l nl nm">def do_animation do<br/>    JS.add_class("animate-wiggle", to: "#word-count")<br/>    send(self(), JS.remove_class("animate-wiggle", to: "#word-count"))<br/>  end</span></pre><p id="ffa6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">è¿™ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºè¯¥ç±»åœ¨æ·»åŠ çš„åŒæ—¶è¢«åˆ é™¤ã€‚æˆ‘æœ¬æ¥å¯ä»¥å¢åŠ ä¸€ä¸ªæš‚åœï¼Œä½†è¿™ä¼¼ä¹å¤ªä¸ç¤¼è²Œäº†ã€‚</p><h1 id="db59" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">ç¬¬ä¸‰æ¬¡å°è¯•</h1><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="14ca" class="ni kx iq ne b gy nj nk l nl nm">def animate_wiggle(element_id) do<br/>    JS.transition(%JS{}, "animate-wiggle", to: element_id, time: 500)<br/>  end</span></pre><p id="864b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe np nq nr ne b">JS.transition/2</code>æ¥æ•‘æ´äº†ï¼LiveViewå›¢é˜Ÿæ„å»ºäº†ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½æ¥é‡å¤è§¦å‘è½¬æ¢ã€‚</p><p id="4f39" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜â€”â€”<code class="fe np nq nr ne b">LiveView.JS</code>å‡½æ•°åªæ˜¯ç”ŸæˆJavaScriptï¼Œæ‰€ä»¥å®ƒä»¬å¿…é¡»åœ¨é¡µé¢ä¸­å‘ˆç°ï¼</p><p id="105a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">é‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p id="a2cc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://hexdocs.pm/phoenix_live_view/js-interop.html#handling-server-pushed-events" rel="noopener ugc nofollow" target="_blank"> RTFM </a>å½“ç„¶ï¼å‘å‰ï¼</p><h1 id="93e3" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">ç¬¬å››æ¬¡å°è¯•</h1><p id="9894" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">æˆ‘å¿…é¡»å°†äº‹ä»¶æ¨é€åˆ°æµè§ˆå™¨ï¼Œä»¥ä¾¿ä¸€äº›JavaScriptå¯ä»¥ä¸ºæˆ‘æ‰§è¡ŒwiggleåŠ¨ç”»â€”â€”æ‰€ä»¥æµç¨‹æ˜¯è¿™æ ·çš„:</p><ul class=""><li id="a3c0" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">å‘å¸ƒè®¢é˜…å¹¿æ’­äº‹ä»¶</li><li id="d997" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">æ¯ä¸ªè®¢é˜…çš„LiveViewè¿›ç¨‹éƒ½ä¼šç›‘å¬è¯¥äº‹ä»¶ï¼Œå¹¶å‘å…¶å®¢æˆ·ç«¯è§¦å‘ä¸€ä¸ªäº‹ä»¶</li><li id="77af" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">å®¢æˆ·ç«¯æœ‰ä¸€ä¸ªJavaScriptäº‹ä»¶ç›‘å¬å™¨æ¥è·å–<code class="fe np nq nr ne b">phx</code>äº‹ä»¶å¹¶å¯¹å…¶åšå‡ºååº”</li><li id="c064" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">JavaScriptå‘å®¢æˆ·ç«¯å‘å‡ºä¸€ä¸ªè°ƒç”¨æ¥è§¦å‘åŠ¨ç”»</li><li id="a0ea" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated"><code class="fe np nq nr ne b">JS.transition/2</code>ç«ç¾</li><li id="e9a1" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">æ‘†åŠ¨æ‘†åŠ¨</li></ul><p id="71de" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">è®©æˆ‘ä»¬åœ¨<code class="fe np nq nr ne b">App.js</code>ä¸­æ·»åŠ JSäº‹ä»¶ç›‘å¬å™¨:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="4b88" class="ni kx iq ne b gy nj nk l nl nm">window.addEventListener(`phx:wiggle`, (e) =&gt; {<br/>  let el = document.getElementById(e.detail.id)<br/>  if(el) {<br/>    liveSocket.execJS(el, el.getAttribute("data-wiggle"))<br/>  }<br/>})</span></pre><p id="d500" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">è®©æˆ‘ä»¬æ›´æ–°äº‹ä»¶å¤„ç†ç¨‹åºï¼Œç¡®å®šä½•æ—¶å°†äº‹ä»¶æ¨é€åˆ°å®¢æˆ·ç«¯:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="52aa" class="ni kx iq ne b gy nj nk l nl nm">def handle_info({MyApplication.Submissions, [:story, _], _}, socket) do<br/>    socket =<br/>        socket<br/>        |&gt; assign(:story_count, total_story_count())<br/>        |&gt; push_event("wiggle", %{id: "stories-count"}) # â¬…ï¸ the new addition<br/>            <br/>    {:noreply, socket}<br/>end</span></pre><p id="a2d8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">æˆ‘ä»¬è¿˜éœ€è¦ç¡®ä¿å‘æƒ³è¦æ‘†åŠ¨çš„å…ƒç´ æ·»åŠ idå’Œæ•°æ®å±æ€§ï¼Œä»¥ä¾¿JavaScriptå¯ä»¥æ‰¾åˆ°å®ƒå¹¶çŸ¥é“å¦‚ä½•å¤„ç†å®ƒ:</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="7a4d" class="ni kx iq ne b gy nj nk l nl nm">&lt;p&gt;&lt;span id="stories-count" data-wiggle={animate_wiggle("#stories-count")}&gt;&lt;%= @stories_count %&gt;&lt;/span&gt; stories submitted&lt;/p&gt;</span></pre><h1 id="4245" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">ç»“æœ</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/8b521bf3f3fedf057a568bce3717f287.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*etTWF8ClTZja6FUL.gif"/></div></figure><p id="9186" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">ä½ çœ‹ä¸åˆ°çš„æ˜¯æˆ‘æœ‰å¦ä¸€ä¸ªçª—å£æ¥è§¦å‘ä¸Šè¿°äº‹ä»¶ã€‚</p></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><p id="723b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">æˆ‘ä»¬å®Œäº†ï¼</p><p id="4c7e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">æˆ‘ä»¬å·²ç»ç”¨æœ€å°‘çš„ä»£ç (å®é™…ä¸Šåªæœ‰6è¡ŒJavaScript)æˆåŠŸåœ°è§¦å‘äº†æ¥è‡ªåº”ç”¨ç¨‹åºå…¶ä»–ç”¨æˆ·çš„å®æ—¶äº‹ä»¶çš„å¯é‡å¤å‰ç«¯åŠ¨ç”»ã€‚</p><p id="556a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">æˆ‘çˆ±<code class="fe np nq nr ne b">LiveView</code>ï¼Œæˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½è®©ä½ çŸ¥é“ä¸ºä»€ä¹ˆã€‚</p><p id="7f10" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://twitter.com/codestirring" rel="noopener ugc nofollow" target="_blank">åœ¨Twitterä¸Šå…³æ³¨æˆ‘</a> &amp; <a class="ae kv" href="https://chrisgregori.substack.com/" rel="noopener ugc nofollow" target="_blank">è®¢é˜…æˆ‘çš„Substack </a>è·å–æ›´å¤šLiveViewã€Elixirå’Œä¸€èˆ¬ç¼–ç¨‹æ•™ç¨‹å’ŒæŠ€å·§ã€‚</p></div></div>    
</body>
</html>