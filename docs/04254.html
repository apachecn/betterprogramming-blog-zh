<html>
<head>
<title>Build Better Svelte Stores</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å»ºé€ æ›´å¥½çš„è‹—æ¡å•†åº—</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://betterprogramming.pub/build-better-svelte-stores-8c70db038dd2?source=collection_archive---------7-----------------------#2020-04-01">https://betterprogramming.pub/build-better-svelte-stores-8c70db038dd2?source=collection_archive---------7-----------------------#2020-04-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a4e9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">åˆ©ç”¨Svelteçš„å†…ç½®å•†åº—</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/866b0045408a1ecfc3a483651080050a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bytr3653xdXkLBtvMbuEUw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae ky" href="https://unsplash.com/@helloimnik?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">ä½ å¥½æˆ‘æ˜¯å°¼å…‹ğŸ</a> on <a class="ae ky" href="https://unsplash.com/s/photos/build?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="6aa2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Svelteæ˜¯æ„å»ºç”¨æˆ·ç•Œé¢çš„ä¸€ç§å…¨æ–°æ–¹æ³•ã€‚</p><p id="8c47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å°½ç®¡Reactå’ŒVueç­‰ä¼ ç»Ÿæ¡†æ¶åœ¨æµè§ˆå™¨ä¸­å®Œæˆå¤§éƒ¨åˆ†å·¥ä½œï¼Œä½†Svelteå°†è¿™äº›å·¥ä½œè½¬å˜ä¸ºç¼–è¯‘æ­¥éª¤ï¼Œåœ¨æ„å»ºåº”ç”¨ç¨‹åºæ—¶è¿›è¡Œã€‚</p><p id="997d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™æ„å‘³ç€æ‚¨çš„åŒ…å°†æ²¡æœ‰ä¾èµ–é¡¹ï¼Œå¹¶ä¸”ä¼šå˜å¾—æ›´å°ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒSvelteçš„ç¼–è¯‘å™¨ä¼šç”Ÿæˆé«˜åº¦ä¼˜åŒ–çš„ä»£ç ï¼Œè¿™æ„å‘³ç€ä¸Reactã€Vueå’ŒAngularç›¸æ¯”ï¼Œä½ çš„åº”ç”¨ç¨‹åºå¯èƒ½ä¼šæœ‰æ›´å¥½çš„æ•´ä½“æ€§èƒ½ã€‚</p><p id="eefd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¦‚æœä½ æ²¡æœ‰å¬è¯´è¿‡å®ƒä»¬ï¼ŒRich Harrisçš„è§†é¢‘â€œ<a class="ae ky" href="https://www.youtube.com/watch?v=AdNJ3fydeao" rel="noopener ugc nofollow" target="_blank">åæ€ååº”æ€§</a>â€å’Œâ€œ<a class="ae ky" href="https://www.youtube.com/watch?v=BzX4aTRPzno" rel="noopener ugc nofollow" target="_blank">â€˜å°‘å†™å¤šåšâ€™çš„å›å½’</a>â€å¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼€å§‹ã€‚å¦‚æœä½ å¯¹å­¦ä¹ æ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥ä»è¿™æœ¬ä¼˜ç§€çš„<a class="ae ky" href="https://svelte.dev/tutorial/basics" rel="noopener ugc nofollow" target="_blank">æ•™ç¨‹</a>å¼€å§‹ã€‚</p><p id="5be2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Svelteæä¾›çš„å¼€ç®±å³ç”¨çš„ç‰¹æ€§ä¹‹ä¸€æ˜¯<code class="fe lv lw lx ly b">store</code>ï¼Œè¿™æ˜¯ä¸€ç§åœ¨ç»„ä»¶ä¹‹é—´å…±äº«æ•°æ®çš„æ–¹å¼ï¼Œæ— éœ€ä½¿ç”¨é“å…·ï¼Œä¹Ÿä¸ä¼šé™·å…¥è‡­åæ˜­è‘—çš„<em class="lz">æ¸²æŸ“é“å…·åœ°ç‹±ã€‚</em></p><p id="60d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Svelteçš„å›¢é˜Ÿåœ¨æä¾›ä¸€ç§éå¸¸ç®€å•å’Œå®¹æ˜“çš„æ–¹æ³•æ¥å®ç°è¿™ä¸€ç‚¹æ–¹é¢åšå¾—å¾ˆå¥½ã€‚æœ‰ä¸¤ç§<code class="fe lv lw lx ly b">store</code>ç±»å‹:<code class="fe lv lw lx ly b">writable</code>å’Œ<code class="fe lv lw lx ly b">readable</code>ã€‚ç¬¬ä¸€ä¸ªå¯ä»å¤–éƒ¨æ›´æ–°ï¼Œè€Œå¦ä¸€ä¸ªä¸å¯ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ æœ€ç»ˆä¼šä½¿ç”¨<code class="fe lv lw lx ly b">writable</code>ç±»å‹ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚è¯¥ä»£ç åˆ›å»ºä¸€ä¸ªåˆå§‹å€¼ç­‰äºé›¶çš„æ–°å•†åº—ã€‚</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="3537" class="me mf it ly b gy mg mh l mi mj">// file store.js<br/>import { writable } from 'svelte/store'<br/>const store = writable(0)<br/>export default store;</span></pre><p id="9f33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™ä¸ªå•†åº—å¯ä»¥è¿›å£å’Œä½¿ç”¨ä»»ä½•è‹—æ¡çš„ç»„ä»¶ã€‚</p><p id="0b44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨<code class="fe lv lw lx ly b">subscribe</code>æ–¹æ³•å’Œ<code class="fe lv lw lx ly b">set</code>æˆ–<code class="fe lv lw lx ly b">update</code>å„è‡ªçš„æ–¹æ³•æ¥ç›‘å¬çŠ¶æ€å˜åŒ–ã€‚</p><p id="dc7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸ºäº†<code class="fe lv lw lx ly b">subscribe</code>ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶æ–°çš„å­˜å‚¨çŠ¶æ€å€¼ï¼Œè¯¥å€¼å¯ç”¨äºæ›´æ–°ç»„ä»¶çš„å±€éƒ¨å˜é‡ã€‚<code class="fe lv lw lx ly b">set</code>æ–¹æ³•ç”¨ä¼ é€’ç»™å®ƒçš„å‚æ•°è¦†ç›–å­˜å‚¨çŠ¶æ€å€¼ã€‚<code class="fe lv lw lx ly b">update</code>æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚å›è°ƒå°†ç°æœ‰çš„å­˜å‚¨å€¼ä½œä¸ºå…¶å‚æ•°ï¼Œå¹¶è¿”å›è¦è®¾ç½®åˆ°å­˜å‚¨åŒºçš„æ–°å€¼ã€‚</p><p id="6de8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‚¨å¯ä»¥åœ¨ä¸‹é¢çš„ä»£ç ä¸­çœ‹åˆ°è¿™ä¸‰ä¸ªæ–¹æ³•çš„è¿è¡Œ:</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="0529" class="me mf it ly b gy mg mh l mi mj">// file App.svelte<br/>&lt;script&gt;<br/>import { onDestroy, onMount } from 'svelte';<br/>import store from './store.js'<br/>let counter = 0;<br/>let unsubscribe;<br/>onMount(() =&gt; unsubscribe = store.subscribe(state =&gt; (counter = state)));<br/>onDestroy(() =&gt; {if (unsubscribe) unsubscribe()})<br/>const reset = () =&gt; (store.set(0));<br/>const increment = () =&gt; store.update(state =&gt; state + 1)<br/>&lt;/script&gt;<br/>&lt;main&gt;<br/>    &lt;span&gt;The counter value is {counter}&lt;/span&gt;<br/>    &lt;hr /&gt;<br/>    &lt;button on:click={increment}&gt;Increment&lt;/button&gt;<br/>    &lt;button on:click={reset}&gt;Reset&lt;/button&gt;<br/>&lt;/main&gt;</span></pre><p id="0cac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨<code class="fe lv lw lx ly b">script</code>æ ‡ç­¾ä¸­ï¼Œé¦–å…ˆæˆ‘ä»¬å¯¼å…¥å…ˆå‰åˆ›å»ºçš„å•†åº—ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªSvelteçš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶(<code class="fe lv lw lx ly b">onMount</code>å’Œ<code class="fe lv lw lx ly b">onDestroy</code>)æ¥è®¢é˜…å•†åº—å¹¶ç”¨å…¶å€¼æ›´æ–°è®¡æ•°å™¨ï¼Œå¹¶åœ¨ç»„ä»¶è¢«é”€æ¯æ—¶å–æ¶ˆè®¢é˜…ã€‚æˆ‘ä»¬è¿˜å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•â€” <code class="fe lv lw lx ly b"> reset</code>ï¼Œå®ƒå°†å€¼è®¾ç½®å›é›¶ï¼Œä»¥åŠ<code class="fe lv lw lx ly b">increment</code>ï¼Œå®ƒå°†å­˜å‚¨çš„å€¼åŠ 1ã€‚</p><p id="49da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨HTMLéƒ¨åˆ†ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæ˜¾ç¤ºè®¡æ•°å™¨å€¼(<code class="fe lv lw lx ly b">{counter}</code>)çš„spanå’Œä¸¤ä¸ªè§¦å‘æˆ‘ä»¬åœ¨<code class="fe lv lw lx ly b">script</code>æ ‡ç­¾ä¸­åˆ›å»ºçš„æ–¹æ³•çš„æŒ‰é’®ã€‚</p><p id="1fb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å®ƒå½“ç„¶éå¸¸å®¹æ˜“ç†è§£å’Œä½¿ç”¨ï¼Œä½†æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬ä»ä»£ç ä¸­çœ‹åˆ°çš„ï¼Œæ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘éƒ½ç›´æ¥å†™åœ¨ç»„ä»¶ä¸­ï¼Œè¿™ä½¿å¾—å®ƒå¾ˆéš¾ä¸åº”ç”¨ç¨‹åºå¯èƒ½å…·æœ‰çš„å…¶ä»–ç»„ä»¶å…±äº«ã€‚</p><p id="e151" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Svelteå›¢é˜Ÿæä¾›çš„ä¼˜ç§€æ–‡æ¡£ï¼Œç‰¹åˆ«æ˜¯â€œ<a class="ae ky" href="https://svelte.dev/docs#Store_contract" rel="noopener ugc nofollow" target="_blank">å•†åº—åˆåŒ</a>â€éƒ¨åˆ†ã€‚æ ¹æ®å®šä¹‰ï¼ŒæƒŸä¸€çš„è¦æ±‚æ˜¯å•†åº—å¿…é¡»æœ‰ä¸€ä¸ªè¿”å›<code class="fe lv lw lx ly b">unsubscribe</code>æ–¹æ³•çš„<code class="fe lv lw lx ly b">subscribe</code>æ–¹æ³•ã€‚æˆ‘ä»¬å·²ç»åœ¨Svelteçš„<code class="fe lv lw lx ly b">store</code>ä¸­å®ç°äº†è¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„è‡ªå®šä¹‰å•†åº—ä¸­ä½¿ç”¨å®ƒï¼Œå¦‚ä¸‹é¢çš„ä»£ç æ‰€ç¤º:</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="15e8" class="me mf it ly b gy mg mh l mi mj">// file counter-store.js<br/>import { writable } from 'svelte/store';<br/>const store = writable(0);<br/>const counterStore = {<br/>  subscribe: store.subscribe,<br/>  set: store.set,<br/>  update: store.update<br/>};///<br/>export default counterStore;</span></pre><p id="7a23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘ä»¬çš„è‡ªå®šä¹‰å­˜å‚¨å°†åƒSvelteçš„<code class="fe lv lw lx ly b">writable</code>å­˜å‚¨ä¸€æ ·å·¥ä½œï¼Œå› ä¸ºå®ƒåªæ˜¯è¿”å›ä¸€ä¸ªè½¬å‘<code class="fe lv lw lx ly b">subscribe</code>ã€<code class="fe lv lw lx ly b">set</code>å’Œ<code class="fe lv lw lx ly b">update</code>æ–¹æ³•çš„å¯¹è±¡ã€‚ä½†æ˜¯ä¸ºäº†åšå¾—æ›´å¥½å¹¶ä»æˆ‘ä»¬çš„ç»„ä»¶ä¸­ç§»é™¤ä¸šåŠ¡é€»è¾‘ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å•†åº—å†…éƒ¨å®ç°<code class="fe lv lw lx ly b">reset</code>å’Œ<code class="fe lv lw lx ly b">increment</code>æ–¹æ³•:</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="42a3" class="me mf it ly b gy mg mh l mi mj">// file counter-store.js<br/>import { writable } from 'svelte/store';<br/>const store = writable(0);<br/>const counterStore = {<br/>  subscribe: store.subscribe,<br/>  set: store.set,<br/>  update: store.update,<br/>  reset: store.set(0),<br/>  increment: store.update(state =&gt; state + 1)<br/>};<br/>export default counterStore;</span></pre><p id="bd5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™æ ·ï¼Œæˆ‘ä»¬çš„ç»„ä»¶å¯ä»¥è¢«é‡æ„å’Œç®€åŒ–:</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="6fa8" class="me mf it ly b gy mg mh l mi mj">// file App.svelte<br/>&lt;script&gt;<br/>import { onDestroy, onMount } from 'svelte';<br/>import store from './counter-store.js'<br/>let counter = 0;<br/>let unsubscribe;<br/>onMount(() =&gt; unsubscribe = store.subscribe(state =&gt; (counter = state)));<br/>onDestroy(() =&gt; unsubcribe())<br/>const reset = () =&gt; store.reset();<br/>const increment = () =&gt; store.increment();<br/>&lt;/script&gt;<br/>&lt;main&gt;<br/>    &lt;span&gt;The counter value is {counter}&lt;/span&gt;<br/>    &lt;hr /&gt;<br/>    &lt;button on:click={increment}&gt;Increment&lt;/button&gt;<br/>    &lt;button on:click={reset}&gt;Reset&lt;/button&gt;<br/>&lt;/main&gt;</span></pre><p id="7200" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ç”±äºæˆ‘ä»¬å°†ä¸šåŠ¡é€»è¾‘æ”¾åœ¨å•†åº—å†…éƒ¨ï¼Œæ‰€ä»¥æœ€å¥½ä¸è¦è½¬å‘<code class="fe lv lw lx ly b">set</code>å’Œ<code class="fe lv lw lx ly b">update</code>æ–¹æ³•ï¼Œä»¥é¿å…ç»„ä»¶å¹²æ‰°å•†åº—æ•°æ®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ€ç»ˆçš„å•†åº—ä»£ç å¦‚ä¸‹æ‰€ç¤º:</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="d8ff" class="me mf it ly b gy mg mh l mi mj">// file counter-store.js<br/>import { writable } from 'svelte/store';<br/>const store = writable(0);<br/>const counterStore = {<br/>  subscribe: store.subscribe,<br/>  reset: store.set(0),<br/>  increment: store.update(state =&gt; state + 1)<br/>};<br/>export default counterStore;</span></pre><p id="9a47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">é€šè¿‡è¿™æ ·åšï¼Œä»»ä½•å…¶ä»–éœ€è¦ä¸å•†åº—æ•°æ®äº¤äº’çš„ç»„ä»¶éƒ½å¯ä»¥é€šè¿‡<code class="fe lv lw lx ly b">reset</code>å’Œ<code class="fe lv lw lx ly b">increment</code>æ–¹æ³•ï¼Œè€Œä¸ç”¨æ‹…å¿ƒå®ƒä»¬èƒŒåçš„é€»è¾‘ã€‚</p><p id="f5cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™é‡Œæä¾›çš„ä»£ç çš„ä¸€ä¸ªå·¥ä½œç¤ºä¾‹å¯ä»¥åœ¨è¿™ä¸ªä»£ç æ²™ç®±çš„<a class="ae ky" href="https://codesandbox.io/s/medium-article-svelte-store-32cy4" rel="noopener ugc nofollow" target="_blank">ä¸­æ‰¾åˆ°ï¼Œä¾›ä½ ä½¿ç”¨ï¼Œåœ¨æˆ‘çš„GitHubè´¦æˆ·åº“</a><a class="ae ky" href="https://github.com/n0n3br/svelte-createstore" rel="noopener ugc nofollow" target="_blank"> svelte-createstoreï¼Œ</a>ä½ å¯ä»¥æ‰¾åˆ°è¿™ä¸ªä»£ç çš„ä¸€ä¸ªæ›´é«˜çº§çš„ç‰ˆæœ¬ï¼Œæ”¯æŒåŒæ­¥/å¼‚æ­¥åŠ¨ä½œå’Œæ¨¡å—ã€‚</p><p id="40a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸‹æ¬¡è§ã€‚</p></div></div>    
</body>
</html>